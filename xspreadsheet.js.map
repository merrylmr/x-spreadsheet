{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/component/element.js","webpack:///./src/core/alphabet.js","webpack:///./src/core/cell_range.js","webpack:///./src/core/selector.js","webpack:///./src/core/scroll.js","webpack:///./src/core/history.js","webpack:///./src/core/clipboard.js","webpack:///./src/core/auto_filter.js","webpack:///./src/core/merge.js","webpack:///./src/core/helper.js","webpack:///./src/core/row.js","webpack:///./src/core/col.js","webpack:///./src/locale/locale.js","webpack:///./src/locale/en.js","webpack:///./src/core/validator.js","webpack:///./src/core/validation.js","webpack:///./src/core/data_proxy.js","webpack:///./src/component/event.js","webpack:///./src/config.js","webpack:///./src/component/resizer.js","webpack:///./src/component/scrollbar.js","webpack:///./src/component/selector.js","webpack:///./src/component/suggest.js","webpack:///./src/component/icon.js","webpack:///./src/component/calendar.js","webpack:///./src/component/datepicker.js","webpack:///./src/component/editor.js","webpack:///./src/component/button.js","webpack:///./src/canvas/draw.js","webpack:///./src/core/font.js","webpack:///./src/core/cell.js","webpack:///./src/core/formula.js","webpack:///./src/core/format.js","webpack:///./src/component/table.js","webpack:///./src/component/print.js","webpack:///./src/component/contextmenu.js","webpack:///./src/component/toolbar/item.js","webpack:///./src/component/tooltip.js","webpack:///./src/component/toolbar/dropdown_item.js","webpack:///./src/component/dropdown.js","webpack:///./src/component/dropdown_align.js","webpack:///./src/component/toolbar/align.js","webpack:///./src/component/toolbar/valign.js","webpack:///./src/component/toolbar/toggle_item.js","webpack:///./src/component/toolbar/autofilter.js","webpack:///./src/component/toolbar/bold.js","webpack:///./src/component/toolbar/italic.js","webpack:///./src/component/toolbar/strike.js","webpack:///./src/component/toolbar/underline.js","webpack:///./src/component/color_palette.js","webpack:///./src/component/dropdown_color.js","webpack:///./src/component/dropdown_linetype.js","webpack:///./src/component/border_palette.js","webpack:///./src/component/dropdown_border.js","webpack:///./src/component/toolbar/border.js","webpack:///./src/component/toolbar/icon_item.js","webpack:///./src/component/toolbar/clearformat.js","webpack:///./src/component/toolbar/paintformat.js","webpack:///./src/component/toolbar/text_color.js","webpack:///./src/component/toolbar/fill_color.js","webpack:///./src/component/dropdown_fontsize.js","webpack:///./src/component/toolbar/font_size.js","webpack:///./src/component/dropdown_font.js","webpack:///./src/component/toolbar/font.js","webpack:///./src/component/dropdown_format.js","webpack:///./src/component/toolbar/format.js","webpack:///./src/component/dropdown_formula.js","webpack:///./src/component/toolbar/formula.js","webpack:///./src/component/toolbar/freeze.js","webpack:///./src/component/toolbar/merge.js","webpack:///./src/component/toolbar/redo.js","webpack:///./src/component/toolbar/undo.js","webpack:///./src/component/toolbar/print.js","webpack:///./src/component/toolbar/textwrap.js","webpack:///./src/component/toolbar/more.js","webpack:///./src/component/toolbar/index.js","webpack:///./src/component/modal.js","webpack:///./src/component/form_input.js","webpack:///./src/component/form_select.js","webpack:///./src/component/form_field.js","webpack:///./src/component/modal_validation.js","webpack:///./src/component/sort_filter.js","webpack:///./src/component/message.js","webpack:///./src/component/comment.js","webpack:///./src/component/split_column.js","webpack:///./src/component/sheet.js","webpack:///./src/component/bottombar.js","webpack:///./src/index.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","Element","tag","className","arguments","length","undefined","_classCallCheck","this","el","document","createElement","data","eventNames","handler","_eventNames$split2","_toArray","split","fen","oen","slice","eventName","test","window","navigator","userAgent","addEventListener","evt","k","button","stopPropagation","_this","keys","forEach","css","concat","_this$el","top","offsetTop","left","offsetLeft","height","offsetHeight","width","offsetWidth","v","scrollLeft","scrollTop","getBoundingClientRect","parentNode","_this2","_len","eles","Array","_key","childNodes","ele","child","removeChild","arg","createTextNode","appendChild","contains","classList","add","remove","cls","toggleClass","toggle","flag","addClass","removeClass","active","_this3","setAttribute","getAttribute","removeAttribute","content","innerHTML","focus","_this4","_len2","_key2","style","removeProperty","_this5","getComputedStyle","h","alphabets","stringAt","index","str","cindex","parseInt","last","indexAt","ret","charCodeAt","expr2xy","src","x","y","charAt","xy2expr","expr2expr","xn","yn","condition","_expr2xy2","_slicedToArray","CellRange","sri","sci","eri","eci","w","cell_range_classCallCheck","ref","refs","_expr2xy4","cell_range_slicedToArray","_expr2xy6","ri","ci","args","_expr2xy","cb","rowFilter","j","other","addRet","push","dsr","dsc","der","dec","multiple","Selector","selector_classCallCheck","range","size","Scroll","scroll_classCallCheck","History","history_classCallCheck","undoItems","redoItems","JSON","stringify","currentd","canUndo","parse","pop","canRedo","Clipboard","clipboard_classCallCheck","state","cellRange","Filter","operator","auto_filter_classCallCheck","includes","Sort","order","AutoFilter","filters","sort","_ref","map","it","getData","filter","getFilter","set","hrange","getCell","rset","Set","fset","_this$range","cell","ctext","text","_this$range2","cnt","valueOf","Merges","merge_classCallCheck","_","cr","within","intersects","union","deleteWithin","type","cbWithin","rn","cn","it1","merges","merge","toString","mergeDeep","sources","source","isArray","digits","a","numberCalc","a1","a2","Number","isNaN","al1","al2","num1","num2","toFixed","Math","max","helper","cloneDeep","obj","apply","equals","obj1","obj2","v1","v2","ai","arrayEquals","sum","objOrAry","total","rangeEach","min","rangeSum","getv","rangeReduceIf","inits","initv","ifv","deleteProperty","oldv","Rows","len","row_classCallCheck","isHide","row","getOrNew","idx","setHide","hide","exceptSet","has","getHeight","sumHeight","cells","what","getCellOrNew","editable","srcCellRange","dstCellRange","autofill","dsri","dsci","deri","deci","_srcCellRange$size","_srcCellRange$size2","row_slicedToArray","_dstCellRange$size","_dstCellRange$size2","drn","dcn","isAdd","dn","ii","jj","nri","nci","ncell","replace","word","result","exec","substring","setCell","ncellmm","each","eachCells","setCellText","pos","ndata","startI","_this6","rndata","_this7","_this8","deleteCell","col","ks","entries","_ref2","_ref3","_ref4","_ref5","assign","_this9","item","Cols","indexWidth","minWidth","col_classCallCheck","getWidth","sumWidth","$languages","$messages","en","toolbar","undo","redo","print","paintformat","clearformat","format","fontName","fontSize","fontBold","fontItalic","underline","strike","color","bgcolor","border","align","valign","textwrap","freeze","autofilter","formula","more","contextmenu","copy","cut","paste","pasteValue","pasteFormat","insertRow","insertColumn","insertRowBottom","insertColumnRight","deleteSheet","deleteRow","deleteColumn","deleteCellText","validation","cellprintable","cellnonprintable","celleditable","cellnoneditable","orientation","orientations","normal","number","percent","rmb","usd","eur","date","time","datetime","duration","average","_if","and","or","required","notMatch","between","notBetween","notIn","equal","notEqual","lessThan","lessThanEqual","greaterThan","greaterThanEqual","error","pasteForMergedCell","calendar","weeks","months","next","cancel","save","ok","desc","asc","empty","dataValidation","criteria","modeType","column","list","phone","email","be","nbe","lt","lte","gt","gte","eq","neq","translate","messages","_i","_$languages","lang","message","match","x_spreadsheet","tf","locale","unshift","rules","returnMessage","Validator","validator_classCallCheck","Date","values","parseValue","_value","validator_slicedToArray","_value2","Validation","validator","validation_classCallCheck","nrefs","difference","Validations","errors","Map","_v$validator$validate2","validation_slicedToArray","validate","delete","getByValidator","addRef","defaultSettings","view","documentElement","clientHeight","clientWidth","showGrid","showToolbar","showContextmenu","showBottomBar","font","bold","italic","canPaste","dst","clone","_src$size2","data_proxy_slicedToArray","srn","scn","_dst$size2","copyPaste","rows","deleteCells","_cell$merge","cutPaste","clipboard","move","clear","setStyleBorder","bss","styles","cstyle","addStyle","DataProxy","settings","data_proxy_classCallCheck","cols","validations","hyperlinks","comments","selector","scroll","history","autoFilter","change","exceptRowSet","sortedRowMap","unsortedRowMap","changeData","_this$selector","_this$selector2","setData","copyText","_this$selector$range","join","clipboardData","clearData","preventDefault","writeText","then","err","console","log","isClear","isCopy","isCut","resetSheet","eventTrigger","readText","contentToPaste","parseClipboardContent","startRow","startColumn","cellContent","clipboardContent","parsedData","txt","lines","srcRange","_selector$range2","cri","cci","getFirstIncludes","unmerge","_selector$range","isSingleSelected","mergeIndexes","_merges$ii","mri","mci","splice","_cell$merge2","mrl","mcl","bottom","right","getCellMerge","_selector$size2","nfont","oldCell","oldText","vIndex","findIndex","_this$selector3","_this$getSelectedRect","getSelectedRect","x1","y1","getRect","left0","top0","fsh","freezeTotalHeight","fsw","freezeTotalWidth","_getCellRowByY$call","scrollOffsety","frset","_getCellColByX$call","scrollOffsetx","_helper$rangeReduceIf2","totalWidth","totalHeight","_this$cellRect","cellRect","_this$selector$range2","_cell$merge3","_this$selector$range3","_cell$merge4","_this10","_selector$size4","_selector$range3","_this11","_selector$range4","_this12","addFilter","setSort","resetAutoFilter","_this13","_autoFilter$filteredR","filteredRows","fary","from","oldAry","b","_this14","_this15","_this15$selector$rang","si","insert","shift","_this16","_this16$selector$rang","shift1","_this17","_selector$range5","_selector$range$size2","rsize","csize","fci","_helper$rangeReduceIf4","fri","_helper$rangeReduceIf6","_cell$merge5","cellStyle","defaultStyle","_this$selector4","getCellStyleOrDefault","_this$freeze","_this18","_this19","setHeight","_this20","setWidth","_this$settings","_this$freeze2","_rows$maxCell2","maxCell","exceptRows","exceptRowTH","viewHeight","viewWidth","viewRange","filterIntersects","_selector$size6","rlen","clen","_selector$range6","unhide","frary","_toConsumableArray","offset","rowHeight","colWidth","nstyle","_this21","_this22","_this22$selector$rang","splitColumn","target","fn","unbind","removeEventListener","unbindClickoutside","xclickoutside","body","bindClickoutside","detail","mouseMoveUp","movefunc","upfunc","xEvtUp","calTouchDirection","spanx","spany","abs","cssPrefix","devicePixelRatio","Resizer","vertical","minDistance","resizer_classCallCheck","moving","children","unhideHoverEl","on","mousedblclickHandler","hoverEl","mousedownHandler","lineEl","cRect","finishedFn","unhideFn","unhideIndex","show","rect","line","hideUnhide","startEvt","distance","e","buttons","movementX","movementY","Scrollbar","scrollbar_classCallCheck","moveFn","contentEl","_evt$target","contentDistance","cssKey","startZIndex","SelectorElement","useHideInput","autoFocus","component_selector_classCallCheck","inputChange","cornerEl","areaEl","clipboardEl","autofillEl","hideInput","hideInputDiv","of","val","calBRAreaOffset","ftwidth","ftheight","calTAreaOffset","calLAreaOffset","setBRAreaOffset","br","setAreaOffset","setTAreaOffset","setLAreaOffset","setLClipboardOffset","setClipboardOffset","setBRClipboardOffset","setTClipboardOffset","setAllAreaOffset","tl","setAllClipboardOffset","areaOffset","indexes","arange","lastri","lastci","resetAreaOffset","freezeHeight","freezeWidth","setOffset","coffset","getClipboardRect","resetOffset","indexesUpdated","calSelectedRangeByStart","setIndexes","moveIndexes","calSelectedRangeByEnd","_this$data$selector$r","setEnd","ern","ecn","showAutofill","hideAutofill","showClipboard","hideClipboard","inputEnter","filterItems","itemIndex","click","Suggest","items","itemClick","suggest_classCallCheck","cssRemoveKeys","parent","_el$html","startsWith","toUpperCase","title","label","html","suggest_toConsumableArray","input","keyCode","ctrlKey","Icon","icon_classCallCheck","_possibleConstructorReturn","_getPrototypeOf","iconNameEl","addMonth","step","setMonth","getMonth","weekday","setDate","getDay","Calendar","_h","calendar_classCallCheck","cvalue","headerLeftEl","bodyEl","buildAll","prev","calendar_toConsumableArray","week","selectChange","buildHeaderLeft","buildBody","getFullYear","_bodyEl$html","trs","year","month","cdate","startDate","datess","disabled","getDate","monthDays","_h2","tds","Datepicker","datepicker_classCallCheck","setValue","RegExp","resetTextareaSize","inputText","textlineEl","textEl","txts","maxTxtSize","editor_toConsumableArray","fontWidth","tlineWidth","maxWidth","viewFn","h1","twidth","keydownEventHandler","altKey","itxt","selectionEnd","ntxt","setSelectionRange","setText","position","blur","setTimeout","Editor","formulas","editor_classCallCheck","suggest","start","lastIndexOf","sit","eit","indexOf","datepicker","dateFormat","search","bindInputEvents","setItems","suggestPosition","elOffset","sOffset","Button","button_classCallCheck","button_possibleConstructorReturn","button_getPrototypeOf","dpr","thinLineWidth","npx","px","npxLine","DrawBox","padding","draw_classCallCheck","borderTop","borderRight","borderBottom","borderLeft","drawFontLine","tx","ty","blheight","blwidth","floffset","Draw","ctx","getContext","resize","scale","clearRect","options","beginPath","restore","fillRect","fillText","mtxt","box","attr","textWrap","textx","textAlign","textBaseline","fillStyle","strokeStyle","biw","innerWidth","ntxts","txtWidth","measureText","textLine","substr","txtHeight","texty","lineWidth","setLineDash","draw_slicedToArray","moveTo","lineTo","stroke","draw_toConsumableArray","topxys","rightxys","bottomxys","leftxys","sx","sy","closePath","fill","dtextcb","clip","baseFonts","fontSizes","pt","infixExprToSuffixExpr","operatorStack","stack","subStrs","fnArgType","fnArgOperator","fnArgsLen","oldc","c1","cell_slicedToArray","ex","ey","rangelen","nc","evalSubExpr","subExpr","cellRender","fl","expr","evalSuffixExpr","srcStack","formulaMap","cellList","fc","_expr","params","render","reverse","core_cell","getCellText","baseFormulas","ary","reduce","formula_toConsumableArray","formula_slicedToArray","f","every","some","formulam","formatStringRender","formatNumberRender","_v1$split2","format_toArray","first","parts","format_toConsumableArray","baseFormats","formatm","cellPaddingWidth","tableFixedHeaderCleanStyle","tableGridStyle","getDrawBox","rindex","yoffset","_data$cellRect","renderCell","draw","nrindex","frozen","dbox","setBorders","strokeBorders","cellText","evalPaused","_cell","getCellTextOrDefault","getFontSizePxByPt","getError","renderContent","fw","fh","exceptRowTotalHeight","filteredTranslateFunc","eachMergesInView","afRange","dropdown","renderSelectedHeaderCell","renderFixedHeaders","nty","ntx","_data$selector$range","rowEach","colEach","renderContentGrid","ch","cw","Table","table_classCallCheck","_data$scroll","_data$freeze","table_slicedToArray","vr","freezeViewRange","ftw","fth","theight","PAGER_SIZES","PAGER_ORIENTATIONS","inches2px","inc","btnClick","toPrint","Print","print_classCallCheck","paper","print_toConsumableArray","ps","preview","iwidth","iheight","contentRange","pages","canvases","mViewRange","_loop","th","yo","wrap","canvas","rh","yof","contentWindow","idoc","head","cloneNode","drawImage","menuItems","buildMenu","menus","ContextMenu","contextmenu_classCallCheck","contextmenu_toConsumableArray","setMode","hideEl","find","vhf","Item","shortcut","item_classCallCheck","tip","element","_target$getBoundingCl","elBox","tooltip","DropdownItem","dd","getValue","_get","dropdown_item_getPrototypeOf","setTitle","Dropdown","showArrow","placement","dropdown_classCallCheck","dropdown_possibleConstructorReturn","dropdown_getPrototypeOf","headerClick","setContentChildren","headerEl","_this$contentEl","DropdownAlign","aligns","_getPrototypeOf2","dropdown_align_classCallCheck","icon","naligns","iconName","dropdown_align_possibleConstructorReturn","dropdown_align_getPrototypeOf","dropdown_align_toConsumableArray","setName","Align","align_classCallCheck","align_possibleConstructorReturn","align_getPrototypeOf","Valign","valign_classCallCheck","valign_possibleConstructorReturn","valign_getPrototypeOf","ToggleItem","toggle_item_get","toggle_item_getPrototypeOf","hasClass","Autofilter","autofilter_classCallCheck","autofilter_possibleConstructorReturn","autofilter_getPrototypeOf","Bold","bold_classCallCheck","bold_possibleConstructorReturn","bold_getPrototypeOf","Italic","italic_classCallCheck","italic_possibleConstructorReturn","italic_getPrototypeOf","Strike","strike_classCallCheck","strike_possibleConstructorReturn","strike_getPrototypeOf","Underline","underline_classCallCheck","underline_possibleConstructorReturn","underline_getPrototypeOf","themeColorPlaceHolders","themeColors","standardColors","buildTd","ColorPalette","_h4","color_palette_classCallCheck","table","color_palette_toConsumableArray","_h3","DropdownColor","dropdown_color_classCallCheck","colorPalette","dropdown_color_possibleConstructorReturn","dropdown_color_getPrototypeOf","lineTypes","DropdownLineType","dropdown_linetype_classCallCheck","beforei","lineTypeEls","iti","dropdown_linetype_possibleConstructorReturn","dropdown_linetype_getPrototypeOf","dropdown_linetype_toConsumableArray","buildTable","BorderPalette","border_palette_classCallCheck","ddColor","ddType","border_palette_slicedToArray","border_palette_toConsumableArray","DropdownBorder","dropdown_border_classCallCheck","borderPalette","dropdown_border_possibleConstructorReturn","dropdown_border_getPrototypeOf","Border","border_classCallCheck","border_possibleConstructorReturn","border_getPrototypeOf","IconItem","icon_item_get","icon_item_getPrototypeOf","Clearformat","clearformat_classCallCheck","clearformat_possibleConstructorReturn","clearformat_getPrototypeOf","Paintformat","paintformat_classCallCheck","paintformat_possibleConstructorReturn","paintformat_getPrototypeOf","TextColor","text_color_classCallCheck","text_color_possibleConstructorReturn","text_color_getPrototypeOf","FillColor","fill_color_classCallCheck","fill_color_possibleConstructorReturn","fill_color_getPrototypeOf","DropdownFontSize","dropdown_fontsize_classCallCheck","nfontSizes","dropdown_fontsize_possibleConstructorReturn","dropdown_fontsize_getPrototypeOf","dropdown_fontsize_toConsumableArray","Format","font_size_classCallCheck","font_size_possibleConstructorReturn","font_size_getPrototypeOf","DropdownFontsize","DropdownFont","dropdown_font_classCallCheck","nfonts","dropdown_font_possibleConstructorReturn","dropdown_font_getPrototypeOf","dropdown_font_toConsumableArray","Font","font_classCallCheck","font_possibleConstructorReturn","font_getPrototypeOf","DropdownFormat","dropdown_format_classCallCheck","nformats","dropdown_format_possibleConstructorReturn","dropdown_format_getPrototypeOf","dropdown_format_toConsumableArray","format_classCallCheck","format_possibleConstructorReturn","format_getPrototypeOf","DropdownFormula","dropdown_formula_classCallCheck","nformulas","dropdown_formula_possibleConstructorReturn","dropdown_formula_getPrototypeOf","dropdown_formula_toConsumableArray","formula_classCallCheck","formula_possibleConstructorReturn","formula_getPrototypeOf","Freeze","freeze_classCallCheck","freeze_possibleConstructorReturn","freeze_getPrototypeOf","Merge","toolbar_merge_classCallCheck","merge_possibleConstructorReturn","merge_getPrototypeOf","Redo","redo_classCallCheck","redo_possibleConstructorReturn","redo_getPrototypeOf","Undo","undo_classCallCheck","undo_possibleConstructorReturn","undo_getPrototypeOf","toolbar_print_classCallCheck","print_possibleConstructorReturn","print_getPrototypeOf","Textwrap","textwrap_classCallCheck","textwrap_possibleConstructorReturn","textwrap_getPrototypeOf","DropdownMore","more_classCallCheck","moreBtns","more_possibleConstructorReturn","more_getPrototypeOf","More","buildDivider","moreResize","_btns$html","_moreBtns$html","btns","moreEl","btns2","_moreEl$dd","widthFn","sumWidth2","list1","list2","toolbar_slicedToArray","genBtn","btn","onClick","Toolbar","toolbar_classCallCheck","undoEl","redoEl","paintformatEl","clearformatEl","formatEl","fontEl","fontSizeEl","FontSize","boldEl","italicEl","underlineEl","strikeEl","textColorEl","fillColorEl","borderEl","mergeEl","alignEl","valignEl","textwrapEl","freezeEl","autofilterEl","formulaEl","Formula","_data$settings$extend","extendToolbar","reset","_el$computedStyle","computedStyle","marginLeft","marginRight","_it$computedStyle","getSelectedCellStyle","setState","canUnmerge","canAutofilter","freezeIsActive","Modal","modal_classCallCheck","modal_toConsumableArray","dimmer","_this$el$show$box","_document$documentEle","xkeydownEsc","FormInput","hint","form_input_classCallCheck","vchange","FormSelect","getTitle","form_select_classCallCheck","itemEl","patterns","FormField","rule","labelWidth","form_field_classCallCheck","pattern","fieldLabelWidth","ModalValidation","modal_validation_classCallCheck","mf","rf","cf","criteriaSelected","criteriaOperatorSelected","minvf","maxvf","svf","vf","modal_validation_possibleConstructorReturn","modal_validation_getPrototypeOf","action","attrs","field","isShow","clsName","buildSortItem","resetFilterHeader","filterhEl","filterValues","checked","SortFilter","sort_filter_classCallCheck","filterbEl","filterClick","sortAscEl","sortDescEl","sortDesc","tindex","xtoast","_el$box","Comment","comment_classCallCheck","titleEl","init","setPos","SplitColumn","split_column_classCallCheck","split_column_possibleConstructorReturn","split_column_getPrototypeOf","splitCoumn","optionsDom","querySelectorAll","otherValue","querySelector","splitData","previewData","resetData","regex","reg","buildRegex","maxLength","split_column_toConsumableArray","splitted","diff","previewDom","previewHtml","throttle","func","wait","timeout","that","selectorSet","contextMenu","trigger","selectorMove","direction","_selector$indexes","sheet_slicedToArray","_selector$moveIndexes","verticalScrollbar","horizontalScrollbar","_data$getSelectedRect","tableOffset","getTableOffset","verticalScrollbarSet","erth","horizontalScrollbarSet","sheetReset","tableEl","overlayerEl","overlayerCEl","tOffset","vRect","editor","fwidth","fheight","setFreezeLengths","clearClipboard","copyToSystemClipboard","pasteFromSystemClipboard","msg","cdata","pasteFromText","unhideRowsOrCols","overlayerMousedown","sortFilter","offsetX","offsetY","isAutofillEl","getCellRectByXY","getSort","shiftKey","_data$getCellRectByXY","paintformatActive","paintformatToggle","editorSetOffset","sPosition","editorSet","getSelectedCell","getSelectedValidator","dataSetCellText","setSelectedCellText","_data$selector","insertDeleteRowColumn","num","sheet_typeof","insertRight","setSelectedCellAttr","toolbarChange","_data$selector2","sheetInitEvents","end","startx","starty","rowResizer","colResizer","modalValidation","comment","showComment","hideComment","tRect","showUnhide","xyInSelectedRect","setPosition","deltaY","deltaX","loopValue","vFunc","moveY","tempY","tempX","temp","horizontal","moveX","_evt$touches$","touches","pageX","pageY","_evt$changedTouches$","changedTouches","_evt$changedTouches$2","setAutoFilter","scrolly","resetBRLAreaOffset","scrollx","resetBRTAreaOffset","itext","_this6$data","addValidation","removeValidation","getSelectedValidation","hideRowsOrCols","alert","showDlg","resizeHandle","reload","clickHandle","focusing","pasteHandle","copyHandle","keydownHandle","which","metaKey","Sheet","targetEl","sheet_classCallCheck","eventMap","listeners","callback","currentListener","removeListener","current","once","execCalllback","fire","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","iterator","done","event_toConsumableArray","return","removeAllListeners","createEventEmitter","_data$settings","_len3","_key3","setFreeze","_this$data","_this$getRect","bottombar_classCallCheck","bottombar_possibleConstructorReturn","bottombar_getPrototypeOf","contentClick","bottombar_toConsumableArray","_h$css","Bottombar","addFunc","swapFunc","deleteFunc","updateFunc","dataNames","activeEl","deleteEl","clickSwap2","menuEl","nindex","renameItem","clickSwap","bottombar_slicedToArray","Spreadsheet","selectors","src_classCallCheck","_objectSpread","sheetIndex","datas","bottombar","addSheet","sheet","rootEl","_this2$sheet","addItem","_this$bottombar$delet2","src_slicedToArray","deleteItem","oldIndex","ds","nd","getCellStyle","spreadsheet"],"mappings":"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","file":"xspreadsheet.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n","/* global document */\r\n/* global window */\r\nclass Element {\r\n  constructor(tag, className = '') {\r\n    if (typeof tag === 'string') {\r\n      this.el = document.createElement(tag);\r\n      this.el.className = className;\r\n    } else {\r\n      this.el = tag;\r\n    }\r\n    this.data = {};\r\n  }\r\n\r\n  data(key, value) {\r\n    if (value !== undefined) {\r\n      this.data[key] = value;\r\n      return this;\r\n    }\r\n    return this.data[key];\r\n  }\r\n\r\n  on(eventNames, handler) {\r\n    const [fen, ...oen] = eventNames.split('.');\r\n    let eventName = fen;\r\n    if (eventName === 'mousewheel' && /Firefox/i.test(window.navigator.userAgent)) {\r\n      eventName = 'DOMMouseScroll';\r\n    }\r\n    this.el.addEventListener(eventName, (evt) => {\r\n      handler(evt);\r\n      for (let i = 0; i < oen.length; i += 1) {\r\n        const k = oen[i];\r\n        if (k === 'left' && evt.button !== 0) {\r\n          return;\r\n        }\r\n        if (k === 'right' && evt.button !== 2) {\r\n          return;\r\n        }\r\n        if (k === 'stop') {\r\n          evt.stopPropagation();\r\n        }\r\n      }\r\n    });\r\n    return this;\r\n  }\r\n\r\n  offset(value) {\r\n    if (value !== undefined) {\r\n      Object.keys(value).forEach((k) => {\r\n        this.css(k, `${value[k]}px`);\r\n      });\r\n      return this;\r\n    }\r\n    const {\r\n      offsetTop, offsetLeft, offsetHeight, offsetWidth,\r\n    } = this.el;\r\n    return {\r\n      top: offsetTop,\r\n      left: offsetLeft,\r\n      height: offsetHeight,\r\n      width: offsetWidth,\r\n    };\r\n  }\r\n\r\n  scroll(v) {\r\n    const { el } = this;\r\n    if (v !== undefined) {\r\n      if (v.left !== undefined) {\r\n        el.scrollLeft = v.left;\r\n      }\r\n      if (v.top !== undefined) {\r\n        el.scrollTop = v.top;\r\n      }\r\n    }\r\n    return { left: el.scrollLeft, top: el.scrollTop };\r\n  }\r\n\r\n  box() {\r\n    return this.el.getBoundingClientRect();\r\n  }\r\n\r\n  parent() {\r\n    return new Element(this.el.parentNode);\r\n  }\r\n\r\n  children(...eles) {\r\n    if (arguments.length === 0) {\r\n      return this.el.childNodes;\r\n    }\r\n    eles.forEach(ele => this.child(ele));\r\n    return this;\r\n  }\r\n\r\n  removeChild(el) {\r\n    this.el.removeChild(el);\r\n  }\r\n\r\n  /*\r\n  first() {\r\n    return this.el.firstChild;\r\n  }\r\n\r\n  last() {\r\n    return this.el.lastChild;\r\n  }\r\n\r\n  remove(ele) {\r\n    return this.el.removeChild(ele);\r\n  }\r\n\r\n  prepend(ele) {\r\n    const { el } = this;\r\n    if (el.children.length > 0) {\r\n      el.insertBefore(ele, el.firstChild);\r\n    } else {\r\n      el.appendChild(ele);\r\n    }\r\n    return this;\r\n  }\r\n\r\n  prev() {\r\n    return this.el.previousSibling;\r\n  }\r\n\r\n  next() {\r\n    return this.el.nextSibling;\r\n  }\r\n  */\r\n\r\n  child(arg) {\r\n    let ele = arg;\r\n    if (typeof arg === 'string') {\r\n      ele = document.createTextNode(arg);\r\n    } else if (arg instanceof Element) {\r\n      ele = arg.el;\r\n    }\r\n    this.el.appendChild(ele);\r\n    return this;\r\n  }\r\n\r\n  contains(ele) {\r\n    return this.el.contains(ele);\r\n  }\r\n\r\n  className(v) {\r\n    if (v !== undefined) {\r\n      this.el.className = v;\r\n      return this;\r\n    }\r\n    return this.el.className;\r\n  }\r\n\r\n  addClass(name) {\r\n    this.el.classList.add(name);\r\n    return this;\r\n  }\r\n\r\n  hasClass(name) {\r\n    return this.el.classList.contains(name);\r\n  }\r\n\r\n  removeClass(name) {\r\n    this.el.classList.remove(name);\r\n    return this;\r\n  }\r\n\r\n  toggle(cls = 'active') {\r\n    return this.toggleClass(cls);\r\n  }\r\n\r\n  toggleClass(name) {\r\n    return this.el.classList.toggle(name);\r\n  }\r\n\r\n  active(flag = true, cls = 'active') {\r\n    if (flag) this.addClass(cls);\r\n    else this.removeClass(cls);\r\n    return this;\r\n  }\r\n\r\n  checked(flag = true) {\r\n    this.active(flag, 'checked');\r\n    return this;\r\n  }\r\n\r\n  disabled(flag = true) {\r\n    if (flag) this.addClass('disabled');\r\n    else this.removeClass('disabled');\r\n    return this;\r\n  }\r\n\r\n  // key, value\r\n  // key\r\n  // {k, v}...\r\n  attr(key, value) {\r\n    if (value !== undefined) {\r\n      this.el.setAttribute(key, value);\r\n    } else {\r\n      if (typeof key === 'string') {\r\n        return this.el.getAttribute(key);\r\n      }\r\n      Object.keys(key).forEach((k) => {\r\n        this.el.setAttribute(k, key[k]);\r\n      });\r\n    }\r\n    return this;\r\n  }\r\n\r\n  removeAttr(key) {\r\n    this.el.removeAttribute(key);\r\n    return this;\r\n  }\r\n\r\n  html(content) {\r\n    if (content !== undefined) {\r\n      this.el.innerHTML = content;\r\n      return this;\r\n    }\r\n    return this.el.innerHTML;\r\n  }\r\n\r\n  val(v) {\r\n    if (v !== undefined) {\r\n      this.el.value = v;\r\n      return this;\r\n    }\r\n    return this.el.value;\r\n  }\r\n\r\n  focus() {\r\n    this.el.focus();\r\n  }\r\n\r\n  cssRemoveKeys(...keys) {\r\n    keys.forEach(k => this.el.style.removeProperty(k));\r\n    return this;\r\n  }\r\n\r\n  // css( propertyName )\r\n  // css( propertyName, value )\r\n  // css( properties )\r\n  css(name, value) {\r\n    if (value === undefined && typeof name !== 'string') {\r\n      Object.keys(name).forEach((k) => {\r\n        this.el.style[k] = name[k];\r\n      });\r\n      return this;\r\n    }\r\n    if (value !== undefined) {\r\n      this.el.style[name] = value;\r\n      return this;\r\n    }\r\n    return this.el.style[name];\r\n  }\r\n\r\n  computedStyle() {\r\n    return window.getComputedStyle(this.el, null);\r\n  }\r\n\r\n  show() {\r\n    this.css('display', 'block');\r\n    return this;\r\n  }\r\n\r\n  hide() {\r\n    this.css('display', 'none');\r\n    return this;\r\n  }\r\n}\r\n\r\nconst h = (tag, className = '') => new Element(tag, className);\r\n\r\nexport {\r\n  Element,\r\n  h,\r\n};\r\n","import './_.prototypes';\n\nconst alphabets = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z'];\n\n/** index number 2 letters\n * @example stringAt(26) ==> 'AA'\n * @date 2019-10-10\n * @export\n * @param {number} index\n * @returns {string}\n */\nexport function stringAt(index) {\n    let str = '';\n    let cindex = index;\n    while (cindex >= alphabets.length) {\n        cindex /= alphabets.length;\n        cindex -= 1;\n        str += alphabets[parseInt(cindex, 10) % alphabets.length];\n    }\n    const last = index % alphabets.length;\n    str += alphabets[last];\n    return str;\n}\n\n/** translate letter in A1-tag to number\n * @date 2019-10-10\n * @export\n * @param {string} str \"AA\" in A1-tag \"AA1\"\n * @returns {number}\n */\nexport function indexAt(str) {\n    let ret = 0;\n    for (let i = 0; i !== str.length; ++i) ret = 26 * ret + str.charCodeAt(i) - 64;\n    return ret - 1;\n}\n\n\n// B10 => x,y\n/** translate A1-tag to XY-tag\n * @date 2019-10-10\n * @export\n * @param {tagA1} src\n * @returns {tagXY}\n */\nexport function expr2xy(src) {\n    let x = '';\n    let y = '';\n    for (let i = 0; i < src.length; i += 1) {\n        if (src.charAt(i) >= '0' && src.charAt(i) <= '9') {\n            y += src.charAt(i);\n        } else {\n            x += src.charAt(i);\n        }\n    }\n    return [indexAt(x), parseInt(y, 10) - 1];\n}\n\n/** translate XY-tag to A1-tag\n * @example x,y => B10\n * @date 2019-10-10\n * @export\n * @param {number} x\n * @param {number} y\n * @returns {tagA1}\n */\nexport function xy2expr(x, y) {\n    return `${stringAt(x)}${y + 1}`;\n}\n\n/** translate A1-tag src by (xn, yn)\n * @date 2019-10-10\n * @export\n * @param {tagA1} src\n * @param {number} xn\n * @param {number} yn\n * @returns {tagA1}\n */\nexport function expr2expr(src, xn, yn, condition = () => true) {\n    if (xn === 0 && yn === 0) return src;\n    const [x, y] = expr2xy(src);\n    if (!condition(x, y)) return src;\n    return xy2expr(x + xn, y + yn);\n}\n\nexport default {\n    stringAt,\n    indexAt,\n    expr2xy,\n    xy2expr,\n    expr2expr,\n};\n","import {xy2expr, expr2xy} from './alphabet';\n\nclass CellRange {\n    constructor(sri, sci, eri, eci, w = 0, h = 0) {\n        this.sri = sri;\n        this.sci = sci;\n        this.eri = eri;\n        this.eci = eci;\n        this.w = w;\n        this.h = h;\n    }\n\n    set(sri, sci, eri, eci) {\n        this.sri = sri;\n        this.sci = sci;\n        this.eri = eri;\n        this.eci = eci;\n    }\n\n    multiple() {\n        return this.eri - this.sri > 0 || this.eci - this.sci > 0;\n    }\n\n    // cell-index: ri, ci\n    // cell-ref: A10\n    includes(...args) {\n        let [ri, ci] = [0, 0];\n        if (args.length === 1) {\n            [ci, ri] = expr2xy(args[0]);\n        } else if (args.length === 2) {\n            [ri, ci] = args;\n        }\n        const {\n            sri, sci, eri, eci,\n        } = this;\n        return sri <= ri && ri <= eri && sci <= ci && ci <= eci;\n    }\n\n    each(cb, rowFilter = () => true) {\n        const {\n            sri, sci, eri, eci,\n        } = this;\n        for (let i = sri; i <= eri; i += 1) {\n            if (rowFilter(i)) {\n                for (let j = sci; j <= eci; j += 1) {\n                    cb(i, j);\n                }\n            }\n        }\n    }\n\n    contains(other) {\n        return this.sri <= other.sri\n            && this.sci <= other.sci\n            && this.eri >= other.eri\n            && this.eci >= other.eci;\n    }\n\n    // within\n    within(other) {\n        return this.sri >= other.sri\n            && this.sci >= other.sci\n            && this.eri <= other.eri\n            && this.eci <= other.eci;\n    }\n\n    // disjoint\n    disjoint(other) {\n        return this.sri > other.eri\n            || this.sci > other.eci\n            || other.sri > this.eri\n            || other.sci > this.eci;\n    }\n\n    // intersects\n    intersects(other) {\n        return this.sri <= other.eri\n            && this.sci <= other.eci\n            && other.sri <= this.eri\n            && other.sci <= this.eci;\n    }\n\n    // union\n    union(other) {\n        const {\n            sri, sci, eri, eci,\n        } = this;\n        return new CellRange(\n            other.sri < sri ? other.sri : sri,\n            other.sci < sci ? other.sci : sci,\n            other.eri > eri ? other.eri : eri,\n            other.eci > eci ? other.eci : eci,\n        );\n    }\n\n    // intersection\n    // intersection(other) {}\n\n    // Returns Array<CellRange> that represents that part of this that does not intersect with other\n    // difference\n    difference(other) {\n        const ret = [];\n        const addRet = (sri, sci, eri, eci) => {\n            ret.push(new CellRange(sri, sci, eri, eci));\n        };\n        const {\n            sri, sci, eri, eci,\n        } = this;\n        const dsr = other.sri - sri;\n        const dsc = other.sci - sci;\n        const der = eri - other.eri;\n        const dec = eci - other.eci;\n        if (dsr > 0) {\n            addRet(sri, sci, other.sri - 1, eci);\n            if (der > 0) {\n                addRet(other.eri + 1, sci, eri, eci);\n                if (dsc > 0) {\n                    addRet(other.sri, sci, other.eri, other.sci - 1);\n                }\n                if (dec > 0) {\n                    addRet(other.sri, other.eci + 1, other.eri, eci);\n                }\n            } else {\n                if (dsc > 0) {\n                    addRet(other.sri, sci, eri, other.sci - 1);\n                }\n                if (dec > 0) {\n                    addRet(other.sri, other.eci + 1, eri, eci);\n                }\n            }\n        } else if (der > 0) {\n            addRet(other.eri + 1, sci, eri, eci);\n            if (dsc > 0) {\n                addRet(sri, sci, other.eri, other.sci - 1);\n            }\n            if (dec > 0) {\n                addRet(sri, other.eci + 1, other.eri, eci);\n            }\n        }\n        if (dsc > 0) {\n            addRet(sri, sci, eri, other.sci - 1);\n            if (dec > 0) {\n                addRet(sri, other.eri + 1, eri, eci);\n                if (dsr > 0) {\n                    addRet(sri, other.sci, other.sri - 1, other.eci);\n                }\n                if (der > 0) {\n                    addRet(other.sri + 1, other.sci, eri, other.eci);\n                }\n            } else {\n                if (dsr > 0) {\n                    addRet(sri, other.sci, other.sri - 1, eci);\n                }\n                if (der > 0) {\n                    addRet(other.sri + 1, other.sci, eri, eci);\n                }\n            }\n        } else if (dec > 0) {\n            addRet(eri, other.eci + 1, eri, eci);\n            if (dsr > 0) {\n                addRet(sri, sci, other.sri - 1, other.eci);\n            }\n            if (der > 0) {\n                addRet(other.eri + 1, sci, eri, other.eci);\n            }\n        }\n        return ret;\n    }\n\n    size() {\n        return [\n            this.eri - this.sri + 1,\n            this.eci - this.sci + 1,\n        ];\n    }\n\n    toString() {\n        const {\n            sri, sci, eri, eci,\n        } = this;\n        let ref = xy2expr(sci, sri);\n        if (this.multiple()) {\n            ref = `${ref}:${xy2expr(eci, eri)}`;\n        }\n        return ref;\n    }\n\n    clone() {\n        const {\n            sri, sci, eri, eci, w, h,\n        } = this;\n        return new CellRange(sri, sci, eri, eci, w, h);\n    }\n\n    /*\n    toJSON() {\n      return this.toString();\n    }\n    */\n\n    equals(other) {\n        return this.eri === other.eri\n            && this.eci === other.eci\n            && this.sri === other.sri\n            && this.sci === other.sci;\n    }\n\n    static valueOf(ref) {\n        // B1:B8, B1 => 1 x 1 cell range\n        const refs = ref.split(':');\n        const [sci, sri] = expr2xy(refs[0]);\n        let [eri, eci] = [sri, sci];\n        if (refs.length > 1) {\n            [eci, eri] = expr2xy(refs[1]);\n        }\n        return new CellRange(sri, sci, eri, eci);\n    }\n}\n\nexport default CellRange;\n\nexport {\n    CellRange,\n};\n","import {CellRange} from './cell_range';\n\nexport default class Selector {\n    constructor() {\n        this.range = new CellRange(0, 0, 0, 0);\n        this.ri = 0;\n        this.ci = 0;\n    }\n\n    multiple() {\n        return this.range.multiple();\n    }\n\n    setIndexes(ri, ci) {\n        this.ri = ri;\n        this.ci = ci;\n    }\n\n    size() {\n        return this.range.size();\n    }\n}\n","export default class Scroll {\n    constructor() {\n        this.x = 0; // left\n        this.y = 0; // top\n        this.ri = 0; // cell row-index\n        this.ci = 0; // cell col-index\n    }\n}\n","// import helper from '../helper';\n\nexport default class History {\n    constructor() {\n        this.undoItems = [];\n        this.redoItems = [];\n    }\n\n    add(data) {\n        this.undoItems.push(JSON.stringify(data));\n        this.redoItems = [];\n    }\n\n    canUndo() {\n        return this.undoItems.length > 0;\n    }\n\n    canRedo() {\n        return this.redoItems.length > 0;\n    }\n\n    undo(currentd, cb) {\n        const {undoItems, redoItems} = this;\n        if (this.canUndo()) {\n            redoItems.push(JSON.stringify(currentd));\n            cb(JSON.parse(undoItems.pop()));\n        }\n    }\n\n    redo(currentd, cb) {\n        const {undoItems, redoItems} = this;\n        if (this.canRedo()) {\n            undoItems.push(JSON.stringify(currentd));\n            cb(JSON.parse(redoItems.pop()));\n        }\n    }\n}\n","export default class Clipboard {\n    constructor() {\n        this.range = null; // CellRange\n        this.state = 'clear';\n    }\n\n    copy(cellRange) {\n        this.range = cellRange;\n        this.state = 'copy';\n        return this;\n    }\n\n    cut(cellRange) {\n        this.range = cellRange;\n        this.state = 'cut';\n        return this;\n    }\n\n    isCopy() {\n        return this.state === 'copy';\n    }\n\n    isCut() {\n        return this.state === 'cut';\n    }\n\n    isClear() {\n        return this.state === 'clear';\n    }\n\n    clear() {\n        this.range = null;\n        this.state = 'clear';\n    }\n}\n","import {CellRange} from './cell_range';\n// operator: all|eq|neq|gt|gte|lt|lte|in|be\n// value:\n//   in => []\n//   be => [min, max]\nclass Filter {\n    constructor(ci, operator, value) {\n        this.ci = ci;\n        this.operator = operator;\n        this.value = value;\n    }\n\n    set(operator, value) {\n        this.operator = operator;\n        this.value = value;\n    }\n\n    includes(v) {\n        const {operator, value} = this;\n        if (operator === 'all') {\n            return true;\n        }\n        if (operator === 'in') {\n            return value.includes(v);\n        }\n        return false;\n    }\n\n    vlength() {\n        const {operator, value} = this;\n        if (operator === 'in') {\n            return value.length;\n        }\n        return 0;\n    }\n\n    getData() {\n        const {ci, operator, value} = this;\n        return {ci, operator, value};\n    }\n}\n\nclass Sort {\n    constructor(ci, order) {\n        this.ci = ci;\n        this.order = order;\n    }\n\n    asc() {\n        return this.order === 'asc';\n    }\n\n    desc() {\n        return this.order === 'desc';\n    }\n}\n\nexport default class AutoFilter {\n    constructor() {\n        this.ref = null;\n        this.filters = [];\n        this.sort = null;\n    }\n\n    setData({ref, filters, sort}) {\n        if (ref != null) {\n            this.ref = ref;\n            this.filters = filters.map(it => new Filter(it.ci, it.operator, it.value));\n            if (sort) {\n                this.sort = new Sort(sort.ci, sort.order);\n            }\n        }\n    }\n\n    getData() {\n        if (this.active()) {\n            const {ref, filters, sort} = this;\n            return {ref, filters: filters.map(it => it.getData()), sort};\n        }\n        return {};\n    }\n\n    addFilter(ci, operator, value) {\n        const filter = this.getFilter(ci);\n        if (filter == null) {\n            this.filters.push(new Filter(ci, operator, value));\n        } else {\n            filter.set(operator, value);\n        }\n    }\n\n    setSort(ci, order) {\n        this.sort = order ? new Sort(ci, order) : null;\n    }\n\n    includes(ri, ci) {\n        if (this.active()) {\n            return this.hrange().includes(ri, ci);\n        }\n        return false;\n    }\n\n    getSort(ci) {\n        const {sort} = this;\n        if (sort && sort.ci === ci) {\n            return sort;\n        }\n        return null;\n    }\n\n    getFilter(ci) {\n        const {filters} = this;\n        for (let i = 0; i < filters.length; i += 1) {\n            if (filters[i].ci === ci) {\n                return filters[i];\n            }\n        }\n        return null;\n    }\n\n    filteredRows(getCell) {\n        // const ary = [];\n        // let lastri = 0;\n        const rset = new Set();\n        const fset = new Set();\n        if (this.active()) {\n            const {sri, eri} = this.range();\n            const {filters} = this;\n            for (let ri = sri + 1; ri <= eri; ri += 1) {\n                for (let i = 0; i < filters.length; i += 1) {\n                    const filter = filters[i];\n                    const cell = getCell(ri, filter.ci);\n                    const ctext = cell ? cell.text : '';\n                    if (!filter.includes(ctext)) {\n                        rset.add(ri);\n                        break;\n                    } else {\n                        fset.add(ri);\n                    }\n                }\n            }\n        }\n        return {rset, fset};\n    }\n\n    items(ci, getCell) {\n        const m = {};\n        if (this.active()) {\n            const {sri, eri} = this.range();\n            for (let ri = sri + 1; ri <= eri; ri += 1) {\n                const cell = getCell(ri, ci);\n                if (cell !== null && !/^\\s*$/.test(cell.text)) {\n                    const key = cell.text;\n                    const cnt = (m[key] || 0) + 1;\n                    m[key] = cnt;\n                } else {\n                    m[''] = (m[''] || 0) + 1;\n                }\n            }\n        }\n        return m;\n    }\n\n    range() {\n        return CellRange.valueOf(this.ref);\n    }\n\n    hrange() {\n        const r = this.range();\n        r.eri = r.sri;\n        return r;\n    }\n\n    clear() {\n        this.ref = null;\n        this.filters = [];\n        this.sort = null;\n    }\n\n    active() {\n        return this.ref !== null;\n    }\n}\n","import {CellRange} from './cell_range';\n\nclass Merges {\n    constructor(d = []) {\n        this._ = d;\n    }\n\n    forEach(cb) {\n        this._.forEach(cb);\n    }\n\n    deleteWithin(cr) {\n        this._ = this._.filter(it => !it.within(cr));\n    }\n\n    getFirstIncludes(ri, ci) {\n        for (let i = 0; i < this._.length; i += 1) {\n            const it = this._[i];\n            if (it.includes(ri, ci)) {\n                return it;\n            }\n        }\n        return null;\n    }\n\n    filterIntersects(cellRange) {\n        return new Merges(this._.filter(it => it.intersects(cellRange)));\n    }\n\n    intersects(cellRange) {\n        for (let i = 0; i < this._.length; i += 1) {\n            const it = this._[i];\n            if (it.intersects(cellRange)) {\n                // console.log('intersects');\n                return true;\n            }\n        }\n        return false;\n    }\n\n    union(cellRange) {\n        let cr = cellRange;\n        this._.forEach((it) => {\n            if (it.intersects(cr)) {\n                cr = it.union(cr);\n            }\n        });\n        return cr;\n    }\n\n    add(cr) {\n        this.deleteWithin(cr);\n        this._.push(cr);\n    }\n\n    // type: row | column\n    shift(type, index, n, cbWithin) {\n        this._.forEach((cellRange) => {\n            const {\n                sri, sci, eri, eci,\n            } = cellRange;\n            const range = cellRange;\n            if (type === 'row') {\n                if (sri >= index) {\n                    range.sri += n;\n                    range.eri += n;\n                } else if (sri < index && index <= eri) {\n                    range.eri += n;\n                    cbWithin(sri, sci, n, 0);\n                }\n            } else if (type === 'column') {\n                if (sci >= index) {\n                    range.sci += n;\n                    range.eci += n;\n                } else if (sci < index && index <= eci) {\n                    range.eci += n;\n                    cbWithin(sri, sci, 0, n);\n                }\n            }\n        });\n    }\n\n    // type: row | column \n    shift1(type, index, n, cbWithin) {\n        this._.forEach((cellRange) => {\n            const {\n                sri, sci, eri, eci,\n            } = cellRange;\n            const range = cellRange;\n            if (type === 'row') {\n                if (sri > index) {\n                    range.sri += n;\n                    range.eri += n;\n                } else if (sri <= index && index <= eri) {\n                    range.eri += n;\n                    cbWithin(sri, sci, n, 0);\n                }\n            } else if (type === 'column') {\n                if (sci > index) {\n                    range.sci += n;\n                    range.eci += n;\n                } else if (sci <= index && index <= eci) {\n                    range.eci += n;\n                    cbWithin(sri, sci, 0, n);\n                }\n            }\n        });\n    }\n\n    move(cellRange, rn, cn) {\n        this._.forEach((it1) => {\n            const it = it1;\n            if (it.within(cellRange)) {\n                it.eri += rn;\n                it.sri += rn;\n                it.sci += cn;\n                it.eci += cn;\n            }\n        });\n    }\n\n    setData(merges) {\n        this._ = merges.map(merge => CellRange.valueOf(merge));\n        return this;\n    }\n\n    getData() {\n        return this._.map(merge => merge.toString());\n    }\n}\n\nexport default {};\nexport {\n    Merges,\n};\n","/* eslint-disable no-param-reassign */\nfunction cloneDeep(obj) {\n    return JSON.parse(JSON.stringify(obj));\n}\n\nconst mergeDeep = (object = {}, ...sources) => {\n    sources.forEach((source) => {\n        Object.keys(source).forEach((key) => {\n            const v = source[key];\n            // console.log('k:', key, ', v:', source[key], typeof v, v instanceof Object);\n            if (typeof v === 'string' || typeof v === 'number' || typeof v === 'boolean') {\n                object[key] = v;\n            } else if (typeof v !== 'function' && !Array.isArray(v) && v instanceof Object) {\n                object[key] = object[key] || {};\n                mergeDeep(object[key], v);\n            } else {\n                object[key] = v;\n            }\n        });\n    });\n    // console.log('::', object);\n    return object;\n};\n\nfunction equals(obj1, obj2) {\n    const keys = Object.keys(obj1);\n    if (keys.length !== Object.keys(obj2).length) return false;\n    for (let i = 0; i < keys.length; i += 1) {\n        const k = keys[i];\n        const v1 = obj1[k];\n        const v2 = obj2[k];\n        if (v2 === undefined) return false;\n        if (typeof v1 === 'string' || typeof v1 === 'number' || typeof v1 === 'boolean') {\n            if (v1 !== v2) return false;\n        } else if (Array.isArray(v1)) {\n            if (v1.length !== v2.length) return false;\n            for (let ai = 0; ai < v1.length; ai += 1) {\n                if (!equals(v1[ai], v2[ai])) return false;\n            }\n        } else if (typeof v1 !== 'function' && !Array.isArray(v1) && v1 instanceof Object) {\n            if (!equals(v1, v2)) return false;\n        }\n    }\n    return true;\n}\n\n/*\n  objOrAry: obejct or Array\n  cb: (value, index | key) => { return value }\n*/\nconst sum = (objOrAry, cb = value => value) => {\n    let total = 0;\n    let size = 0;\n    Object.keys(objOrAry).forEach((key) => {\n        total += cb(objOrAry[key], key);\n        size += 1;\n    });\n    return [total, size];\n};\n\nfunction deleteProperty(obj, property) {\n    const oldv = obj[`${property}`];\n    delete obj[`${property}`];\n    return oldv;\n}\n\nfunction rangeReduceIf(min, max, inits, initv, ifv, getv) {\n    let s = inits;\n    let v = initv;\n    let i = min;\n    for (; i < max; i += 1) {\n        if (s > ifv) break;\n        v = getv(i);\n        s += v;\n    }\n    return [i, s - v, v];\n}\n\nfunction rangeSum(min, max, getv) {\n    let s = 0;\n    for (let i = min; i < max; i += 1) {\n        s += getv(i);\n    }\n    return s;\n}\n\nfunction rangeEach(min, max, cb) {\n    for (let i = min; i < max; i += 1) {\n        cb(i);\n    }\n}\n\nfunction arrayEquals(a1, a2) {\n    if (a1.length === a2.length) {\n        for (let i = 0; i < a1.length; i += 1) {\n            if (a1[i] !== a2[i]) return false;\n        }\n    } else return false;\n    return true;\n}\n\nfunction digits(a) {\n    const v = `${a}`;\n    let ret = 0;\n    let flag = false;\n    for (let i = 0; i < v.length; i += 1) {\n        if (flag === true) ret += 1;\n        if (v.charAt(i) === '.') flag = true;\n    }\n    return ret;\n}\n\nexport function numberCalc(type, a1, a2) {\n    if (Number.isNaN(a1) || Number.isNaN(a2)) {\n        return a1 + type + a2;\n    }\n    const al1 = digits(a1);\n    const al2 = digits(a2);\n    const num1 = Number(a1);\n    const num2 = Number(a2);\n    let ret = 0;\n    if (type === '-') {\n        ret = num1 - num2;\n    } else if (type === '+') {\n        ret = num1 + num2;\n    } else if (type === '*') {\n        ret = num1 * num2;\n    } else if (type === '/') {\n        ret = num1 / num2;\n        if (digits(ret) > 5) return ret.toFixed(2);\n        return ret;\n    }\n    return ret.toFixed(Math.max(al1, al2));\n}\n\nexport default {\n    cloneDeep,\n    merge: (...sources) => mergeDeep({}, ...sources),\n    equals,\n    arrayEquals,\n    sum,\n    rangeEach,\n    rangeSum,\n    rangeReduceIf,\n    deleteProperty,\n    numberCalc,\n};\n","import helper from './helper';\nimport {expr2expr} from './alphabet';\n\nclass Rows {\n    constructor({len, height}) {\n        this._ = {};\n        this.len = len;\n        // default row height\n        this.height = height;\n    }\n\n    getHeight(ri) {\n        if (this.isHide(ri)) return 0;\n        const row = this.get(ri);\n        if (row && row.height) {\n            return row.height;\n        }\n        return this.height;\n    }\n\n    setHeight(ri, v) {\n        const row = this.getOrNew(ri);\n        row.height = v;\n    }\n\n    unhide(idx) {\n        let index = idx;\n        while (index > 0) {\n            index -= 1;\n            if (this.isHide(index)) {\n                this.setHide(index, false);\n            } else break;\n        }\n    }\n\n    isHide(ri) {\n        const row = this.get(ri);\n        return row && row.hide;\n    }\n\n    setHide(ri, v) {\n        const row = this.getOrNew(ri);\n        if (v === true) row.hide = true;\n        else delete row.hide;\n    }\n\n    setStyle(ri, style) {\n        const row = this.getOrNew(ri);\n        row.style = style;\n    }\n\n    sumHeight(min, max, exceptSet) {\n        return helper.rangeSum(min, max, (i) => {\n            if (exceptSet && exceptSet.has(i)) return 0;\n            return this.getHeight(i);\n        });\n    }\n\n    totalHeight() {\n        return this.sumHeight(0, this.len);\n    }\n\n    get(ri) {\n        return this._[ri];\n    }\n\n    getOrNew(ri) {\n        this._[ri] = this._[ri] || {cells: {}};\n        return this._[ri];\n    }\n\n    getCell(ri, ci) {\n        const row = this.get(ri);\n        if (row !== undefined && row.cells !== undefined && row.cells[ci] !== undefined) {\n            return row.cells[ci];\n        }\n        return null;\n    }\n\n    getCellMerge(ri, ci) {\n        const cell = this.getCell(ri, ci);\n        if (cell && cell.merge) return cell.merge;\n        return [0, 0];\n    }\n\n    getCellOrNew(ri, ci) {\n        const row = this.getOrNew(ri);\n        row.cells[ci] = row.cells[ci] || {};\n        return row.cells[ci];\n    }\n\n    // what: all | text | format\n    setCell(ri, ci, cell, what = 'all') {\n        const row = this.getOrNew(ri);\n        if (what === 'all') {\n            row.cells[ci] = cell;\n        } else if (what === 'text') {\n            row.cells[ci] = row.cells[ci] || {};\n            row.cells[ci].text = cell.text;\n        } else if (what === 'format') {\n            row.cells[ci] = row.cells[ci] || {};\n            row.cells[ci].style = cell.style;\n            if (cell.merge) row.cells[ci].merge = cell.merge;\n        }\n    }\n\n    setCellText(ri, ci, text) {\n        const cell = this.getCellOrNew(ri, ci);\n        if (cell.editable !== false) cell.text = text;\n    }\n\n    // what: all | format | text\n    copyPaste(srcCellRange, dstCellRange, what, autofill = false, cb = () => {\n    }) {\n        const {\n            sri, sci, eri, eci,\n        } = srcCellRange;\n        const dsri = dstCellRange.sri;\n        const dsci = dstCellRange.sci;\n        const deri = dstCellRange.eri;\n        const deci = dstCellRange.eci;\n        const [rn, cn] = srcCellRange.size();\n        const [drn, dcn] = dstCellRange.size();\n        // console.log(srcIndexes, dstIndexes);\n        let isAdd = true;\n        let dn = 0;\n        if (deri < sri || deci < sci) {\n            isAdd = false;\n            if (deri < sri) dn = drn;\n            else dn = dcn;\n        }\n        for (let i = sri; i <= eri; i += 1) {\n            if (this._[i]) {\n                for (let j = sci; j <= eci; j += 1) {\n                    if (this._[i].cells && this._[i].cells[j]) {\n                        for (let ii = dsri; ii <= deri; ii += rn) {\n                            for (let jj = dsci; jj <= deci; jj += cn) {\n                                const nri = ii + (i - sri);\n                                const nci = jj + (j - sci);\n                                const ncell = helper.cloneDeep(this._[i].cells[j]);\n                                // ncell.text\n                                if (autofill && ncell && ncell.text && ncell.text.length > 0) {\n                                    const {text} = ncell;\n                                    let n = (jj - dsci) + (ii - dsri) + 2;\n                                    if (!isAdd) {\n                                        n -= dn + 1;\n                                    }\n                                    if (text[0] === '=') {\n                                        ncell.text = text.replace(/[a-zA-Z]{1,3}\\d+/g, (word) => {\n                                            let [xn, yn] = [0, 0];\n                                            if (sri === dsri) {\n                                                xn = n - 1;\n                                                // if (isAdd) xn -= 1;\n                                            } else {\n                                                yn = n - 1;\n                                            }\n                                            if (/^\\d+$/.test(word)) return word;\n                                            return expr2expr(word, xn, yn);\n                                        });\n                                    } else if ((rn <= 1 && cn > 1 && (dsri > eri || deri < sri))\n                                        || (cn <= 1 && rn > 1 && (dsci > eci || deci < sci))\n                                        || (rn <= 1 && cn <= 1)) {\n                                        const result = /[\\\\.\\d]+$/.exec(text);\n                                        // console.log('result:', result);\n                                        if (result !== null) {\n                                            const index = Number(result[0]) + n - 1;\n                                            ncell.text = text.substring(0, result.index) + index;\n                                        }\n                                    }\n                                }\n                                this.setCell(nri, nci, ncell, what);\n                                cb(nri, nci, ncell);\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    cutPaste(srcCellRange, dstCellRange) {\n        const ncellmm = {};\n        this.each((ri) => {\n            this.eachCells(ri, (ci) => {\n                let nri = parseInt(ri, 10);\n                let nci = parseInt(ci, 10);\n                if (srcCellRange.includes(ri, ci)) {\n                    nri = dstCellRange.sri + (nri - srcCellRange.sri);\n                    nci = dstCellRange.sci + (nci - srcCellRange.sci);\n                }\n                ncellmm[nri] = ncellmm[nri] || {cells: {}};\n                ncellmm[nri].cells[nci] = this._[ri].cells[ci];\n            });\n        });\n        this._ = ncellmm;\n    }\n\n    // src: Array<Array<String>>\n    paste(src, dstCellRange) {\n        if (src.length <= 0) return;\n        const {sri, sci} = dstCellRange;\n        src.forEach((row, i) => {\n            const ri = sri + i;\n            row.forEach((cell, j) => {\n                const ci = sci + j;\n                this.setCellText(ri, ci, cell);\n            });\n        });\n    }\n\n    insert(sri, n = 1, pos = 'top') {\n        const ndata = {};\n        const startI = pos === 'top' ? sri : sri + 1;\n        this.each((ri, row) => {\n            let nri = parseInt(ri, 10);\n            if (nri >= startI) {\n                nri += n;\n                this.eachCells(ri, (ci, cell) => {\n                    if (cell.text && cell.text[0] === '=') {\n                        cell.text = cell.text.replace(/[a-zA-Z]{1,3}\\d+/g, word => expr2expr(word, 0, n, (x, y) => y >= sri));\n                    }\n                });\n            }\n            ndata[nri] = row;\n        });\n        this._ = ndata;\n        this.len += n;\n    }\n\n    delete(sri, eri) {\n        const n = eri - sri + 1;\n        const ndata = {};\n        this.each((ri, row) => {\n            const nri = parseInt(ri, 10);\n            if (nri < sri) {\n                ndata[nri] = row;\n            } else if (ri > eri) {\n                ndata[nri - n] = row;\n                this.eachCells(ri, (ci, cell) => {\n                    if (cell.text && cell.text[0] === '=') {\n                        cell.text = cell.text.replace(/[a-zA-Z]{1,3}\\d+/g, word => expr2expr(word, 0, -n, (x, y) => y > eri));\n                    }\n                });\n            }\n        });\n        this._ = ndata;\n        this.len -= n;\n    }\n\n    insertColumn(sci, n = 1, pos = 'left') {\n        this.each((ri, row) => {\n            const rndata = {};\n            const startI = pos === 'left' ? sci : sci + 1;\n            this.eachCells(ri, (ci, cell) => {\n                let nci = parseInt(ci, 10);\n                if (nci >= startI) {\n                    nci += n;\n                    if (cell.text && cell.text[0] === '=') {\n                        cell.text = cell.text.replace(/[a-zA-Z]{1,3}\\d+/g, word => expr2expr(word, n, 0, x => x >= sci));\n                    }\n                }\n                rndata[nci] = cell;\n            });\n            row.cells = rndata;\n        });\n    }\n\n    deleteColumn(sci, eci) {\n        const n = eci - sci + 1;\n        this.each((ri, row) => {\n            const rndata = {};\n            this.eachCells(ri, (ci, cell) => {\n                const nci = parseInt(ci, 10);\n                if (nci < sci) {\n                    rndata[nci] = cell;\n                } else if (nci > eci) {\n                    rndata[nci - n] = cell;\n                    if (cell.text && cell.text[0] === '=') {\n                        cell.text = cell.text.replace(/[a-zA-Z]{1,3}\\d+/g, word => expr2expr(word, -n, 0, x => x > eci));\n                    }\n                }\n            });\n            row.cells = rndata;\n        });\n    }\n\n    // what: all | text | format | merge\n    deleteCells(cellRange, what = 'all') {\n        cellRange.each((i, j) => {\n            this.deleteCell(i, j, what);\n        });\n    }\n\n    // what: all | text | format | merge\n    deleteCell(ri, ci, what = 'all') {\n        const row = this.get(ri);\n        if (row !== null) {\n            const cell = this.getCell(ri, ci);\n            if (cell !== null && cell.editable !== false) {\n                if (what === 'all') {\n                    delete row.cells[ci];\n                } else if (what === 'text') {\n                    if (cell.text) delete cell.text;\n                    if (cell.value) delete cell.value;\n                } else if (what === 'format') {\n                    if (cell.style !== undefined) delete cell.style;\n                    if (cell.merge) delete cell.merge;\n                } else if (what === 'merge') {\n                    if (cell.merge) delete cell.merge;\n                }\n            }\n        }\n    }\n\n    maxCell() {\n        const keys = Object.keys(this._);\n        const ri = keys[keys.length - 1];\n        const col = this._[ri];\n        if (col) {\n            const {cells} = col;\n            const ks = Object.keys(cells);\n            const ci = ks[ks.length - 1];\n            return [parseInt(ri, 10), parseInt(ci, 10)];\n        }\n        return [0, 0];\n    }\n\n    each(cb) {\n        Object.entries(this._).forEach(([ri, row]) => {\n            cb(ri, row);\n        });\n    }\n\n    eachCells(ri, cb) {\n        if (this._[ri] && this._[ri].cells) {\n            Object.entries(this._[ri].cells).forEach(([ci, cell]) => {\n                cb(ci, cell);\n            });\n        }\n    }\n\n    setData(d) {\n        if (d.len) {\n            this.len = d.len;\n            delete d.len;\n        }\n        this._ = d;\n    }\n\n    getData() {\n        const {len} = this;\n        return Object.assign({len}, this._);\n    }\n\n    splitColumn(obj, sri, eri, sci, n) {\n        this.each((ri, row) => {\n            const rndata = {};\n            this.eachCells(ri, (ci, cell) => {\n                let nci = parseInt(ci, 10);\n                if (nci > sci) {\n                    nci += n - 1;\n                    if (cell.text && cell.text[0] === '=') {\n                        cell.text = cell.text.replace(/[a-zA-Z]{1,3}\\d+/g, word => expr2expr(word, n, 0, x => x >= sci));\n                    }\n                }\n                rndata[nci] = cell;\n                if (ri >= sri && ri <= eri) {\n                    const textArr = obj[ri] || [];\n                    textArr.forEach((item, index) => {\n                        if (rndata[sci + index] === undefined) {\n                            rndata[sci + index] = {text: item};\n                        } else {\n                            rndata[sci + index].text = item;\n                        }\n                    });\n                }\n            });\n            row.cells = rndata;\n        });\n    }\n}\n\nexport default {};\nexport {\n    Rows,\n};\n","import helper from './helper';\n\nclass Cols {\n    constructor({\n        len, width, indexWidth, minWidth,\n    }) {\n        this._ = {};\n        this.len = len;\n        this.width = width;\n        this.indexWidth = indexWidth;\n        this.minWidth = minWidth;\n    }\n\n    setData(d) {\n        if (d.len) {\n            this.len = d.len;\n            delete d.len;\n        }\n        this._ = d;\n    }\n\n    getData() {\n        const {len} = this;\n        return Object.assign({len}, this._);\n    }\n\n    getWidth(i) {\n        if (this.isHide(i)) return 0;\n        const col = this._[i];\n        if (col && col.width) {\n            return col.width;\n        }\n        return this.width;\n    }\n\n    getOrNew(ci) {\n        this._[ci] = this._[ci] || {};\n        return this._[ci];\n    }\n\n    setWidth(ci, width) {\n        const col = this.getOrNew(ci);\n        col.width = width;\n    }\n\n    unhide(idx) {\n        let index = idx;\n        while (index > 0) {\n            index -= 1;\n            if (this.isHide(index)) {\n                this.setHide(index, false);\n            } else break;\n        }\n    }\n\n    isHide(ci) {\n        const col = this._[ci];\n        return col && col.hide;\n    }\n\n    setHide(ci, v) {\n        const col = this.getOrNew(ci);\n        if (v === true) col.hide = true;\n        else delete col.hide;\n    }\n\n    setStyle(ci, style) {\n        const col = this.getOrNew(ci);\n        col.style = style;\n    }\n\n    sumWidth(min, max) {\n        return helper.rangeSum(min, max, i => this.getWidth(i));\n    }\n\n    totalWidth() {\n        return this.sumWidth(0, this.len);\n    }\n}\n\nexport default {};\nexport {\n    Cols,\n};\n","/* global window */\nimport en from './en';\n\n// Defines the fallback language as English\nlet $languages = ['en'];\nconst $messages = {\n    en,\n};\n\nfunction translate(key, messages) {\n    if (messages) {\n        // Return the translation from the first language in the languages array\n        // that has a value for the provided key.\n        for (const lang of $languages) {\n            if (!messages[lang]) break;\n\n            let message = messages[lang];\n\n            // Splits the key at '.' except where escaped as '\\.'\n            const keys = key.match(/(?:\\\\.|[^.])+/g);\n\n            for (let i = 0; i < keys.length; i += 1) {\n                const property = keys[i];\n                const value = message[property];\n\n                // If value doesn't exist, try next language\n                if (!value) break;\n\n                if (i === keys.length - 1) return value;\n\n                // Move down to the next level of the messages object\n                message = value;\n            }\n        }\n    }\n\n    return undefined;\n}\n\nfunction t(key) {\n    let v = translate(key, $messages);\n    if (!v && window && window.x_spreadsheet && window.x_spreadsheet.$messages) {\n        v = translate(key, window.x_spreadsheet.$messages);\n    }\n    return v || '';\n}\n\nfunction tf(key) {\n    return () => t(key);\n}\n\n// If clearLangList is set to false, lang will be added to the front of the\n// languages array. The languages in the language array are searched in order\n// to find a translation. This allows the use of other languages as a fallback\n// if lang is missing some keys. The language array is preloaded with English.\n// To set the languages array to only include lang, set clearLangList to true.\nfunction locale(lang, message, clearLangList = false) {\n    if (clearLangList) {\n        $languages = [lang];\n    } else {\n        // Append to front of array.\n        // Translation method will use the first language in the list that has a\n        // matching key.\n        $languages.unshift(lang);\n    }\n\n    if (message) {\n        $messages[lang] = message;\n    }\n}\n\nexport default {\n    t,\n};\n\nexport {\n    locale,\n    t,\n    tf,\n};\n","export default {\n    toolbar: {\n        undo: 'Undo',\n        redo: 'Redo',\n        print: 'Print',\n        paintformat: 'Paint format',\n        clearformat: 'Clear format',\n        format: 'Format',\n        fontName: 'Font',\n        fontSize: 'Font size',\n        fontBold: 'Font bold',\n        fontItalic: 'Font italic',\n        underline: 'Underline',\n        strike: 'Strike',\n        color: 'Text color',\n        bgcolor: 'Fill color',\n        border: 'Borders',\n        merge: 'Merge cells',\n        align: 'Horizontal align',\n        valign: 'Vertical align',\n        textwrap: 'Text wrapping',\n        freeze: 'Freeze cell',\n        autofilter: 'Filter',\n        formula: 'Functions',\n        more: 'More',\n    },\n    contextmenu: {\n        copy: 'Copy',\n        cut: 'Cut',\n        paste: 'Paste',\n        pasteValue: 'Paste values only',\n        pasteFormat: 'Paste format only',\n        hide: 'Hide',\n        insertRow: 'Insert row at top',\n        insertColumn: 'Insert column at left',\n        insertRowBottom: 'Insert row at bottom',\n        insertColumnRight: 'Insert column at right',\n        deleteSheet: 'Delete',\n        deleteRow: 'Delete row',\n        deleteColumn: 'Delete column',\n        deleteCell: 'Delete cell',\n        deleteCellText: 'Delete cell text',\n        validation: 'Data validations',\n        cellprintable: 'Enable export',\n        cellnonprintable: 'Disable export',\n        celleditable: 'Enable editing',\n        cellnoneditable: 'Disable editing',\n        split: 'Split coulumn',\n    },\n    print: {\n        size: 'Paper size',\n        orientation: 'Page orientation',\n        orientations: ['Landscape', 'Portrait'],\n    },\n    format: {\n        normal: 'Normal',\n        text: 'Plain Text',\n        number: 'Number',\n        percent: 'Percent',\n        rmb: 'RMB',\n        usd: 'USD',\n        eur: 'EUR',\n        date: 'Date',\n        time: 'Time',\n        datetime: 'Date time',\n        duration: 'Duration',\n    },\n    formula: {\n        sum: 'Sum',\n        average: 'Average',\n        max: 'Max',\n        min: 'Min',\n        _if: 'IF',\n        and: 'AND',\n        or: 'OR',\n        concat: 'Concat',\n    },\n    validation: {\n        required: 'it must be required',\n        notMatch: 'it not match its validation rule',\n        between: 'it is between {} and {}',\n        notBetween: 'it is not between {} and {}',\n        notIn: 'it is not in list',\n        equal: 'it equal to {}',\n        notEqual: 'it not equal to {}',\n        lessThan: 'it less than {}',\n        lessThanEqual: 'it less than or equal to {}',\n        greaterThan: 'it greater than {}',\n        greaterThanEqual: 'it greater than or equal to {}',\n    },\n    error: {\n        pasteForMergedCell: 'Unable to do this for merged cells',\n    },\n    calendar: {\n        weeks: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],\n        months: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'],\n    },\n    button: {\n        next: 'Next',\n        cancel: 'Cancel',\n        remove: 'Remove',\n        save: 'Save',\n        ok: 'OK',\n    },\n    sort: {\n        desc: 'Sort Z -> A',\n        asc: 'Sort A -> Z',\n    },\n    filter: {\n        empty: 'empty',\n    },\n    dataValidation: {\n        mode: 'Mode',\n        range: 'Cell Range',\n        criteria: 'Criteria',\n        modeType: {\n            cell: 'Cell',\n            column: 'Colun',\n            row: 'Row',\n        },\n        type: {\n            list: 'List',\n            number: 'Number',\n            date: 'Date',\n            phone: 'Phone',\n            email: 'Email',\n        },\n        operator: {\n            be: 'between',\n            nbe: 'not betwwen',\n            lt: 'less than',\n            lte: 'less than or equal to',\n            gt: 'greater than',\n            gte: 'greater than or equal to',\n            eq: 'equal to',\n            neq: 'not equal to',\n        },\n    },\n};\n","import {t} from '../locale/locale';\nimport helper from './helper';\n\nconst rules = {\n    phone: /^[1-9]\\d{10}$/,\n    email: /w+([-+.]w+)*@w+([-.]w+)*.w+([-.]w+)*/,\n};\n\nfunction returnMessage(flag, key, ...arg) {\n    let message = '';\n    if (!flag) {\n        message = t(`validation.${key}`, ...arg);\n    }\n    return [flag, message];\n}\n\nexport default class Validator {\n    // operator: b|nb|eq|neq|lt|lte|gt|gte\n    // type: date|number|list|phone|email\n    constructor(type, required, value, operator) {\n        this.required = required;\n        this.value = value;\n        this.type = type;\n        this.operator = operator;\n        this.message = '';\n    }\n\n    parseValue(v) {\n        const {type} = this;\n        if (type === 'date') {\n            return new Date(v);\n        }\n        if (type === 'number') {\n            return Number(v);\n        }\n        return v;\n    }\n\n    equals(other) {\n        let flag = this.type === other.type\n            && this.required === other.required\n            && this.operator === other.operator;\n        if (flag) {\n            if (Array.isArray(this.value)) {\n                flag = helper.arrayEquals(this.value, other.value);\n            } else {\n                flag = this.value === other.value;\n            }\n        }\n        return flag;\n    }\n\n    values() {\n        return this.value.split(',');\n    }\n\n    validate(v) {\n        const {\n            required, operator, value, type,\n        } = this;\n        if (required && /^\\s*$/.test(v)) {\n            return returnMessage(false, 'required');\n        }\n        if (/^\\s*$/.test(v)) return [true];\n        if (rules[type] && !rules[type].test(v)) {\n            return returnMessage(false, 'notMatch');\n        }\n        if (type === 'list') {\n            return returnMessage(this.values().includes(v), 'notIn');\n        }\n        if (operator) {\n            const v1 = this.parseValue(v);\n            if (operator === 'be') {\n                const [min, max] = value;\n                return returnMessage(\n                    v1 >= this.parseValue(min) && v1 <= this.parseValue(max),\n                    'between',\n                    min,\n                    max,\n                );\n            }\n            if (operator === 'nbe') {\n                const [min, max] = value;\n                return returnMessage(\n                    v1 < this.parseValue(min) || v1 > this.parseValue(max),\n                    'notBetween',\n                    min,\n                    max,\n                );\n            }\n            if (operator === 'eq') {\n                return returnMessage(\n                    v1 === this.parseValue(value),\n                    'equal',\n                    value,\n                );\n            }\n            if (operator === 'neq') {\n                return returnMessage(\n                    v1 !== this.parseValue(value),\n                    'notEqual',\n                    value,\n                );\n            }\n            if (operator === 'lt') {\n                return returnMessage(\n                    v1 < this.parseValue(value),\n                    'lessThan',\n                    value,\n                );\n            }\n            if (operator === 'lte') {\n                return returnMessage(\n                    v1 <= this.parseValue(value),\n                    'lessThanEqual',\n                    value,\n                );\n            }\n            if (operator === 'gt') {\n                return returnMessage(\n                    v1 > this.parseValue(value),\n                    'greaterThan',\n                    value,\n                );\n            }\n            if (operator === 'gte') {\n                return returnMessage(\n                    v1 >= this.parseValue(value),\n                    'greaterThanEqual',\n                    value,\n                );\n            }\n        }\n        return [true];\n    }\n}\n","import Validator from './validator';\nimport {CellRange} from './cell_range';\n\nclass Validation {\n    constructor(mode, refs, validator) {\n        this.refs = refs;\n        this.mode = mode; // cell\n        this.validator = validator;\n    }\n\n    includes(ri, ci) {\n        const {refs} = this;\n        for (let i = 0; i < refs.length; i += 1) {\n            const cr = CellRange.valueOf(refs[i]);\n            if (cr.includes(ri, ci)) return true;\n        }\n        return false;\n    }\n\n    addRef(ref) {\n        this.remove(CellRange.valueOf(ref));\n        this.refs.push(ref);\n    }\n\n    remove(cellRange) {\n        const nrefs = [];\n        this.refs.forEach((it) => {\n            const cr = CellRange.valueOf(it);\n            if (cr.intersects(cellRange)) {\n                const crs = cr.difference(cellRange);\n                crs.forEach(it1 => nrefs.push(it1.toString()));\n            } else {\n                nrefs.push(it);\n            }\n        });\n        this.refs = nrefs;\n    }\n\n    getData() {\n        const {refs, mode, validator} = this;\n        const {\n            type, required, operator, value,\n        } = validator;\n        return {\n            refs, mode, type, required, operator, value,\n        };\n    }\n\n    static valueOf({\n        refs, mode, type, required, operator, value,\n    }) {\n        return new Validation(mode, refs, new Validator(type, required, value, operator));\n    }\n}\n\nclass Validations {\n    constructor() {\n        this._ = [];\n        // ri_ci: errMessage\n        this.errors = new Map();\n    }\n\n    getError(ri, ci) {\n        return this.errors.get(`${ri}_${ci}`);\n    }\n\n    validate(ri, ci, text) {\n        const v = this.get(ri, ci);\n        const key = `${ri}_${ci}`;\n        const {errors} = this;\n        if (v !== null) {\n            const [flag, message] = v.validator.validate(text);\n            if (!flag) {\n                errors.set(key, message);\n            } else {\n                errors.delete(key);\n            }\n        } else {\n            errors.delete(key);\n        }\n        return true;\n    }\n\n    // type: date|number|phone|email|list\n    // validator: { required, value, operator }\n    add(mode, ref, {\n        type, required, value, operator,\n    }) {\n        const validator = new Validator(\n            type, required, value, operator,\n        );\n        const v = this.getByValidator(validator);\n        if (v !== null) {\n            v.addRef(ref);\n        } else {\n            this._.push(new Validation(mode, [ref], validator));\n        }\n    }\n\n    getByValidator(validator) {\n        for (let i = 0; i < this._.length; i += 1) {\n            const v = this._[i];\n            if (v.validator.equals(validator)) {\n                return v;\n            }\n        }\n        return null;\n    }\n\n    get(ri, ci) {\n        for (let i = 0; i < this._.length; i += 1) {\n            const v = this._[i];\n            if (v.includes(ri, ci)) return v;\n        }\n        return null;\n    }\n\n    remove(cellRange) {\n        this.each((it) => {\n            it.remove(cellRange);\n        });\n    }\n\n    each(cb) {\n        this._.forEach(it => cb(it));\n    }\n\n    getData() {\n        return this._.filter(it => it.refs.length > 0).map(it => it.getData());\n    }\n\n    setData(d) {\n        this._ = d.map(it => Validation.valueOf(it));\n    }\n}\n\nexport default {};\nexport {\n    Validations,\n};\n","/* global document */\n\nimport Selector from './selector';\nimport Scroll from './scroll';\nimport History from './history';\nimport Clipboard from './clipboard';\nimport AutoFilter from './auto_filter';\nimport {Merges} from './merge';\nimport helper from './helper';\nimport {Rows} from './row';\nimport {Cols} from './col';\nimport {Validations} from './validation';\nimport {CellRange} from './cell_range';\nimport {expr2xy, xy2expr} from './alphabet';\nimport {t} from '../locale/locale';\n\n// private methods\n/*\n * {\n *  name: ''\n *  freeze: [0, 0],\n *  formats: [],\n *  styles: [\n *    {\n *      bgcolor: '',\n *      align: '',\n *      valign: '',\n *      textwrap: false,\n *      strike: false,\n *      underline: false,\n *      color: '',\n *      format: 1,\n *      border: {\n *        left: [style, color],\n *        right: [style, color],\n *        top: [style, color],\n *        bottom: [style, color],\n *      },\n *      font: {\n *        name: 'Helvetica',\n *        size: 10,\n *        bold: false,\n *        italic: false,\n *      }\n *    }\n *  ],\n *  merges: [\n *    'A1:F11',\n *    ...\n *  ],\n *  rows: {\n *    1: {\n *      height: 50,\n *      style: 1,\n *      cells: {\n *        1: {\n *          style: 2,\n *          type: 'string',\n *          text: '',\n *          value: '', // cal result\n *        }\n *      }\n *    },\n *    ...\n *  },\n *  cols: {\n *    2: { width: 100, style: 1 }\n *  }\n * }\n */\nconst defaultSettings = {\n    mode: 'edit', // edit | read\n    view: {\n        height: () => document.documentElement.clientHeight,\n        width: () => document.documentElement.clientWidth,\n    },\n    showGrid: true,\n    showToolbar: true,\n    showContextmenu: true,\n    showBottomBar: true,\n    row: {\n        len: 100,\n        height: 25,\n    },\n    col: {\n        len: 26,\n        width: 100,\n        indexWidth: 60,\n        minWidth: 60,\n    },\n    style: {\n        bgcolor: '#ffffff',\n        align: 'left',\n        valign: 'middle',\n        textwrap: false,\n        strike: false,\n        underline: false,\n        color: '#0a0a0a',\n        font: {\n            name: 'Arial',\n            size: 10,\n            bold: false,\n            italic: false,\n        },\n        format: 'normal',\n    },\n};\n\nconst toolbarHeight = 41;\nconst bottombarHeight = 41;\n\n// src: cellRange\n// dst: cellRange\nfunction canPaste(src, dst, error = () => {\n}) {\n    const {merges} = this;\n    const cellRange = dst.clone();\n    const [srn, scn] = src.size();\n    const [drn, dcn] = dst.size();\n    if (srn > drn) {\n        cellRange.eri = dst.sri + srn - 1;\n    }\n    if (scn > dcn) {\n        cellRange.eci = dst.sci + scn - 1;\n    }\n    if (merges.intersects(cellRange)) {\n        error(t('error.pasteForMergedCell'));\n        return false;\n    }\n    return true;\n}\n\nfunction copyPaste(srcCellRange, dstCellRange, what, autofill = false) {\n    const {rows, merges} = this;\n    // delete dest merge\n    if (what === 'all' || what === 'format') {\n        rows.deleteCells(dstCellRange, what);\n        merges.deleteWithin(dstCellRange);\n    }\n    rows.copyPaste(srcCellRange, dstCellRange, what, autofill, (ri, ci, cell) => {\n        if (cell && cell.merge) {\n            // console.log('cell:', ri, ci, cell);\n            const [rn, cn] = cell.merge;\n            if (rn <= 0 && cn <= 0) return;\n            merges.add(new CellRange(ri, ci, ri + rn, ci + cn));\n        }\n    });\n}\n\nfunction cutPaste(srcCellRange, dstCellRange) {\n    const {clipboard, rows, merges} = this;\n    rows.cutPaste(srcCellRange, dstCellRange);\n    merges.move(srcCellRange,\n        dstCellRange.sri - srcCellRange.sri,\n        dstCellRange.sci - srcCellRange.sci);\n    clipboard.clear();\n}\n\n// bss: { top, bottom, left, right }\nfunction setStyleBorder(ri, ci, bss) {\n    const {styles, rows} = this;\n    const cell = rows.getCellOrNew(ri, ci);\n    let cstyle = {};\n    if (cell.style !== undefined) {\n        cstyle = helper.cloneDeep(styles[cell.style]);\n    }\n    cstyle = helper.merge(cstyle, {border: bss});\n    cell.style = this.addStyle(cstyle);\n}\n\nfunction setStyleBorders({mode, style, color}) {\n    const {styles, selector, rows} = this;\n    const {\n        sri, sci, eri, eci,\n    } = selector.range;\n    const multiple = !this.isSingleSelected();\n    if (!multiple) {\n        if (mode === 'inside' || mode === 'horizontal' || mode === 'vertical') {\n            return;\n        }\n    }\n    if (mode === 'outside' && !multiple) {\n        setStyleBorder.call(this, sri, sci, {\n            top: [style, color], bottom: [style, color], left: [style, color], right: [style, color],\n        });\n    } else if (mode === 'none') {\n        selector.range.each((ri, ci) => {\n            const cell = rows.getCell(ri, ci);\n            if (cell && cell.style !== undefined) {\n                const ns = helper.cloneDeep(styles[cell.style]);\n                delete ns.border;\n                // ['bottom', 'top', 'left', 'right'].forEach((prop) => {\n                //   if (ns[prop]) delete ns[prop];\n                // });\n                cell.style = this.addStyle(ns);\n            }\n        });\n    } else if (mode === 'all' || mode === 'inside' || mode === 'outside'\n        || mode === 'horizontal' || mode === 'vertical') {\n        const merges = [];\n        for (let ri = sri; ri <= eri; ri += 1) {\n            for (let ci = sci; ci <= eci; ci += 1) {\n                // jump merges -- start\n                const mergeIndexes = [];\n                for (let ii = 0; ii < merges.length; ii += 1) {\n                    const [mri, mci, rn, cn] = merges[ii];\n                    if (ri === mri + rn + 1) mergeIndexes.push(ii);\n                    if (mri <= ri && ri <= mri + rn) {\n                        if (ci === mci) {\n                            ci += cn + 1;\n                            break;\n                        }\n                    }\n                }\n                mergeIndexes.forEach(it => merges.splice(it, 1));\n                if (ci > eci) break;\n                // jump merges -- end\n                const cell = rows.getCell(ri, ci);\n                let [rn, cn] = [0, 0];\n                if (cell && cell.merge) {\n                    [rn, cn] = cell.merge;\n                    merges.push([ri, ci, rn, cn]);\n                }\n                const mrl = rn > 0 && ri + rn === eri;\n                const mcl = cn > 0 && ci + cn === eci;\n                let bss = {};\n                if (mode === 'all') {\n                    bss = {\n                        bottom: [style, color],\n                        top: [style, color],\n                        left: [style, color],\n                        right: [style, color],\n                    };\n                } else if (mode === 'inside') {\n                    if (!mcl && ci < eci) bss.right = [style, color];\n                    if (!mrl && ri < eri) bss.bottom = [style, color];\n                } else if (mode === 'horizontal') {\n                    if (!mrl && ri < eri) bss.bottom = [style, color];\n                } else if (mode === 'vertical') {\n                    if (!mcl && ci < eci) bss.right = [style, color];\n                } else if (mode === 'outside' && multiple) {\n                    if (sri === ri) bss.top = [style, color];\n                    if (mrl || eri === ri) bss.bottom = [style, color];\n                    if (sci === ci) bss.left = [style, color];\n                    if (mcl || eci === ci) bss.right = [style, color];\n                }\n                if (Object.keys(bss).length > 0) {\n                    setStyleBorder.call(this, ri, ci, bss);\n                }\n                ci += cn;\n            }\n        }\n    } else if (mode === 'top' || mode === 'bottom') {\n        for (let ci = sci; ci <= eci; ci += 1) {\n            if (mode === 'top') {\n                setStyleBorder.call(this, sri, ci, {top: [style, color]});\n                ci += rows.getCellMerge(sri, ci)[1];\n            }\n            if (mode === 'bottom') {\n                setStyleBorder.call(this, eri, ci, {bottom: [style, color]});\n                ci += rows.getCellMerge(eri, ci)[1];\n            }\n        }\n    } else if (mode === 'left' || mode === 'right') {\n        for (let ri = sri; ri <= eri; ri += 1) {\n            if (mode === 'left') {\n                setStyleBorder.call(this, ri, sci, {left: [style, color]});\n                ri += rows.getCellMerge(ri, sci)[0];\n            }\n            if (mode === 'right') {\n                setStyleBorder.call(this, ri, eci, {right: [style, color]});\n                ri += rows.getCellMerge(ri, eci)[0];\n            }\n        }\n    }\n}\n\nfunction getCellRowByY(y, scrollOffsety) {\n    const {rows} = this;\n    const fsh = this.freezeTotalHeight();\n    // console.log('y:', y, ', fsh:', fsh);\n    let inits = rows.height;\n    if (fsh + rows.height < y) inits -= scrollOffsety;\n\n    // handle ri in autofilter\n    const frset = this.exceptRowSet;\n\n    let ri = 0;\n    let top = inits;\n    let {height} = rows;\n    for (; ri < rows.len; ri += 1) {\n        if (top > y) break;\n        if (!frset.has(ri)) {\n            height = rows.getHeight(ri);\n            top += height;\n        }\n    }\n    top -= height;\n    // console.log('ri:', ri, ', top:', top, ', height:', height);\n\n    if (top <= 0) {\n        return {ri: -1, top: 0, height};\n    }\n\n    return {ri: ri - 1, top, height};\n}\n\nfunction getCellColByX(x, scrollOffsetx) {\n    const {cols} = this;\n    const fsw = this.freezeTotalWidth();\n    let inits = cols.indexWidth;\n    if (fsw + cols.indexWidth < x) inits -= scrollOffsetx;\n    const [ci, left, width] = helper.rangeReduceIf(\n        0,\n        cols.len,\n        inits,\n        cols.indexWidth,\n        x,\n        i => cols.getWidth(i),\n    );\n    if (left <= 0) {\n        return {ci: -1, left: 0, width: cols.indexWidth};\n    }\n    return {ci: ci - 1, left, width};\n}\n\nexport default class DataProxy {\n    constructor(name, settings) {\n        this.settings = helper.merge(defaultSettings, settings || {});\n        // save data begin\n        this.name = name || 'sheet';\n        this.freeze = [0, 0];\n        this.styles = []; // Array<Style>\n        this.merges = new Merges(); // [CellRange, ...]\n        this.rows = new Rows(this.settings.row);\n        this.cols = new Cols(this.settings.col);\n        this.validations = new Validations();\n        this.hyperlinks = {};\n        this.comments = this.settings.comments || {};\n        // save data end\n\n        // don't save object\n        this.selector = new Selector();\n        this.scroll = new Scroll();\n        this.history = new History();\n        this.clipboard = new Clipboard();\n        this.autoFilter = new AutoFilter();\n        this.change = () => {\n        };\n        this.exceptRowSet = new Set();\n        this.sortedRowMap = new Map();\n        this.unsortedRowMap = new Map();\n    }\n\n    addValidation(mode, ref, validator) {\n        // console.log('mode:', mode, ', ref:', ref, ', validator:', validator);\n        this.changeData(() => {\n            this.validations.add(mode, ref, validator);\n        });\n    }\n\n    removeValidation() {\n        const {range} = this.selector;\n        this.changeData(() => {\n            this.validations.remove(range);\n        });\n    }\n\n    getSelectedValidator() {\n        const {ri, ci} = this.selector;\n        const v = this.validations.get(ri, ci);\n        return v ? v.validator : null;\n    }\n\n    getSelectedValidation() {\n        const {ri, ci, range} = this.selector;\n        const v = this.validations.get(ri, ci);\n        const ret = {ref: range.toString()};\n        if (v !== null) {\n            ret.mode = v.mode;\n            ret.validator = v.validator;\n        }\n        return ret;\n    }\n\n    canUndo() {\n        return this.history.canUndo();\n    }\n\n    canRedo() {\n        return this.history.canRedo();\n    }\n\n    undo() {\n        this.history.undo(this.getData(), (d) => {\n            this.setData(d);\n        });\n    }\n\n    redo() {\n        this.history.redo(this.getData(), (d) => {\n            this.setData(d);\n        });\n    }\n\n    copy() {\n        this.clipboard.copy(this.selector.range);\n    }\n\n    copyToSystemClipboard(evt) {\n        let copyText = [];\n        const {\n            sri, eri, sci, eci,\n        } = this.selector.range;\n\n        for (let ri = sri; ri <= eri; ri += 1) {\n            const row = [];\n            for (let ci = sci; ci <= eci; ci += 1) {\n                const cell = this.getCell(ri, ci);\n                row.push((cell && cell.text) || '');\n            }\n            copyText.push(row);\n        }\n\n        // Adding \\n and why not adding \\r\\n is to support online office and client MS office and WPS\n        copyText = copyText.map(row => row.join('\\t')).join('\\n');\n\n        // why used this\n        // cuz http protocol will be blocked request clipboard by browser\n        if (evt) {\n            evt.clipboardData.clearData();\n            evt.clipboardData.setData('text/plain', copyText);\n            evt.preventDefault();\n        }\n\n        // this need https protocol\n        /* global navigator */\n        if (navigator.clipboard) {\n            navigator.clipboard.writeText(copyText).then(() => {\n            }, (err) => {\n                console.log('text copy to the system clipboard error  ', copyText, err);\n            });\n        }\n    }\n\n    cut() {\n        this.clipboard.cut(this.selector.range);\n    }\n\n    // what: all | text | format\n    paste(what = 'all', error = () => {\n    }) {\n        // console.log('sIndexes:', sIndexes);\n        const {clipboard, selector} = this;\n        if (clipboard.isClear()) return false;\n        if (!canPaste.call(this, clipboard.range, selector.range, error)) return false;\n\n        this.changeData(() => {\n            if (clipboard.isCopy()) {\n                copyPaste.call(this, clipboard.range, selector.range, what);\n            } else if (clipboard.isCut()) {\n                cutPaste.call(this, clipboard.range, selector.range);\n            }\n        });\n        return true;\n    }\n\n    pasteFromSystemClipboard(resetSheet, eventTrigger) {\n        const {selector} = this;\n        navigator.clipboard.readText().then((content) => {\n            const contentToPaste = this.parseClipboardContent(content);\n            let startRow = selector.ri;\n            contentToPaste.forEach((row) => {\n                let startColumn = selector.ci;\n                row.forEach((cellContent) => {\n                    this.setCellText(startRow, startColumn, cellContent, 'input');\n                    startColumn += 1;\n                });\n                startRow += 1;\n            });\n            resetSheet();\n            eventTrigger(this.rows.getData());\n        });\n    }\n\n    parseClipboardContent(clipboardContent) {\n        const parsedData = [];\n\n        // first we need to figure out how many rows we need to paste\n        const rows = clipboardContent.split('\\n');\n\n        // for each row parse cell data\n        let i = 0;\n        rows.forEach((row) => {\n            parsedData[i] = row.split('\\t');\n            i += 1;\n        });\n        return parsedData;\n    }\n\n    pasteFromText(txt) {\n        let lines = [];\n\n        if (/\\r\\n/.test(txt)) lines = txt.split('\\r\\n').map(it => it.replace(/\"/g, '').split('\\t'));\n        else lines = txt.split('\\n').map(it => it.replace(/\"/g, '').split('\\t'));\n\n        if (lines.length) {\n            const {rows, selector} = this;\n\n            this.changeData(() => {\n                rows.paste(lines, selector.range);\n            });\n        }\n    }\n\n    autofill(cellRange, what, error = () => {\n    }) {\n        const srcRange = this.selector.range;\n        if (!canPaste.call(this, srcRange, cellRange, error)) return false;\n        this.changeData(() => {\n            copyPaste.call(this, srcRange, cellRange, what, true);\n        });\n        return true;\n    }\n\n    clearClipboard() {\n        this.clipboard.clear();\n    }\n\n    calSelectedRangeByEnd(ri, ci) {\n        const {\n            selector, rows, cols, merges,\n        } = this;\n        let {\n            sri, sci, eri, eci,\n        } = selector.range;\n        const cri = selector.ri;\n        const cci = selector.ci;\n        let [nri, nci] = [ri, ci];\n        if (ri < 0) nri = rows.len - 1;\n        if (ci < 0) nci = cols.len - 1;\n        if (nri > cri) [sri, eri] = [cri, nri];\n        else [sri, eri] = [nri, cri];\n        if (nci > cci) [sci, eci] = [cci, nci];\n        else [sci, eci] = [nci, cci];\n        selector.range = merges.union(new CellRange(\n            sri, sci, eri, eci,\n        ));\n        selector.range = merges.union(selector.range);\n        // console.log('selector.range:', selector.range);\n        return selector.range;\n    }\n\n    calSelectedRangeByStart(ri, ci) {\n        const {\n            selector, rows, cols, merges,\n        } = this;\n        let cellRange = merges.getFirstIncludes(ri, ci);\n        // console.log('cellRange:', cellRange, ri, ci, merges);\n        if (cellRange === null) {\n            cellRange = new CellRange(ri, ci, ri, ci);\n            if (ri === -1) {\n                cellRange.sri = 0;\n                cellRange.eri = rows.len - 1;\n            }\n            if (ci === -1) {\n                cellRange.sci = 0;\n                cellRange.eci = cols.len - 1;\n            }\n        }\n        selector.range = cellRange;\n        return cellRange;\n    }\n\n    setSelectedCellAttr(property, value) {\n        this.changeData(() => {\n            const {selector, styles, rows} = this;\n            if (property === 'merge') {\n                if (value) this.merge();\n                else this.unmerge();\n            } else if (property === 'border') {\n                setStyleBorders.call(this, value);\n            } else if (property === 'formula') {\n                // console.log('>>>', selector.multiple());\n                const {ri, ci, range} = selector;\n                if (selector.multiple()) {\n                    const [rn, cn] = selector.size();\n                    const {\n                        sri, sci, eri, eci,\n                    } = range;\n                    if (rn > 1) {\n                        for (let i = sci; i <= eci; i += 1) {\n                            const cell = rows.getCellOrNew(eri + 1, i);\n                            cell.text = `=${value}(${xy2expr(i, sri)}:${xy2expr(i, eri)})`;\n                        }\n                    } else if (cn > 1) {\n                        const cell = rows.getCellOrNew(ri, eci + 1);\n                        cell.text = `=${value}(${xy2expr(sci, ri)}:${xy2expr(eci, ri)})`;\n                    }\n                } else {\n                    const cell = rows.getCellOrNew(ri, ci);\n                    cell.text = `=${value}()`;\n                }\n            } else {\n                selector.range.each((ri, ci) => {\n                    const cell = rows.getCellOrNew(ri, ci);\n                    let cstyle = {};\n                    if (cell.style !== undefined) {\n                        cstyle = helper.cloneDeep(styles[cell.style]);\n                    }\n                    if (property === 'format') {\n                        cstyle.format = value;\n                        cell.style = this.addStyle(cstyle);\n                    } else if (property === 'font-bold' || property === 'font-italic'\n                        || property === 'font-name' || property === 'font-size') {\n                        const nfont = {};\n                        nfont[property.split('-')[1]] = value;\n                        cstyle.font = Object.assign(cstyle.font || {}, nfont);\n                        cell.style = this.addStyle(cstyle);\n                    } else if (property === 'strike' || property === 'textwrap'\n                        || property === 'underline'\n                        || property === 'align' || property === 'valign'\n                        || property === 'color' || property === 'bgcolor') {\n                        cstyle[property] = value;\n                        cell.style = this.addStyle(cstyle);\n                    } else {\n                        cell[property] = value;\n                    }\n                });\n            }\n        });\n    }\n\n    // state: input | finished\n    setSelectedCellText(text, state = 'input') {\n        const {autoFilter, selector, rows} = this;\n        const {ri, ci} = selector;\n        let nri = ri;\n        if (this.unsortedRowMap.has(ri)) {\n            nri = this.unsortedRowMap.get(ri);\n        }\n        const oldCell = rows.getCell(nri, ci);\n        const oldText = oldCell ? oldCell.text : '';\n        this.setCellText(nri, ci, text, state);\n        // replace filter.value\n        if (autoFilter.active()) {\n            const filter = autoFilter.getFilter(ci);\n            if (filter) {\n                const vIndex = filter.value.findIndex(v => v === oldText);\n                if (vIndex >= 0) {\n                    filter.value.splice(vIndex, 1, text);\n                }\n                // console.log('filter:', filter, oldCell);\n            }\n        }\n        // this.resetAutoFilter();\n    }\n\n    getSelectedCell() {\n        const {ri, ci} = this.selector;\n        let nri = ri;\n        if (this.unsortedRowMap.has(ri)) {\n            nri = this.unsortedRowMap.get(ri);\n        }\n        return this.rows.getCell(nri, ci);\n    }\n\n    xyInSelectedRect(x, y) {\n        const {\n            left, top, width, height,\n        } = this.getSelectedRect();\n        const x1 = x - this.cols.indexWidth;\n        const y1 = y - this.rows.height;\n        // console.log('x:', x, ',y:', y, 'left:', left, 'top:', top);\n        return x1 > left && x1 < (left + width)\n            && y1 > top && y1 < (top + height);\n    }\n\n    getSelectedRect() {\n        return this.getRect(this.selector.range);\n    }\n\n    getClipboardRect() {\n        const {clipboard} = this;\n        if (!clipboard.isClear()) {\n            return this.getRect(clipboard.range);\n        }\n        return {left: -100, top: -100};\n    }\n\n    getRect(cellRange) {\n        const {\n            scroll, rows, cols, exceptRowSet,\n        } = this;\n        const {\n            sri, sci, eri, eci,\n        } = cellRange;\n        // console.log('sri:', sri, ',sci:', sci, ', eri:', eri, ', eci:', eci);\n        // no selector\n        if (sri < 0 && sci < 0) {\n            return {\n                left: 0, l: 0, top: 0, t: 0, scroll,\n            };\n        }\n        const left = cols.sumWidth(0, sci);\n        const top = rows.sumHeight(0, sri, exceptRowSet);\n        const height = rows.sumHeight(sri, eri + 1, exceptRowSet);\n        const width = cols.sumWidth(sci, eci + 1);\n        // console.log('sri:', sri, ', sci:', sci, ', eri:', eri, ', eci:', eci);\n        let left0 = left - scroll.x;\n        let top0 = top - scroll.y;\n        const fsh = this.freezeTotalHeight();\n        const fsw = this.freezeTotalWidth();\n        if (fsw > 0 && fsw > left) {\n            left0 = left;\n        }\n        if (fsh > 0 && fsh > top) {\n            top0 = top;\n        }\n        return {\n            l: left,\n            t: top,\n            left: left0,\n            top: top0,\n            height,\n            width,\n            scroll,\n        };\n    }\n\n    getCellRectByXY(x, y) {\n        const {\n            scroll, merges, rows, cols,\n        } = this;\n        let {ri, top, height} = getCellRowByY.call(this, y, scroll.y);\n        let {ci, left, width} = getCellColByX.call(this, x, scroll.x);\n        if (ci === -1) {\n            width = cols.totalWidth();\n        }\n        if (ri === -1) {\n            height = rows.totalHeight();\n        }\n        if (ri >= 0 || ci >= 0) {\n            const merge = merges.getFirstIncludes(ri, ci);\n            if (merge) {\n                ri = merge.sri;\n                ci = merge.sci;\n                ({\n                    left, top, width, height,\n                } = this.cellRect(ri, ci));\n            }\n        }\n        return {\n            ri, ci, left, top, width, height,\n        };\n    }\n\n    isSingleSelected() {\n        const {\n            sri, sci, eri, eci,\n        } = this.selector.range;\n        const cell = this.getCell(sri, sci);\n        if (cell && cell.merge) {\n            const [rn, cn] = cell.merge;\n            if (sri + rn === eri && sci + cn === eci) return true;\n        }\n        return !this.selector.multiple();\n    }\n\n    canUnmerge() {\n        const {\n            sri, sci, eri, eci,\n        } = this.selector.range;\n        const cell = this.getCell(sri, sci);\n        if (cell && cell.merge) {\n            const [rn, cn] = cell.merge;\n            if (sri + rn === eri && sci + cn === eci) return true;\n        }\n        return false;\n    }\n\n    merge() {\n        const {selector, rows} = this;\n        if (this.isSingleSelected()) return;\n        const [rn, cn] = selector.size();\n        // console.log('merge:', rn, cn);\n        if (rn > 1 || cn > 1) {\n            const {sri, sci} = selector.range;\n            this.changeData(() => {\n                const cell = rows.getCellOrNew(sri, sci);\n                cell.merge = [rn - 1, cn - 1];\n                this.merges.add(selector.range);\n                // delete merge cells\n                this.rows.deleteCells(selector.range);\n                // console.log('cell:', cell, this.d);\n                this.rows.setCell(sri, sci, cell);\n            });\n        }\n    }\n\n    unmerge() {\n        const {selector} = this;\n        if (!this.isSingleSelected()) return;\n        const {sri, sci} = selector.range;\n        this.changeData(() => {\n            this.rows.deleteCell(sri, sci, 'merge');\n            this.merges.deleteWithin(selector.range);\n        });\n    }\n\n    canAutofilter() {\n        return !this.autoFilter.active();\n    }\n\n    autofilter() {\n        const {autoFilter, selector} = this;\n        this.changeData(() => {\n            if (autoFilter.active()) {\n                autoFilter.clear();\n                this.exceptRowSet = new Set();\n                this.sortedRowMap = new Map();\n                this.unsortedRowMap = new Map();\n            } else {\n                autoFilter.ref = selector.range.toString();\n            }\n        });\n    }\n\n    setAutoFilter(ci, order, operator, value) {\n        const {autoFilter} = this;\n        autoFilter.addFilter(ci, operator, value);\n        autoFilter.setSort(ci, order);\n        this.resetAutoFilter();\n    }\n\n    resetAutoFilter() {\n        const {autoFilter, rows} = this;\n        if (!autoFilter.active()) return;\n        const {sort} = autoFilter;\n        const {rset, fset} = autoFilter.filteredRows((r, c) => rows.getCell(r, c));\n        const fary = Array.from(fset);\n        const oldAry = Array.from(fset);\n        if (sort) {\n            fary.sort((a, b) => {\n                if (sort.order === 'asc') return a - b;\n                if (sort.order === 'desc') return b - a;\n                return 0;\n            });\n        }\n        this.exceptRowSet = rset;\n        this.sortedRowMap = new Map();\n        this.unsortedRowMap = new Map();\n        fary.forEach((it, index) => {\n            this.sortedRowMap.set(oldAry[index], it);\n            this.unsortedRowMap.set(it, oldAry[index]);\n        });\n    }\n\n    deleteCell(what = 'all') {\n        const {selector} = this;\n        this.changeData(() => {\n            this.rows.deleteCells(selector.range, what);\n            if (what === 'all' || what === 'format') {\n                this.merges.deleteWithin(selector.range);\n            }\n        });\n    }\n\n    // type: row | column\n    insert(type, n = 1) {\n        this.changeData(() => {\n            const {sri, sci} = this.selector.range;\n            const {rows, merges, cols} = this;\n            let si = sri;\n            if (type === 'row') {\n                rows.insert(sri, n);\n            } else if (type === 'column') {\n                rows.insertColumn(sci, n);\n                si = sci;\n                cols.len += n;\n            }\n            merges.shift(type, si, n, (ri, ci, rn, cn) => {\n                const cell = rows.getCell(ri, ci);\n                cell.merge[0] += rn;\n                cell.merge[1] += cn;\n            });\n        });\n    }\n\n    //  \n    insertRight(type, n = 1) {\n        this.changeData(() => {\n            const {sri, sci} = this.selector.range;\n            const {rows, merges, cols} = this;\n            let si = sri;\n            if (type === 'row') {\n                rows.insert(sri, n, 'bottom');\n            } else if (type === 'column') {\n                rows.insertColumn(sci, n, 'right');\n                si = sci;\n                cols.len += n;\n            }\n            merges.shift1(type, si, n, (ri, ci, rn, cn) => {\n                const cell = rows.getCell(ri, ci);\n                cell.merge[0] += rn;\n                cell.merge[1] += cn;\n            });\n        });\n    }\n\n    // type: row | column\n    delete(type) {\n        this.changeData(() => {\n            const {\n                rows, merges, selector, cols,\n            } = this;\n            const {range} = selector;\n            const {\n                sri, sci, eri, eci,\n            } = selector.range;\n            const [rsize, csize] = selector.range.size();\n            let si = sri;\n            let size = rsize;\n            if (type === 'row') {\n                rows.delete(sri, eri);\n            } else if (type === 'column') {\n                rows.deleteColumn(sci, eci);\n                si = range.sci;\n                size = csize;\n                cols.len -= (eci - sci + 1);\n            }\n            // console.log('type:', type, ', si:', si, ', size:', size);\n            merges.shift(type, si, -size, (ri, ci, rn, cn) => {\n                // console.log('ri:', ri, ', ci:', ci, ', rn:', rn, ', cn:', cn);\n                const cell = rows.getCell(ri, ci);\n                cell.merge[0] += rn;\n                cell.merge[1] += cn;\n                if (cell.merge[0] === 0 && cell.merge[1] === 0) {\n                    delete cell.merge;\n                }\n            });\n        });\n    }\n\n    scrollx(x, cb) {\n        const {scroll, freeze, cols} = this;\n        const [, fci] = freeze;\n        const [\n            ci, left, width,\n        ] = helper.rangeReduceIf(fci, cols.len, 0, 0, x, i => cols.getWidth(i));\n        // console.log('fci:', fci, ', ci:', ci);\n        let x1 = left;\n        if (x > 0) x1 += width;\n        if (scroll.x !== x1) {\n            scroll.ci = x > 0 ? ci : 0;\n            scroll.x = x1;\n            cb();\n        }\n    }\n\n    scrolly(y, cb) {\n        const {\n            scroll,\n            freeze,\n            rows,\n        } = this;\n        const [fri] = freeze;\n        const [\n            ri, top, height,\n        ] = helper.rangeReduceIf(fri, rows.len, 0, 0, y, i => rows.getHeight(i));\n        let y1 = top;\n        if (y > 0) y1 += height;\n        if (scroll.y !== y1) {\n            scroll.ri = y > 0 ? ri : 0;\n            scroll.y = y1;\n            cb();\n        }\n    }\n\n    cellRect(ri, ci) {\n        const {rows, cols} = this;\n        const left = cols.sumWidth(0, ci);\n        const top = rows.sumHeight(0, ri);\n        const cell = rows.getCell(ri, ci);\n        let width = cols.getWidth(ci);\n        let height = rows.getHeight(ri);\n        if (cell !== null) {\n            if (cell.merge) {\n                const [rn, cn] = cell.merge;\n                // console.log('cell.merge:', cell.merge);\n                if (rn > 0) {\n                    for (let i = 1; i <= rn; i += 1) {\n                        height += rows.getHeight(ri + i);\n                    }\n                }\n                if (cn > 0) {\n                    for (let i = 1; i <= cn; i += 1) {\n                        width += cols.getWidth(ci + i);\n                    }\n                }\n            }\n        }\n        // console.log('data:', this.d);\n        return {\n            left, top, width, height, cell,\n        };\n    }\n\n    getCell(ri, ci) {\n        return this.rows.getCell(ri, ci);\n    }\n\n    getCellTextOrDefault(ri, ci) {\n        const cell = this.getCell(ri, ci);\n        return (cell && cell.text) ? cell.text : '';\n    }\n\n    getCellStyle(ri, ci) {\n        const cell = this.getCell(ri, ci);\n        if (cell && cell.style !== undefined) {\n            return this.styles[cell.style];\n        }\n        return null;\n    }\n\n    getCellStyleOrDefault(ri, ci) {\n        const {styles, rows} = this;\n        const cell = rows.getCell(ri, ci);\n        const cellStyle = (cell && cell.style !== undefined) ? styles[cell.style] : {};\n        return helper.merge(this.defaultStyle(), cellStyle);\n    }\n\n    getSelectedCellStyle() {\n        const {ri, ci} = this.selector;\n        return this.getCellStyleOrDefault(ri, ci);\n    }\n\n    // state: input | finished\n    setCellText(ri, ci, text, state) {\n        const {rows, history, validations} = this;\n        if (state === 'finished') {\n            rows.setCellText(ri, ci, '');\n            history.add(this.getData());\n            rows.setCellText(ri, ci, text);\n        } else {\n            rows.setCellText(ri, ci, text);\n            this.change(this.getData());\n        }\n        // validator\n        validations.validate(ri, ci, text);\n    }\n\n    freezeIsActive() {\n        const [ri, ci] = this.freeze;\n        return ri > 0 || ci > 0;\n    }\n\n    setFreeze(ri, ci) {\n        this.changeData(() => {\n            this.freeze = [ri, ci];\n        });\n    }\n\n    freezeTotalWidth() {\n        return this.cols.sumWidth(0, this.freeze[1]);\n    }\n\n    freezeTotalHeight() {\n        return this.rows.sumHeight(0, this.freeze[0]);\n    }\n\n    setRowHeight(ri, height) {\n        this.changeData(() => {\n            this.rows.setHeight(ri, height);\n        });\n    }\n\n    setColWidth(ci, width) {\n        this.changeData(() => {\n            this.cols.setWidth(ci, width);\n        });\n    }\n\n    viewHeight() {\n        const {view, showToolbar, showBottomBar} = this.settings;\n        let h = view.height();\n        if (showBottomBar) {\n            h -= bottombarHeight;\n        }\n        if (showToolbar) {\n            h -= toolbarHeight;\n        }\n        return h;\n    }\n\n    viewWidth() {\n        return this.settings.view.width();\n    }\n\n    freezeViewRange() {\n        const [ri, ci] = this.freeze;\n        return new CellRange(0, 0, ri - 1, ci - 1, this.freezeTotalWidth(), this.freezeTotalHeight());\n    }\n\n    contentRange() {\n        const {rows, cols} = this;\n        const [ri, ci] = rows.maxCell();\n        const h = rows.sumHeight(0, ri + 1);\n        const w = cols.sumWidth(0, ci + 1);\n        return new CellRange(0, 0, ri, ci, w, h);\n    }\n\n    exceptRowTotalHeight(sri, eri) {\n        const {exceptRowSet, rows} = this;\n        const exceptRows = Array.from(exceptRowSet);\n        let exceptRowTH = 0;\n        exceptRows.forEach((ri) => {\n            if (ri < sri || ri > eri) {\n                const height = rows.getHeight(ri);\n                exceptRowTH += height;\n            }\n        });\n        return exceptRowTH;\n    }\n\n    viewRange() {\n        const {\n            scroll, rows, cols, freeze, exceptRowSet,\n        } = this;\n        // console.log('scroll:', scroll, ', freeze:', freeze)\n        let {ri, ci} = scroll;\n        if (ri <= 0) [ri] = freeze;\n        if (ci <= 0) [, ci] = freeze;\n\n        let [x, y] = [0, 0];\n        let [eri, eci] = [rows.len, cols.len];\n        for (let i = ri; i < rows.len; i += 1) {\n            if (!exceptRowSet.has(i)) {\n                y += rows.getHeight(i);\n                eri = i;\n            }\n            if (y > this.viewHeight()) break;\n        }\n        for (let j = ci; j < cols.len; j += 1) {\n            x += cols.getWidth(j);\n            eci = j;\n            if (x > this.viewWidth()) break;\n        }\n        // console.log(ri, ci, eri, eci, x, y);\n        return new CellRange(ri, ci, eri, eci, x, y);\n    }\n\n    eachMergesInView(viewRange, cb) {\n        this.merges.filterIntersects(viewRange)\n            .forEach(it => cb(it));\n    }\n\n    hideRowsOrCols() {\n        const {rows, cols, selector} = this;\n        const [rlen, clen] = selector.size();\n        const {\n            sri, sci, eri, eci,\n        } = selector.range;\n        if (rlen === rows.len) {\n            for (let ci = sci; ci <= eci; ci += 1) {\n                cols.setHide(ci, true);\n            }\n        } else if (clen === cols.len) {\n            for (let ri = sri; ri <= eri; ri += 1) {\n                rows.setHide(ri, true);\n            }\n        }\n    }\n\n    // type: row | col\n    // index row-index | col-index\n    unhideRowsOrCols(type, index) {\n        this[`${type}s`].unhide(index);\n    }\n\n    rowEach(min, max, cb) {\n        let y = 0;\n        const {rows} = this;\n        const frset = this.exceptRowSet;\n        const frary = [...frset];\n        let offset = 0;\n        for (let i = 0; i < frary.length; i += 1) {\n            if (frary[i] < min) {\n                offset += 1;\n            }\n        }\n        // console.log('min:', min, ', max:', max, ', scroll:', scroll);\n        for (let i = min + offset; i <= max + offset; i += 1) {\n            if (frset.has(i)) {\n                offset += 1;\n            } else {\n                const rowHeight = rows.getHeight(i);\n                if (rowHeight > 0) {\n                    cb(i, y, rowHeight);\n                    y += rowHeight;\n                    if (y > this.viewHeight()) break;\n                }\n            }\n        }\n    }\n\n    colEach(min, max, cb) {\n        let x = 0;\n        const {cols} = this;\n        for (let i = min; i <= max; i += 1) {\n            const colWidth = cols.getWidth(i);\n            if (colWidth > 0) {\n                cb(i, x, colWidth);\n                x += colWidth;\n                if (x > this.viewWidth()) break;\n            }\n        }\n    }\n\n    defaultStyle() {\n        return this.settings.style;\n    }\n\n    addStyle(nstyle) {\n        const {styles} = this;\n        // console.log('old.styles:', styles, nstyle);\n        for (let i = 0; i < styles.length; i += 1) {\n            const style = styles[i];\n            if (helper.equals(style, nstyle)) return i;\n        }\n        styles.push(nstyle);\n        return styles.length - 1;\n    }\n\n    changeData(cb) {\n        this.history.add(this.getData());\n        cb();\n        this.change(this.getData());\n    }\n\n    setData(d) {\n        Object.keys(d).forEach((property) => {\n            if (property === 'merges' || property === 'rows'\n                || property === 'cols' || property === 'validations') {\n                this[property].setData(d[property]);\n            } else if (property === 'freeze') {\n                const [x, y] = expr2xy(d[property]);\n                this.freeze = [y, x];\n            } else if (property === 'autofilter') {\n                this.autoFilter.setData(d[property]);\n            } else if (d[property] !== undefined) {\n                this[property] = d[property];\n            }\n        });\n        return this;\n    }\n\n    getData() {\n        const {\n            name, freeze, styles, merges, rows, cols, validations, autoFilter,\n        } = this;\n        return {\n            name,\n            freeze: xy2expr(freeze[1], freeze[0]),\n            styles,\n            merges: merges.getData(),\n            rows: rows.getData(),\n            cols: cols.getData(),\n            validations: validations.getData(),\n            autofilter: autoFilter.getData(),\n        };\n    }\n\n    splitColumn(obj, n) {\n        this.changeData(() => {\n            const {rows, merges, cols} = this;\n            const {sri, eri, sci} = this.selector.range;\n            rows.splitColumn(obj, sri, eri, sci, n);\n            cols.len += (n - 1);\n\n            merges.shift1('column', sci, n - 1, (ri, ci, rn, cn) => {\n                const cell = rows.getCell(ri, ci);\n                cell.merge[0] += rn;\n                cell.merge[1] += cn;\n            });\n        });\n    }\n}\n","/* global window */\nexport function bind(target, name, fn) {\n    target.addEventListener(name, fn);\n}\n\nexport function unbind(target, name, fn) {\n    target.removeEventListener(name, fn);\n}\n\nexport function unbindClickoutside(el) {\n    if (el.xclickoutside) {\n        unbind(window.document.body, 'click', el.xclickoutside);\n        delete el.xclickoutside;\n    }\n}\n\n// the left mouse button: mousedown  mouseup  click\n// the right mouse button: mousedown  contenxtmenu  mouseup\n// the right mouse button in firefox(>65.0): mousedown  contenxtmenu  mouseup  click on window\nexport function bindClickoutside(el, cb) {\n    el.xclickoutside = (evt) => {\n        // ignore double click\n        // console.log('evt:', evt);\n        if (evt.detail === 2 || el.contains(evt.target)) return;\n        if (cb) cb(el);\n        else {\n            el.hide();\n            unbindClickoutside(el);\n        }\n    };\n    bind(window.document.body, 'click', el.xclickoutside);\n}\n\nexport function mouseMoveUp(target, movefunc, upfunc) {\n    bind(target, 'mousemove', movefunc);\n    const t = target;\n    t.xEvtUp = (evt) => {\n        // console.log('mouseup>>>');\n        unbind(target, 'mousemove', movefunc);\n        unbind(target, 'mouseup', target.xEvtUp);\n        upfunc(evt);\n    };\n    bind(target, 'mouseup', target.xEvtUp);\n}\n\nfunction calTouchDirection(spanx, spany, evt, cb) {\n    let direction = '';\n    // console.log('spanx:', spanx, ', spany:', spany);\n    if (Math.abs(spanx) > Math.abs(spany)) {\n        // horizontal\n        direction = spanx > 0 ? 'right' : 'left';\n        cb(direction, spanx, evt);\n    } else {\n        // vertical\n        direction = spany > 0 ? 'down' : 'up';\n        cb(direction, spany, evt);\n    }\n}\n\n// cb = (direction, distance) => {}\nexport function bindTouch(target, {move, end}) {\n    let startx = 0;\n    let starty = 0;\n    bind(target, 'touchstart', (evt) => {\n        const {pageX, pageY} = evt.touches[0];\n        startx = pageX;\n        starty = pageY;\n    });\n    bind(target, 'touchmove', (evt) => {\n        if (!move) return;\n        const {pageX, pageY} = evt.changedTouches[0];\n        const spanx = pageX - startx;\n        const spany = pageY - starty;\n        if (Math.abs(spanx) > 10 || Math.abs(spany) > 10) {\n            // console.log('spanx:', spanx, ', spany:', spany);\n            calTouchDirection(spanx, spany, evt, move);\n            startx = pageX;\n            starty = pageY;\n        }\n        evt.preventDefault();\n    });\n    bind(target, 'touchend', (evt) => {\n        if (!end) return;\n        const {pageX, pageY} = evt.changedTouches[0];\n        const spanx = pageX - startx;\n        const spany = pageY - starty;\n        calTouchDirection(spanx, spany, evt, end);\n    });\n}\n\n// eventemiter\nexport function createEventEmitter() {\n    const listeners = new Map();\n\n    function on(eventName, callback) {\n        const push = () => {\n            const currentListener = listeners.get(eventName);\n            return (Array.isArray(currentListener)\n                    && currentListener.push(callback))\n                || false;\n        };\n\n        const create = () => listeners.set(eventName, [].concat(callback));\n\n        return (listeners.has(eventName)\n                && push())\n            || create();\n    }\n\n    function fire(eventName, args) {\n        const exec = () => {\n            const currentListener = listeners.get(eventName);\n            for (const callback of currentListener) callback.call(null, ...args);\n        };\n\n        return listeners.has(eventName)\n            && exec();\n    }\n\n    function removeListener(eventName, callback) {\n        const remove = () => {\n            const currentListener = listeners.get(eventName);\n            const idx = currentListener.indexOf(callback);\n            return (idx >= 0)\n                && currentListener.splice(idx, 1)\n                && listeners.get(eventName).length === 0\n                && listeners.delete(eventName);\n        };\n\n        return listeners.has(eventName)\n            && remove();\n    }\n\n    function once(eventName, callback) {\n        const execCalllback = (...args) => {\n            callback.call(null, ...args);\n            removeListener(eventName, execCalllback);\n        };\n\n        return on(eventName, execCalllback);\n    }\n\n    function removeAllListeners() {\n        listeners.clear();\n    }\n\n    return {\n        get current() {\n            return listeners;\n        },\n        on,\n        once,\n        fire,\n        removeListener,\n        removeAllListeners,\n    };\n}\n","/* global window */\r\nexport const cssPrefix = 'x-spreadsheet';\r\nexport const dpr = window.devicePixelRatio || 1;\r\nexport default {\r\n  cssPrefix,\r\n  dpr,\r\n};\r\n","/* global window */\r\nimport { h } from './element';\r\nimport { mouseMoveUp } from './event';\r\nimport { cssPrefix } from '../config';\r\n\r\nexport default class Resizer {\r\n  constructor(vertical = false, minDistance) {\r\n    this.moving = false;\r\n    this.vertical = vertical;\r\n    this.el = h('div', `${cssPrefix}-resizer ${vertical ? 'vertical' : 'horizontal'}`).children(\r\n      this.unhideHoverEl = h('div', `${cssPrefix}-resizer-hover`)\r\n        .on('dblclick.stop', evt => this.mousedblclickHandler(evt))\r\n        .css('position', 'absolute').hide(),\r\n      this.hoverEl = h('div', `${cssPrefix}-resizer-hover`)\r\n        .on('mousedown.stop', evt => this.mousedownHandler(evt)),\r\n      this.lineEl = h('div', `${cssPrefix}-resizer-line`).hide(),\r\n    ).hide();\r\n    // cell rect\r\n    this.cRect = null;\r\n    this.finishedFn = null;\r\n    this.minDistance = minDistance;\r\n    this.unhideFn = () => {};\r\n  }\r\n\r\n  showUnhide(index) {\r\n    this.unhideIndex = index;\r\n    this.unhideHoverEl.show();\r\n  }\r\n\r\n  hideUnhide() {\r\n    this.unhideHoverEl.hide();\r\n  }\r\n\r\n  // rect : {top, left, width, height}\r\n  // line : {width, height}\r\n  show(rect, line) {\r\n    const {\r\n      moving, vertical, hoverEl, lineEl, el,\r\n      unhideHoverEl,\r\n    } = this;\r\n    if (moving) return;\r\n    this.cRect = rect;\r\n    const {\r\n      left, top, width, height,\r\n    } = rect;\r\n    el.offset({\r\n      left: vertical ? left + width - 5 : left,\r\n      top: vertical ? top : top + height - 5,\r\n    }).show();\r\n    hoverEl.offset({\r\n      width: vertical ? 5 : width,\r\n      height: vertical ? height : 5,\r\n    });\r\n    lineEl.offset({\r\n      width: vertical ? 0 : line.width,\r\n      height: vertical ? line.height : 0,\r\n    });\r\n    unhideHoverEl.offset({\r\n      left: vertical ? 5 - width : left,\r\n      top: vertical ? top : 5 - height,\r\n      width: vertical ? 5 : width,\r\n      height: vertical ? height : 5,\r\n    });\r\n  }\r\n\r\n  hide() {\r\n    this.el.offset({\r\n      left: 0,\r\n      top: 0,\r\n    }).hide();\r\n    this.hideUnhide();\r\n  }\r\n\r\n  mousedblclickHandler() {\r\n    if (this.unhideIndex) this.unhideFn(this.unhideIndex);\r\n  }\r\n\r\n  mousedownHandler(evt) {\r\n    let startEvt = evt;\r\n    const {\r\n      el, lineEl, cRect, vertical, minDistance,\r\n    } = this;\r\n    let distance = vertical ? cRect.width : cRect.height;\r\n    // console.log('distance:', distance);\r\n    lineEl.show();\r\n    mouseMoveUp(window, (e) => {\r\n      this.moving = true;\r\n      if (startEvt !== null && e.buttons === 1) {\r\n        // console.log('top:', top, ', left:', top, ', cRect:', cRect);\r\n        if (vertical) {\r\n          distance += e.movementX;\r\n          if (distance > minDistance) {\r\n            el.css('left', `${cRect.left + distance}px`);\r\n          }\r\n        } else {\r\n          distance += e.movementY;\r\n          if (distance > minDistance) {\r\n            el.css('top', `${cRect.top + distance}px`);\r\n          }\r\n        }\r\n        startEvt = e;\r\n      }\r\n    }, () => {\r\n      startEvt = null;\r\n      lineEl.hide();\r\n      this.moving = false;\r\n      this.hide();\r\n      if (this.finishedFn) {\r\n        if (distance < minDistance) distance = minDistance;\r\n        this.finishedFn(cRect, distance);\r\n      }\r\n    });\r\n  }\r\n}\r\n","import { h } from './element';\r\nimport { cssPrefix } from '../config';\r\n\r\nexport default class Scrollbar {\r\n  constructor(vertical) {\r\n    this.vertical = vertical;\r\n    this.moveFn = null;\r\n    this.el = h('div', `${cssPrefix}-scrollbar ${vertical ? 'vertical' : 'horizontal'}`)\r\n      .child(this.contentEl = h('div', ''))\r\n      .on('mousemove.stop', () => {})\r\n      .on('scroll.stop', (evt) => {\r\n        const { scrollTop, scrollLeft } = evt.target;\r\n        if (this.moveFn) {\r\n          this.moveFn(this.vertical ? scrollTop : scrollLeft, evt);\r\n        }\r\n        // console.log('evt:::', evt);\r\n      });\r\n  }\r\n\r\n  move(v) {\r\n    this.el.scroll(v);\r\n    return this;\r\n  }\r\n\r\n  scroll() {\r\n    return this.el.scroll();\r\n  }\r\n\r\n  set(distance, contentDistance) {\r\n    const d = distance - 1;\r\n    // console.log('distance:', distance, ', contentDistance:', contentDistance);\r\n    if (contentDistance > d) {\r\n      const cssKey = this.vertical ? 'height' : 'width';\r\n      // console.log('d:', d);\r\n      this.el.css(cssKey, `${d - 15}px`).show();\r\n      this.contentEl\r\n        .css(this.vertical ? 'width' : 'height', '1px')\r\n        .css(cssKey, `${contentDistance}px`);\r\n    } else {\r\n      this.el.hide();\r\n    }\r\n    return this;\r\n  }\r\n}\r\n","import { h } from './element';\r\nimport { cssPrefix } from '../config';\r\nimport { CellRange } from '../core/cell_range';\r\n\r\nconst selectorHeightBorderWidth = 2 * 2 - 1;\r\nlet startZIndex = 10;\r\n\r\nclass SelectorElement {\r\n  constructor(useHideInput = false, autoFocus = true) {\r\n    this.useHideInput = useHideInput;\r\n    this.autoFocus = autoFocus;\r\n    this.inputChange = () => {};\r\n    this.cornerEl = h('div', `${cssPrefix}-selector-corner`);\r\n    this.areaEl = h('div', `${cssPrefix}-selector-area`)\r\n      .child(this.cornerEl).hide();\r\n    this.clipboardEl = h('div', `${cssPrefix}-selector-clipboard`).hide();\r\n    this.autofillEl = h('div', `${cssPrefix}-selector-autofill`).hide();\r\n    this.el = h('div', `${cssPrefix}-selector`)\r\n      .css('z-index', `${startZIndex}`)\r\n      .children(this.areaEl, this.clipboardEl, this.autofillEl)\r\n      .hide();\r\n    if (useHideInput) {\r\n      this.hideInput = h('input', '')\r\n        .on('compositionend', (evt) => {\r\n          this.inputChange(evt.target.value);\r\n        });\r\n      this.el.child(this.hideInputDiv = h('div', 'hide-input').child(this.hideInput));\r\n      this.el.child(this.hideInputDiv = h('div', 'hide-input').child(this.hideInput));\r\n    }\r\n    startZIndex += 1;\r\n  }\r\n\r\n  setOffset(v) {\r\n    this.el.offset(v).show();\r\n    return this;\r\n  }\r\n\r\n  hide() {\r\n    this.el.hide();\r\n    return this;\r\n  }\r\n\r\n  setAreaOffset(v) {\r\n    const {\r\n      left, top, width, height,\r\n    } = v;\r\n    const of = {\r\n      width: width - selectorHeightBorderWidth + 0.8,\r\n      height: height - selectorHeightBorderWidth + 0.8,\r\n      left: left - 0.8,\r\n      top: top - 0.8,\r\n    };\r\n    this.areaEl.offset(of).show();\r\n    if (this.useHideInput) {\r\n      this.hideInputDiv.offset(of);\r\n      if (this.autoFocus) {\r\n        this.hideInput.val('').focus();\r\n      } else {\r\n        this.hideInput.val('');\r\n      }\r\n    }\r\n  }\r\n\r\n  setClipboardOffset(v) {\r\n    const {\r\n      left, top, width, height,\r\n    } = v;\r\n    this.clipboardEl.offset({\r\n      left,\r\n      top,\r\n      width: width - 5,\r\n      height: height - 5,\r\n    });\r\n  }\r\n\r\n  showAutofill(v) {\r\n    const {\r\n      left, top, width, height,\r\n    } = v;\r\n    this.autofillEl.offset({\r\n      width: width - selectorHeightBorderWidth,\r\n      height: height - selectorHeightBorderWidth,\r\n      left,\r\n      top,\r\n    }).show();\r\n  }\r\n\r\n  hideAutofill() {\r\n    this.autofillEl.hide();\r\n  }\r\n\r\n  showClipboard() {\r\n    this.clipboardEl.show();\r\n  }\r\n\r\n  hideClipboard() {\r\n    this.clipboardEl.hide();\r\n  }\r\n}\r\n\r\nfunction calBRAreaOffset(offset) {\r\n  const { data } = this;\r\n  const {\r\n    left, top, width, height, scroll, l, t,\r\n  } = offset;\r\n  const ftwidth = data.freezeTotalWidth();\r\n  const ftheight = data.freezeTotalHeight();\r\n  let left0 = left - ftwidth;\r\n  if (ftwidth > l) left0 -= scroll.x;\r\n  let top0 = top - ftheight;\r\n  if (ftheight > t) top0 -= scroll.y;\r\n  return {\r\n    left: left0,\r\n    top: top0,\r\n    width,\r\n    height,\r\n  };\r\n}\r\n\r\nfunction calTAreaOffset(offset) {\r\n  const { data } = this;\r\n  const {\r\n    left, width, height, l, t, scroll,\r\n  } = offset;\r\n  const ftwidth = data.freezeTotalWidth();\r\n  let left0 = left - ftwidth;\r\n  if (ftwidth > l) left0 -= scroll.x;\r\n  return {\r\n    left: left0, top: t, width, height,\r\n  };\r\n}\r\n\r\nfunction calLAreaOffset(offset) {\r\n  const { data } = this;\r\n  const {\r\n    top, width, height, l, t, scroll,\r\n  } = offset;\r\n  const ftheight = data.freezeTotalHeight();\r\n  let top0 = top - ftheight;\r\n  // console.log('ftheight:', ftheight, ', t:', t);\r\n  if (ftheight > t) top0 -= scroll.y;\r\n  return {\r\n    left: l, top: top0, width, height,\r\n  };\r\n}\r\n\r\nfunction setBRAreaOffset(offset) {\r\n  const { br } = this;\r\n  br.setAreaOffset(calBRAreaOffset.call(this, offset));\r\n}\r\n\r\nfunction setTLAreaOffset(offset) {\r\n  const { tl } = this;\r\n  tl.setAreaOffset(offset);\r\n}\r\n\r\nfunction setTAreaOffset(offset) {\r\n  const { t } = this;\r\n  t.setAreaOffset(calTAreaOffset.call(this, offset));\r\n}\r\n\r\nfunction setLAreaOffset(offset) {\r\n  const { l } = this;\r\n  l.setAreaOffset(calLAreaOffset.call(this, offset));\r\n}\r\n\r\nfunction setLClipboardOffset(offset) {\r\n  const { l } = this;\r\n  l.setClipboardOffset(calLAreaOffset.call(this, offset));\r\n}\r\n\r\nfunction setBRClipboardOffset(offset) {\r\n  const { br } = this;\r\n  br.setClipboardOffset(calBRAreaOffset.call(this, offset));\r\n}\r\n\r\nfunction setTLClipboardOffset(offset) {\r\n  const { tl } = this;\r\n  tl.setClipboardOffset(offset);\r\n}\r\n\r\nfunction setTClipboardOffset(offset) {\r\n  const { t } = this;\r\n  t.setClipboardOffset(calTAreaOffset.call(this, offset));\r\n}\r\n\r\nfunction setAllAreaOffset(offset) {\r\n  setBRAreaOffset.call(this, offset);\r\n  setTLAreaOffset.call(this, offset);\r\n  setTAreaOffset.call(this, offset);\r\n  setLAreaOffset.call(this, offset);\r\n}\r\n\r\nfunction setAllClipboardOffset(offset) {\r\n  setBRClipboardOffset.call(this, offset);\r\n  setTLClipboardOffset.call(this, offset);\r\n  setTClipboardOffset.call(this, offset);\r\n  setLClipboardOffset.call(this, offset);\r\n}\r\n\r\nexport default class Selector {\r\n  constructor(data) {\r\n    const { autoFocus } = data.settings;\r\n    this.inputChange = () => {};\r\n    this.data = data;\r\n    this.br = new SelectorElement(true, autoFocus);\r\n    this.t = new SelectorElement();\r\n    this.l = new SelectorElement();\r\n    this.tl = new SelectorElement();\r\n    this.br.inputChange = (v) => {\r\n      this.inputChange(v);\r\n    };\r\n    this.br.el.show();\r\n    this.offset = null;\r\n    this.areaOffset = null;\r\n    this.indexes = null;\r\n    this.range = null;\r\n    this.arange = null;\r\n    this.el = h('div', `${cssPrefix}-selectors`)\r\n      .children(\r\n        this.tl.el,\r\n        this.t.el,\r\n        this.l.el,\r\n        this.br.el,\r\n      ).hide();\r\n\r\n    // for performance\r\n    this.lastri = -1;\r\n    this.lastci = -1;\r\n    //  zIndex \r\n    // x-spreadsheet-editor20\r\n    startZIndex = 10;\r\n    startZIndex += 1;\r\n  }\r\n\r\n  resetData(data) {\r\n    this.data = data;\r\n    this.range = data.selector.range;\r\n    this.resetAreaOffset();\r\n  }\r\n\r\n  hide() {\r\n    this.el.hide();\r\n  }\r\n\r\n  resetOffset() {\r\n    const {\r\n      data, tl, t, l, br,\r\n    } = this;\r\n    const freezeHeight = data.freezeTotalHeight();\r\n    const freezeWidth = data.freezeTotalWidth();\r\n    if (freezeHeight > 0 || freezeWidth > 0) {\r\n      tl.setOffset({ width: freezeWidth, height: freezeHeight });\r\n      t.setOffset({ left: freezeWidth, height: freezeHeight });\r\n      l.setOffset({ top: freezeHeight, width: freezeWidth });\r\n      br.setOffset({ left: freezeWidth, top: freezeHeight });\r\n    } else {\r\n      tl.hide();\r\n      t.hide();\r\n      l.hide();\r\n      br.setOffset({ left: 0, top: 0 });\r\n    }\r\n  }\r\n\r\n  resetAreaOffset() {\r\n    // console.log('offset:', offset);\r\n    const offset = this.data.getSelectedRect();\r\n    const coffset = this.data.getClipboardRect();\r\n    setAllAreaOffset.call(this, offset);\r\n    setAllClipboardOffset.call(this, coffset);\r\n    this.resetOffset();\r\n  }\r\n\r\n  resetBRTAreaOffset() {\r\n    const offset = this.data.getSelectedRect();\r\n    const coffset = this.data.getClipboardRect();\r\n    setBRAreaOffset.call(this, offset);\r\n    setTAreaOffset.call(this, offset);\r\n    setBRClipboardOffset.call(this, coffset);\r\n    setTClipboardOffset.call(this, coffset);\r\n    this.resetOffset();\r\n  }\r\n\r\n  resetBRLAreaOffset() {\r\n    const offset = this.data.getSelectedRect();\r\n    const coffset = this.data.getClipboardRect();\r\n    setBRAreaOffset.call(this, offset);\r\n    setLAreaOffset.call(this, offset);\r\n    setBRClipboardOffset.call(this, coffset);\r\n    setLClipboardOffset.call(this, coffset);\r\n    this.resetOffset();\r\n  }\r\n\r\n  set(ri, ci, indexesUpdated = true) {\r\n    const { data } = this;\r\n    const cellRange = data.calSelectedRangeByStart(ri, ci);\r\n    const { sri, sci } = cellRange;\r\n    if (indexesUpdated) {\r\n      let [cri, cci] = [ri, ci];\r\n      if (ri < 0) cri = 0;\r\n      if (ci < 0) cci = 0;\r\n      data.selector.setIndexes(cri, cci);\r\n      this.indexes = [cri, cci];\r\n    }\r\n\r\n    this.moveIndexes = [sri, sci];\r\n    // this.sIndexes = sIndexes;\r\n    // this.eIndexes = eIndexes;\r\n    this.range = cellRange;\r\n    this.resetAreaOffset();\r\n    this.el.show();\r\n  }\r\n\r\n  setEnd(ri, ci, moving = true) {\r\n    const { data, lastri, lastci } = this;\r\n    if (moving) {\r\n      if (ri === lastri && ci === lastci) return;\r\n      this.lastri = ri;\r\n      this.lastci = ci;\r\n    }\r\n    this.range = data.calSelectedRangeByEnd(ri, ci);\r\n    setAllAreaOffset.call(this, this.data.getSelectedRect());\r\n  }\r\n\r\n  reset() {\r\n    // console.log('::::', this.data);\r\n    const { eri, eci } = this.data.selector.range;\r\n    this.setEnd(eri, eci);\r\n  }\r\n\r\n  showAutofill(ri, ci) {\r\n    if (ri === -1 && ci === -1) return;\r\n    // console.log('ri:', ri, ', ci:', ci);\r\n    // const [sri, sci] = this.sIndexes;\r\n    // const [eri, eci] = this.eIndexes;\r\n    const {\r\n      sri, sci, eri, eci,\r\n    } = this.range;\r\n    const [nri, nci] = [ri, ci];\r\n    // const rn = eri - sri;\r\n    // const cn = eci - sci;\r\n    const srn = sri - ri;\r\n    const scn = sci - ci;\r\n    const ern = eri - ri;\r\n    const ecn = eci - ci;\r\n    if (scn > 0) {\r\n      // left\r\n      // console.log('left');\r\n      this.arange = new CellRange(sri, nci, eri, sci - 1);\r\n      // this.saIndexes = [sri, nci];\r\n      // this.eaIndexes = [eri, sci - 1];\r\n      // data.calRangeIndexes2(\r\n    } else if (srn > 0) {\r\n      // top\r\n      // console.log('top');\r\n      // nri = sri;\r\n      this.arange = new CellRange(nri, sci, sri - 1, eci);\r\n      // this.saIndexes = [nri, sci];\r\n      // this.eaIndexes = [sri - 1, eci];\r\n    } else if (ecn < 0) {\r\n      // right\r\n      // console.log('right');\r\n      // nci = eci;\r\n      this.arange = new CellRange(sri, eci + 1, eri, nci);\r\n      // this.saIndexes = [sri, eci + 1];\r\n      // this.eaIndexes = [eri, nci];\r\n    } else if (ern < 0) {\r\n      // bottom\r\n      // console.log('bottom');\r\n      // nri = eri;\r\n      this.arange = new CellRange(eri + 1, sci, nri, eci);\r\n      // this.saIndexes = [eri + 1, sci];\r\n      // this.eaIndexes = [nri, eci];\r\n    } else {\r\n      // console.log('else:');\r\n      this.arange = null;\r\n      // this.saIndexes = null;\r\n      // this.eaIndexes = null;\r\n      return;\r\n    }\r\n    if (this.arange !== null) {\r\n      // console.log(this.saIndexes, ':', this.eaIndexes);\r\n      const offset = this.data.getRect(this.arange);\r\n      offset.width += 2;\r\n      offset.height += 2;\r\n      const {\r\n        br, l, t, tl,\r\n      } = this;\r\n      br.showAutofill(calBRAreaOffset.call(this, offset));\r\n      l.showAutofill(calLAreaOffset.call(this, offset));\r\n      t.showAutofill(calTAreaOffset.call(this, offset));\r\n      tl.showAutofill(offset);\r\n    }\r\n  }\r\n\r\n  hideAutofill() {\r\n    ['br', 'l', 't', 'tl'].forEach((property) => {\r\n      this[property].hideAutofill();\r\n    });\r\n  }\r\n\r\n  showClipboard() {\r\n    const coffset = this.data.getClipboardRect();\r\n    setAllClipboardOffset.call(this, coffset);\r\n    ['br', 'l', 't', 'tl'].forEach((property) => {\r\n      this[property].showClipboard();\r\n    });\r\n  }\r\n\r\n  hideClipboard() {\r\n    ['br', 'l', 't', 'tl'].forEach((property) => {\r\n      this[property].hideClipboard();\r\n    });\r\n  }\r\n}\r\n","import { h } from './element';\r\nimport { bindClickoutside, unbindClickoutside } from './event';\r\nimport { cssPrefix } from '../config';\r\n\r\nfunction inputMovePrev(evt) {\r\n  evt.preventDefault();\r\n  evt.stopPropagation();\r\n  const { filterItems } = this;\r\n  if (filterItems.length <= 0) return;\r\n  if (this.itemIndex >= 0) filterItems[this.itemIndex].toggle();\r\n  this.itemIndex -= 1;\r\n  if (this.itemIndex < 0) {\r\n    this.itemIndex = filterItems.length - 1;\r\n  }\r\n  filterItems[this.itemIndex].toggle();\r\n}\r\n\r\nfunction inputMoveNext(evt) {\r\n  evt.stopPropagation();\r\n  const { filterItems } = this;\r\n  if (filterItems.length <= 0) return;\r\n  if (this.itemIndex >= 0) filterItems[this.itemIndex].toggle();\r\n  this.itemIndex += 1;\r\n  if (this.itemIndex > filterItems.length - 1) {\r\n    this.itemIndex = 0;\r\n  }\r\n  filterItems[this.itemIndex].toggle();\r\n}\r\n\r\nfunction inputEnter(evt) {\r\n  evt.preventDefault();\r\n  const { filterItems } = this;\r\n  if (filterItems.length <= 0) return;\r\n  evt.stopPropagation();\r\n  if (this.itemIndex < 0) this.itemIndex = 0;\r\n  filterItems[this.itemIndex].el.click();\r\n  this.hide();\r\n}\r\n\r\nfunction inputKeydownHandler(evt) {\r\n  const { keyCode } = evt;\r\n  if (evt.ctrlKey) {\r\n    evt.stopPropagation();\r\n  }\r\n  switch (keyCode) {\r\n    case 37: // left\r\n      evt.stopPropagation();\r\n      break;\r\n    case 38: // up\r\n      inputMovePrev.call(this, evt);\r\n      break;\r\n    case 39: // right\r\n      evt.stopPropagation();\r\n      break;\r\n    case 40: // down\r\n      inputMoveNext.call(this, evt);\r\n      break;\r\n    case 13: // enter\r\n      inputEnter.call(this, evt);\r\n      break;\r\n    case 9:\r\n      inputEnter.call(this, evt);\r\n      break;\r\n    default:\r\n      evt.stopPropagation();\r\n      break;\r\n  }\r\n}\r\n\r\nexport default class Suggest {\r\n  constructor(items, itemClick, width = '200px') {\r\n    this.filterItems = [];\r\n    this.items = items;\r\n    this.el = h('div', `${cssPrefix}-suggest`).css('width', width).hide();\r\n    this.itemClick = itemClick;\r\n    this.itemIndex = -1;\r\n  }\r\n\r\n  setOffset(v) {\r\n    this.el.cssRemoveKeys('top', 'bottom')\r\n      .offset(v);\r\n  }\r\n\r\n  hide() {\r\n    const { el } = this;\r\n    this.filterItems = [];\r\n    this.itemIndex = -1;\r\n    el.hide();\r\n    unbindClickoutside(this.el.parent());\r\n  }\r\n\r\n  setItems(items) {\r\n    this.items = items;\r\n    // this.search('');\r\n  }\r\n\r\n  search(word) {\r\n    let { items } = this;\r\n    if (!/^\\s*$/.test(word)) {\r\n      items = items.filter(it => (it.key || it).startsWith(word.toUpperCase()));\r\n    }\r\n    items = items.map((it) => {\r\n      let { title } = it;\r\n      if (title) {\r\n        if (typeof title === 'function') {\r\n          title = title();\r\n        }\r\n      } else {\r\n        title = it;\r\n      }\r\n      const item = h('div', `${cssPrefix}-item`)\r\n        .child(title)\r\n        .on('click.stop', () => {\r\n          this.itemClick(it);\r\n          this.hide();\r\n        });\r\n      if (it.label) {\r\n        item.child(h('div', 'label').html(it.label));\r\n      }\r\n      return item;\r\n    });\r\n    this.filterItems = items;\r\n    if (items.length <= 0) {\r\n      return;\r\n    }\r\n    const { el } = this;\r\n    // items[0].toggle();\r\n    el.html('').children(...items).show();\r\n    bindClickoutside(el.parent(), () => { this.hide(); });\r\n  }\r\n\r\n  bindInputEvents(input) {\r\n    input.on('keydown', evt => inputKeydownHandler.call(this, evt));\r\n  }\r\n}\r\n","import {Element, h} from './element';\nimport {cssPrefix} from '../config';\n\nexport default class Icon extends Element {\n    constructor(name) {\n        super('div', `${cssPrefix}-icon`);\n        this.iconNameEl = h('div', `${cssPrefix}-icon-img ${name}`);\n        this.child(this.iconNameEl);\n    }\n\n    setName(name) {\n        this.iconNameEl.className(`${cssPrefix}-icon-img ${name}`);\n    }\n}\n","import { h } from './element';\r\nimport Icon from './icon';\r\nimport { t } from '../locale/locale';\r\n\r\nfunction addMonth(date, step) {\r\n  date.setMonth(date.getMonth() + step);\r\n}\r\n\r\nfunction weekday(date, index) {\r\n  const d = new Date(date);\r\n  d.setDate(index - date.getDay() + 1);\r\n  return d;\r\n}\r\n\r\nfunction monthDays(year, month, cdate) {\r\n  // the first day of month\r\n  const startDate = new Date(year, month, 1, 23, 59, 59);\r\n  const datess = [[], [], [], [], [], []];\r\n  for (let i = 0; i < 6; i += 1) {\r\n    for (let j = 0; j < 7; j += 1) {\r\n      const index = i * 7 + j;\r\n      const d = weekday(startDate, index);\r\n      const disabled = d.getMonth() !== month;\r\n      // console.log('d:', d, ', cdate:', cdate);\r\n      const active = d.getMonth() === cdate.getMonth() && d.getDate() === cdate.getDate();\r\n      datess[i][j] = { d, disabled, active };\r\n    }\r\n  }\r\n  return datess;\r\n}\r\n\r\nexport default class Calendar {\r\n  constructor(value) {\r\n    this.value = value;\r\n    this.cvalue = new Date(value);\r\n\r\n    this.headerLeftEl = h('div', 'calendar-header-left');\r\n    this.bodyEl = h('tbody', '');\r\n    this.buildAll();\r\n    this.el = h('div', 'x-spreadsheet-calendar')\r\n      .children(\r\n        h('div', 'calendar-header').children(\r\n          this.headerLeftEl,\r\n          h('div', 'calendar-header-right').children(\r\n            h('a', 'calendar-prev')\r\n              .on('click.stop', () => this.prev())\r\n              .child(new Icon('chevron-left')),\r\n            h('a', 'calendar-next')\r\n              .on('click.stop', () => this.next())\r\n              .child(new Icon('chevron-right')),\r\n          ),\r\n        ),\r\n        h('table', 'calendar-body').children(\r\n          h('thead', '').child(\r\n            h('tr', '').children(\r\n              ...t('calendar.weeks').map(week => h('th', 'cell').child(week)),\r\n            ),\r\n          ),\r\n          this.bodyEl,\r\n        ),\r\n      );\r\n    this.selectChange = () => {};\r\n  }\r\n\r\n  setValue(value) {\r\n    this.value = value;\r\n    this.cvalue = new Date(value);\r\n    this.buildAll();\r\n  }\r\n\r\n  prev() {\r\n    const { value } = this;\r\n    addMonth(value, -1);\r\n    this.buildAll();\r\n  }\r\n\r\n  next() {\r\n    const { value } = this;\r\n    addMonth(value, 1);\r\n    this.buildAll();\r\n  }\r\n\r\n  buildAll() {\r\n    this.buildHeaderLeft();\r\n    this.buildBody();\r\n  }\r\n\r\n  buildHeaderLeft() {\r\n    const { value } = this;\r\n    this.headerLeftEl.html(`${t('calendar.months')[value.getMonth()]} ${value.getFullYear()}`);\r\n  }\r\n\r\n  buildBody() {\r\n    const { value, cvalue, bodyEl } = this;\r\n    const mDays = monthDays(value.getFullYear(), value.getMonth(), cvalue);\r\n    const trs = mDays.map((it) => {\r\n      const tds = it.map((it1) => {\r\n        let cls = 'cell';\r\n        if (it1.disabled) cls += ' disabled';\r\n        if (it1.active) cls += ' active';\r\n        return h('td', '').child(\r\n          h('div', cls)\r\n            .on('click.stop', () => {\r\n              this.selectChange(it1.d);\r\n            })\r\n            .child(it1.d.getDate().toString()),\r\n        );\r\n      });\r\n      return h('tr', '').children(...tds);\r\n    });\r\n    bodyEl.html('').children(...trs);\r\n  }\r\n}\r\n","import Calendar from './calendar';\r\nimport { h } from './element';\r\nimport { cssPrefix } from '../config';\r\n\r\nexport default class Datepicker {\r\n  constructor() {\r\n    this.calendar = new Calendar(new Date());\r\n    this.el = h('div', `${cssPrefix}-datepicker`).child(\r\n      this.calendar.el,\r\n    ).hide();\r\n  }\r\n\r\n  setValue(date) {\r\n    // console.log(':::::::', date, typeof date, date instanceof string);\r\n    const { calendar } = this;\r\n    if (typeof date === 'string') {\r\n      // console.log(/^\\d{4}-\\d{1,2}-\\d{1,2}$/.test(date));\r\n      if (/^\\d{4}-\\d{1,2}-\\d{1,2}$/.test(date)) {\r\n        calendar.setValue(new Date(date.replace(new RegExp('-', 'g'), '/')));\r\n      }\r\n    } else if (date instanceof Date) {\r\n      calendar.setValue(date);\r\n    }\r\n    return this;\r\n  }\r\n\r\n  change(cb) {\r\n    this.calendar.selectChange = (d) => {\r\n      cb(d);\r\n      this.hide();\r\n    };\r\n  }\r\n\r\n  show() {\r\n    this.el.show();\r\n  }\r\n\r\n  hide() {\r\n    this.el.hide();\r\n  }\r\n}\r\n","//* global window */\nimport {h} from './element';\nimport Suggest from './suggest';\nimport Datepicker from './datepicker';\nimport {cssPrefix} from '../config';\n\n// import { mouseMoveUp } from '../event';\n\nfunction resetTextareaSize() {\n    const {inputText} = this;\n    if (!/^\\s*$/.test(inputText)) {\n        const {\n            textlineEl, textEl, areaOffset,\n        } = this;\n        const txts = inputText.split('\\n');\n        const maxTxtSize = Math.max(...txts.map(it => it.length));\n        const tlOffset = textlineEl.offset();\n        const fontWidth = tlOffset.width / inputText.length;\n        const tlineWidth = (maxTxtSize + 1) * fontWidth + 5;\n        const maxWidth = this.viewFn().width - areaOffset.left - fontWidth;\n        let h1 = txts.length;\n        if (tlineWidth > areaOffset.width) {\n            let twidth = tlineWidth;\n            if (tlineWidth > maxWidth) {\n                twidth = maxWidth;\n                h1 += parseInt(tlineWidth / maxWidth, 10);\n                h1 += (tlineWidth % maxWidth) > 0 ? 1 : 0;\n            }\n            textEl.css('width', `${twidth}px`);\n        }\n        h1 *= this.rowHeight;\n        if (h1 > areaOffset.height) {\n            textEl.css('height', `${h1}px`);\n        }\n    }\n}\n\nfunction insertText({target}, itxt) {\n    const {value, selectionEnd} = target;\n    const ntxt = `${value.slice(0, selectionEnd)}${itxt}${value.slice(selectionEnd)}`;\n    target.value = ntxt;\n    target.setSelectionRange(selectionEnd + 1, selectionEnd + 1);\n\n    this.inputText = ntxt;\n    this.textlineEl.html(ntxt);\n    resetTextareaSize.call(this);\n}\n\nfunction keydownEventHandler(evt) {\n    const {keyCode, altKey} = evt;\n    if (keyCode !== 13 && keyCode !== 9) evt.stopPropagation();\n    if (keyCode === 13 && altKey) {\n        insertText.call(this, evt, '\\n');\n        evt.stopPropagation();\n    }\n    if (keyCode === 13 && !altKey) evt.preventDefault();\n}\n\nfunction inputEventHandler(evt) {\n    const v = evt.target.value;\n    // console.log(evt, 'v:', v);\n    const {suggest, textlineEl, validator} = this;\n    const {cell} = this;\n    if (cell !== null) {\n        if (('editable' in cell && cell.editable === true) || (cell.editable === undefined)) {\n            this.inputText = v;\n            if (validator) {\n                if (validator.type === 'list') {\n                    suggest.search(v);\n                } else {\n                    suggest.hide();\n                }\n            } else {\n                const start = v.lastIndexOf('=');\n                if (start !== -1) {\n                    suggest.search(v.substring(start + 1));\n                } else {\n                    suggest.hide();\n                }\n            }\n            textlineEl.html(v);\n            resetTextareaSize.call(this);\n            this.change('input', v);\n        } else {\n            evt.target.value = cell.text || '';\n        }\n    } else {\n        this.inputText = v;\n        if (validator) {\n            if (validator.type === 'list') {\n                suggest.search(v);\n            } else {\n                suggest.hide();\n            }\n        } else {\n            const start = v.lastIndexOf('=');\n            if (start !== -1) {\n                suggest.search(v.substring(start + 1));\n            } else {\n                suggest.hide();\n            }\n        }\n        textlineEl.html(v);\n        resetTextareaSize.call(this);\n        this.change('input', v);\n    }\n}\n\nfunction setTextareaRange(position) {\n    const {el} = this.textEl;\n    setTimeout(() => {\n        el.focus();\n        el.setSelectionRange(position, position);\n    }, 0);\n}\n\nfunction setText(text, position) {\n    const {textEl, textlineEl} = this;\n    // firefox bug\n    textEl.el.blur();\n\n    textEl.val(text);\n    textlineEl.html(text);\n    setTextareaRange.call(this, position);\n}\n\nfunction suggestItemClick(it) {\n    const {inputText, validator} = this;\n    let position = 0;\n    if (validator && validator.type === 'list') {\n        this.inputText = it;\n        position = this.inputText.length;\n    } else {\n        const start = inputText.lastIndexOf('=');\n        const sit = inputText.substring(0, start + 1);\n        let eit = inputText.substring(start + 1);\n        if (eit.indexOf(')') !== -1) {\n            eit = eit.substring(eit.indexOf(')'));\n        } else {\n            eit = '';\n        }\n        this.inputText = `${sit + it.key}(`;\n        // console.log('inputText:', this.inputText);\n        position = this.inputText.length;\n        this.inputText += `)${eit}`;\n    }\n    setText.call(this, this.inputText, position);\n}\n\nfunction resetSuggestItems() {\n    this.suggest.setItems(this.formulas);\n}\n\nfunction dateFormat(d) {\n    let month = d.getMonth() + 1;\n    let date = d.getDate();\n    if (month < 10) month = `0${month}`;\n    if (date < 10) date = `0${date}`;\n    return `${d.getFullYear()}-${month}-${date}`;\n}\n\nexport default class Editor {\n    constructor(formulas, viewFn, rowHeight) {\n        this.viewFn = viewFn;\n        this.rowHeight = rowHeight;\n        this.formulas = formulas;\n        this.suggest = new Suggest(formulas, (it) => {\n            suggestItemClick.call(this, it);\n        });\n        this.datepicker = new Datepicker();\n        this.datepicker.change((d) => {\n            // console.log('d:', d);\n            this.setText(dateFormat(d));\n            this.clear();\n        });\n        this.areaEl = h('div', `${cssPrefix}-editor-area`)\n            .children(\n                this.textEl = h('textarea', '')\n                    .on('input', evt => inputEventHandler.call(this, evt))\n                    .on('paste.stop', () => {\n                    })\n                    .on('keydown', evt => keydownEventHandler.call(this, evt)),\n                this.textlineEl = h('div', 'textline'),\n                this.suggest.el,\n                this.datepicker.el,\n            )\n            .on('mousemove.stop', () => {\n            })\n            .on('mousedown.stop', () => {\n            });\n        this.el = h('div', `${cssPrefix}-editor`)\n            .child(this.areaEl).hide();\n        this.suggest.bindInputEvents(this.textEl);\n\n        this.areaOffset = null;\n        this.freeze = {w: 0, h: 0};\n        this.cell = null;\n        this.inputText = '';\n        this.change = () => {\n        };\n    }\n\n    setFreezeLengths(width, height) {\n        this.freeze.w = width;\n        this.freeze.h = height;\n    }\n\n    clear() {\n        // const { cell } = this;\n        // const cellText = (cell && cell.text) || '';\n        if (this.inputText !== '') {\n            this.change('finished', this.inputText);\n        }\n        this.cell = null;\n        this.areaOffset = null;\n        this.inputText = '';\n        this.el.hide();\n        this.textEl.val('');\n        this.textlineEl.html('');\n        resetSuggestItems.call(this);\n        this.datepicker.hide();\n    }\n\n    setOffset(offset, suggestPosition = 'top') {\n        const {\n            textEl, areaEl, suggest, freeze, el,\n        } = this;\n        if (offset) {\n            this.areaOffset = offset;\n            const {\n                left, top, width, height, l, t,\n            } = offset;\n            // console.log('left:', left, ',top:', top, ', freeze:', freeze);\n            const elOffset = {left: 0, top: 0};\n            // top left\n            if (freeze.w > l && freeze.h > t) {\n                //\n            } else if (freeze.w < l && freeze.h < t) {\n                elOffset.left = freeze.w;\n                elOffset.top = freeze.h;\n            } else if (freeze.w > l) {\n                elOffset.top = freeze.h;\n            } else if (freeze.h > t) {\n                elOffset.left = freeze.w;\n            }\n            el.offset(elOffset);\n            areaEl.offset({left: left - elOffset.left - 0.8, top: top - elOffset.top - 0.8});\n            textEl.offset({width: width - 9 + 0.8, height: height - 3 + 0.8});\n            const sOffset = {left: 0};\n            sOffset[suggestPosition] = height;\n            suggest.setOffset(sOffset);\n            suggest.hide();\n        }\n    }\n\n    setCell(cell, validator) {\n        if (cell && cell.editable === false) return;\n\n        // console.log('::', validator);\n        const {el, datepicker, suggest} = this;\n        el.show();\n        this.cell = cell;\n        const text = (cell && cell.text) || '';\n        this.setText(text);\n\n        this.validator = validator;\n        if (validator) {\n            const {type} = validator;\n            if (type === 'date') {\n                datepicker.show();\n                if (!/^\\s*$/.test(text)) {\n                    datepicker.setValue(text);\n                }\n            }\n            if (type === 'list') {\n                suggest.setItems(validator.values());\n                suggest.search('');\n            }\n        }\n    }\n\n    setText(text) {\n        this.inputText = text;\n        // console.log('text>>:', text);\n        setText.call(this, text, text.length);\n        resetTextareaSize.call(this);\n    }\n}\n","import {Element} from './element';\nimport {cssPrefix} from '../config';\nimport {t} from '../locale/locale';\n\nexport default class Button extends Element {\n    // type: primary\n    constructor(title, type = '') {\n        super('div', `${cssPrefix}-button ${type}`);\n        this.child(t(`button.${title}`));\n    }\n}\n","/* global window */\nfunction dpr() {\n    return window.devicePixelRatio || 1;\n}\n\nfunction thinLineWidth() {\n    return dpr() - 0.5;\n}\n\nfunction npx(px) {\n    return parseInt(px * dpr(), 10);\n}\n\nfunction npxLine(px) {\n    const n = npx(px);\n    return n > 0 ? n - 0.5 : 0.5;\n}\n\nclass DrawBox {\n    constructor(x, y, w, h, padding = 0) {\n        this.x = x;\n        this.y = y;\n        this.width = w;\n        this.height = h;\n        this.padding = padding;\n        this.bgcolor = '#ffffff';\n        // border: [width, style, color]\n        this.borderTop = null;\n        this.borderRight = null;\n        this.borderBottom = null;\n        this.borderLeft = null;\n    }\n\n    setBorders({\n        top, bottom, left, right,\n    }) {\n        if (top) this.borderTop = top;\n        if (right) this.borderRight = right;\n        if (bottom) this.borderBottom = bottom;\n        if (left) this.borderLeft = left;\n    }\n\n    innerWidth() {\n        return this.width - (this.padding * 2) - 2;\n    }\n\n    innerHeight() {\n        return this.height - (this.padding * 2) - 2;\n    }\n\n    textx(align) {\n        const {width, padding} = this;\n        let {x} = this;\n        if (align === 'left') {\n            x += padding;\n        } else if (align === 'center') {\n            x += width / 2;\n        } else if (align === 'right') {\n            x += width - padding;\n        }\n        return x;\n    }\n\n    texty(align, h) {\n        const {height, padding} = this;\n        let {y} = this;\n        if (align === 'top') {\n            y += padding;\n        } else if (align === 'middle') {\n            y += height / 2 - h / 2;\n        } else if (align === 'bottom') {\n            y += height - padding - h;\n        }\n        return y;\n    }\n\n    topxys() {\n        const {x, y, width} = this;\n        return [[x, y], [x + width, y]];\n    }\n\n    rightxys() {\n        const {\n            x, y, width, height,\n        } = this;\n        return [[x + width, y], [x + width, y + height]];\n    }\n\n    bottomxys() {\n        const {\n            x, y, width, height,\n        } = this;\n        return [[x, y + height], [x + width, y + height]];\n    }\n\n    leftxys() {\n        const {\n            x, y, height,\n        } = this;\n        return [[x, y], [x, y + height]];\n    }\n}\n\nfunction drawFontLine(type, tx, ty, align, valign, blheight, blwidth) {\n    const floffset = {x: 0, y: 0};\n    if (type === 'underline') {\n        if (valign === 'bottom') {\n            floffset.y = 0;\n        } else if (valign === 'top') {\n            floffset.y = -(blheight + 2);\n        } else {\n            floffset.y = -blheight / 2;\n        }\n    } else if (type === 'strike') {\n        if (valign === 'bottom') {\n            floffset.y = blheight / 2;\n        } else if (valign === 'top') {\n            floffset.y = -((blheight / 2) + 2);\n        }\n    }\n\n    if (align === 'center') {\n        floffset.x = blwidth / 2;\n    } else if (align === 'right') {\n        floffset.x = blwidth;\n    }\n    this.line(\n        [tx - floffset.x, ty - floffset.y],\n        [tx - floffset.x + blwidth, ty - floffset.y],\n    );\n}\n\nclass Draw {\n    constructor(el, width, height) {\n        this.el = el;\n        this.ctx = el.getContext('2d');\n        this.resize(width, height);\n        this.ctx.scale(dpr(), dpr());\n    }\n\n    resize(width, height) {\n        // console.log('dpr:', dpr);\n        this.el.style.width = `${width}px`;\n        this.el.style.height = `${height}px`;\n        this.el.width = npx(width);\n        this.el.height = npx(height);\n    }\n\n    clear() {\n        const {width, height} = this.el;\n        this.ctx.clearRect(0, 0, width, height);\n        return this;\n    }\n\n    attr(options) {\n        Object.assign(this.ctx, options);\n        return this;\n    }\n\n    save() {\n        this.ctx.save();\n        this.ctx.beginPath();\n        return this;\n    }\n\n    restore() {\n        this.ctx.restore();\n        return this;\n    }\n\n    beginPath() {\n        this.ctx.beginPath();\n        return this;\n    }\n\n    translate(x, y) {\n        this.ctx.translate(npx(x), npx(y));\n        return this;\n    }\n\n    scale(x, y) {\n        this.ctx.scale(x, y);\n        return this;\n    }\n\n    clearRect(x, y, w, h) {\n        this.ctx.clearRect(x, y, w, h);\n        return this;\n    }\n\n    fillRect(x, y, w, h) {\n        this.ctx.fillRect(npx(x) - 0.5, npx(y) - 0.5, npx(w), npx(h));\n        return this;\n    }\n\n    fillText(text, x, y) {\n        this.ctx.fillText(text, npx(x), npx(y));\n        return this;\n    }\n\n    /*\n      txt: render text\n      box: DrawBox\n      attr: {\n        align: left | center | right\n        valign: top | middle | bottom\n        color: '#333333',\n        strike: false,\n        font: {\n          name: 'Arial',\n          size: 14,\n          bold: false,\n          italic: false,\n        }\n      }\n      textWrap: text wrapping\n    */\n    text(mtxt, box, attr = {}, textWrap = true) {\n        const {ctx} = this;\n        const {\n            align, valign, font, color, strike, underline,\n        } = attr;\n        const tx = box.textx(align);\n        ctx.save();\n        ctx.beginPath();\n        this.attr({\n            textAlign: align,\n            textBaseline: valign,\n            font: `${font.italic ? 'italic' : ''} ${font.bold ? 'bold' : ''} ${npx(font.size)}px ${font.name}`,\n            fillStyle: color,\n            strokeStyle: color,\n        });\n        const txts = `${mtxt}`.split('\\n');\n        const biw = box.innerWidth();\n        const ntxts = [];\n        txts.forEach((it) => {\n            const txtWidth = ctx.measureText(it).width;\n            if (textWrap && txtWidth > npx(biw)) {\n                let textLine = {w: 0, len: 0, start: 0};\n                for (let i = 0; i < it.length; i += 1) {\n                    if (textLine.w >= npx(biw)) {\n                        ntxts.push(it.substr(textLine.start, textLine.len));\n                        textLine = {w: 0, len: 0, start: i};\n                    }\n                    textLine.len += 1;\n                    textLine.w += ctx.measureText(it[i]).width + 1;\n                }\n                if (textLine.len > 0) {\n                    ntxts.push(it.substr(textLine.start, textLine.len));\n                }\n            } else {\n                ntxts.push(it);\n            }\n        });\n        const txtHeight = (ntxts.length - 1) * (font.size + 2);\n        let ty = box.texty(valign, txtHeight);\n        ntxts.forEach((txt) => {\n            const txtWidth = ctx.measureText(txt).width;\n            this.fillText(txt, tx, ty);\n            if (strike) {\n                drawFontLine.call(this, 'strike', tx, ty, align, valign, font.size, txtWidth);\n            }\n            if (underline) {\n                drawFontLine.call(this, 'underline', tx, ty, align, valign, font.size, txtWidth);\n            }\n            ty += font.size + 2;\n        });\n        ctx.restore();\n        return this;\n    }\n\n    border(style, color) {\n        const {ctx} = this;\n        ctx.lineWidth = thinLineWidth;\n        ctx.strokeStyle = color;\n        // console.log('style:', style);\n        if (style === 'medium') {\n            ctx.lineWidth = npx(2) - 0.5;\n        } else if (style === 'thick') {\n            ctx.lineWidth = npx(3);\n        } else if (style === 'dashed') {\n            ctx.setLineDash([npx(3), npx(2)]);\n        } else if (style === 'dotted') {\n            ctx.setLineDash([npx(1), npx(1)]);\n        } else if (style === 'double') {\n            ctx.setLineDash([npx(2), 0]);\n        }\n        return this;\n    }\n\n    line(...xys) {\n        const {ctx} = this;\n        if (xys.length > 1) {\n            ctx.beginPath();\n            const [x, y] = xys[0];\n            ctx.moveTo(npxLine(x), npxLine(y));\n            for (let i = 1; i < xys.length; i += 1) {\n                const [x1, y1] = xys[i];\n                ctx.lineTo(npxLine(x1), npxLine(y1));\n            }\n            ctx.stroke();\n        }\n        return this;\n    }\n\n    strokeBorders(box) {\n        const {ctx} = this;\n        ctx.save();\n        // border\n        const {\n            borderTop, borderRight, borderBottom, borderLeft,\n        } = box;\n        if (borderTop) {\n            this.border(...borderTop);\n            // console.log('box.topxys:', box.topxys());\n            this.line(...box.topxys());\n        }\n        if (borderRight) {\n            this.border(...borderRight);\n            this.line(...box.rightxys());\n        }\n        if (borderBottom) {\n            this.border(...borderBottom);\n            this.line(...box.bottomxys());\n        }\n        if (borderLeft) {\n            this.border(...borderLeft);\n            this.line(...box.leftxys());\n        }\n        ctx.restore();\n    }\n\n    dropdown(box) {\n        const {ctx} = this;\n        const {\n            x, y, width, height,\n        } = box;\n        const sx = x + width - 15;\n        const sy = y + height - 15;\n        ctx.save();\n        ctx.beginPath();\n        ctx.moveTo(npx(sx), npx(sy));\n        ctx.lineTo(npx(sx + 8), npx(sy));\n        ctx.lineTo(npx(sx + 4), npx(sy + 6));\n        ctx.closePath();\n        ctx.fillStyle = 'rgba(0, 0, 0, .45)';\n        ctx.fill();\n        ctx.restore();\n    }\n\n    error(box) {\n        const {ctx} = this;\n        const {x, y, width} = box;\n        const sx = x + width - 1;\n        ctx.save();\n        ctx.beginPath();\n        ctx.moveTo(npx(sx - 8), npx(y - 1));\n        ctx.lineTo(npx(sx), npx(y - 1));\n        ctx.lineTo(npx(sx), npx(y + 8));\n        ctx.closePath();\n        ctx.fillStyle = 'rgba(255, 0, 0, .65)';\n        ctx.fill();\n        ctx.restore();\n    }\n\n    frozen(box) {\n        const {ctx} = this;\n        const {x, y, width} = box;\n        const sx = x + width - 1;\n        ctx.save();\n        ctx.beginPath();\n        ctx.moveTo(npx(sx - 8), npx(y - 1));\n        ctx.lineTo(npx(sx), npx(y - 1));\n        ctx.lineTo(npx(sx), npx(y + 8));\n        ctx.closePath();\n        ctx.fillStyle = 'rgba(0, 255, 0, .85)';\n        ctx.fill();\n        ctx.restore();\n    }\n\n    rect(box, dtextcb) {\n        const {ctx} = this;\n        const {\n            x, y, width, height, bgcolor,\n        } = box;\n        ctx.save();\n        ctx.beginPath();\n        ctx.fillStyle = bgcolor || '#fff';\n        ctx.rect(npxLine(x + 1), npxLine(y + 1), npx(width - 2), npx(height - 2));\n        ctx.clip();\n        ctx.fill();\n        dtextcb();\n        ctx.restore();\n    }\n}\n\nexport default {};\nexport {\n    Draw,\n    DrawBox,\n    thinLineWidth,\n    npx,\n};\n","// docs\nimport './_.prototypes';\n\n/** default font list\n * @type {BaseFont[]}\n */\nconst baseFonts = [\n    {key: 'Arial', title: 'Arial'},\n    {key: 'Helvetica', title: 'Helvetica'},\n    {key: 'Source Sans Pro', title: 'Source Sans Pro'},\n    {key: 'Comic Sans MS', title: 'Comic Sans MS'},\n    {key: 'Courier New', title: 'Courier New'},\n    {key: 'Verdana', title: 'Verdana'},\n    {key: 'Lato', title: 'Lato'},\n];\n\n/** default fontSize list\n * @type {FontSize[]}\n */\nconst fontSizes = [\n    {pt: 7.5, px: 10},\n    {pt: 8, px: 11},\n    {pt: 9, px: 12},\n    {pt: 10, px: 13},\n    {pt: 10.5, px: 14},\n    {pt: 11, px: 15},\n    {pt: 12, px: 16},\n    {pt: 14, px: 18.7},\n    {pt: 15, px: 20},\n    {pt: 16, px: 21.3},\n    {pt: 18, px: 24},\n    {pt: 22, px: 29.3},\n    {pt: 24, px: 32},\n    {pt: 26, px: 34.7},\n    {pt: 36, px: 48},\n    {pt: 42, px: 56},\n    // { pt: 54, px: 71.7 },\n    // { pt: 63, px: 83.7 },\n    // { pt: 72, px: 95.6 },\n];\n\n/** map pt to px\n * @date 2019-10-10\n * @param {fontsizePT} pt\n * @returns {fontsizePX}\n */\nfunction getFontSizePxByPt(pt) {\n    for (let i = 0; i < fontSizes.length; i += 1) {\n        const fontSize = fontSizes[i];\n        if (fontSize.pt === pt) {\n            return fontSize.px;\n        }\n    }\n    return pt;\n}\n\n/** transform baseFonts to map\n * @date 2019-10-10\n * @param {BaseFont[]} [ary=[]]\n * @returns {object}\n */\nfunction fonts(ary = []) {\n    const map = {};\n    baseFonts.concat(ary).forEach((f) => {\n        map[f.key] = f;\n    });\n    return map;\n}\n\nexport default {};\nexport {\n    fontSizes,\n    fonts,\n    baseFonts,\n    getFontSizePxByPt,\n};\n","import {expr2xy, xy2expr} from './alphabet';\nimport {numberCalc} from './helper';\n\n// Converting infix expression to a suffix expression\n// src: AVERAGE(SUM(A1,A2), B1) + 50 + B20\n// return: [A1, A2], SUM[, B1],AVERAGE,50,+,B20,+\nconst infixExprToSuffixExpr = (src) => {\n    const operatorStack = [];\n    const stack = [];\n    let subStrs = []; // SUM, A1, B2, 50 ...\n    let fnArgType = 0; // 1 => , 2 => :\n    let fnArgOperator = '';\n    let fnArgsLen = 1; // A1,A2,A3...\n    let oldc = '';\n    for (let i = 0; i < src.length; i += 1) {\n        const c = src.charAt(i);\n        if (c !== ' ') {\n            if (c >= 'a' && c <= 'z') {\n                subStrs.push(c.toUpperCase());\n            } else if ((c >= '0' && c <= '9') || (c >= 'A' && c <= 'Z') || c === '.') {\n                subStrs.push(c);\n            } else if (c === '\"') {\n                i += 1;\n                while (src.charAt(i) !== '\"') {\n                    subStrs.push(src.charAt(i));\n                    i += 1;\n                }\n                stack.push(`\"${subStrs.join('')}`);\n                subStrs = [];\n            } else if (c === '-' && /[+\\-*/,(]/.test(oldc)) {\n                subStrs.push(c);\n            } else {\n                // console.log('subStrs:', subStrs.join(''), stack);\n                if (c !== '(' && subStrs.length > 0) {\n                    stack.push(subStrs.join(''));\n                }\n                if (c === ')') {\n                    let c1 = operatorStack.pop();\n                    if (fnArgType === 2) {\n                        // fn argument range => A1:B5\n                        try {\n                            const [ex, ey] = expr2xy(stack.pop());\n                            const [sx, sy] = expr2xy(stack.pop());\n                            // console.log('::', sx, sy, ex, ey);\n                            let rangelen = 0;\n                            for (let x = sx; x <= ex; x += 1) {\n                                for (let y = sy; y <= ey; y += 1) {\n                                    stack.push(xy2expr(x, y));\n                                    rangelen += 1;\n                                }\n                            }\n                            stack.push([c1, rangelen]);\n                        } catch (e) {\n                            // console.log(e);\n                        }\n                    } else if (fnArgType === 1 || fnArgType === 3) {\n                        if (fnArgType === 3) stack.push(fnArgOperator);\n                        // fn argument => A1,A2,B5\n                        stack.push([c1, fnArgsLen]);\n                        fnArgsLen = 1;\n                    } else {\n                        // console.log('c1:', c1, fnArgType, stack, operatorStack);\n                        while (c1 !== '(') {\n                            stack.push(c1);\n                            if (operatorStack.length <= 0) break;\n                            c1 = operatorStack.pop();\n                        }\n                    }\n                    fnArgType = 0;\n                } else if (c === '=' || c === '>' || c === '<') {\n                    const nc = src.charAt(i + 1);\n                    fnArgOperator = c;\n                    if (nc === '=' || nc === '-') {\n                        fnArgOperator += nc;\n                        i += 1;\n                    }\n                    fnArgType = 3;\n                } else if (c === ':') {\n                    fnArgType = 2;\n                } else if (c === ',') {\n                    if (fnArgType === 3) {\n                        stack.push(fnArgOperator);\n                    }\n                    fnArgType = 1;\n                    fnArgsLen += 1;\n                } else if (c === '(' && subStrs.length > 0) {\n                    // function\n                    operatorStack.push(subStrs.join(''));\n                } else {\n                    // priority: */ > +-\n                    // console.log('xxxx:', operatorStack, c, stack);\n                    if (operatorStack.length > 0 && (c === '+' || c === '-')) {\n                        let top = operatorStack[operatorStack.length - 1];\n                        if (top !== '(') stack.push(operatorStack.pop());\n                        if (top === '*' || top === '/') {\n                            while (operatorStack.length > 0) {\n                                top = operatorStack[operatorStack.length - 1];\n                                if (top !== '(') stack.push(operatorStack.pop());\n                                else break;\n                            }\n                        }\n                    } else if (operatorStack.length > 0) {\n                        const top = operatorStack[operatorStack.length - 1];\n                        if (top === '*' || top === '/') stack.push(operatorStack.pop());\n                    }\n                    operatorStack.push(c);\n                }\n                subStrs = [];\n            }\n            oldc = c;\n        }\n    }\n    if (subStrs.length > 0) {\n        stack.push(subStrs.join(''));\n    }\n    while (operatorStack.length > 0) {\n        stack.push(operatorStack.pop());\n    }\n    return stack;\n};\n\nconst evalSubExpr = (subExpr, cellRender) => {\n    const [fl] = subExpr;\n    let expr = subExpr;\n    if (fl === '\"') {\n        return subExpr.substring(1);\n    }\n    let ret = 1;\n    if (fl === '-') {\n        expr = subExpr.substring(1);\n        ret = -1;\n    }\n    if (expr[0] >= '0' && expr[0] <= '9') {\n        return ret * Number(expr);\n    }\n    const [x, y] = expr2xy(expr);\n    return ret * cellRender(x, y);\n};\n\n// evaluate the suffix expression\n// srcStack: <= infixExprToSufixExpr\n// formulaMap: {'SUM': {}, ...}\n// cellRender: (x, y) => {}\nconst evalSuffixExpr = (srcStack, formulaMap, cellRender, cellList) => {\n    const stack = [];\n    // console.log(':::::formulaMap:', formulaMap);\n    for (let i = 0; i < srcStack.length; i += 1) {\n        // console.log(':::>>>', srcStack[i]);\n        const expr = srcStack[i];\n        const fc = expr[0];\n        if (expr === '+') {\n            const top = stack.pop();\n            stack.push(numberCalc('+', stack.pop(), top));\n        } else if (expr === '-') {\n            if (stack.length === 1) {\n                const top = stack.pop();\n                stack.push(numberCalc('*', top, -1));\n            } else {\n                const top = stack.pop();\n                stack.push(numberCalc('-', stack.pop(), top));\n            }\n        } else if (expr === '*') {\n            stack.push(numberCalc('*', stack.pop(), stack.pop()));\n        } else if (expr === '/') {\n            const top = stack.pop();\n            stack.push(numberCalc('/', stack.pop(), top));\n        } else if (fc === '=' || fc === '>' || fc === '<') {\n            let top = stack.pop();\n            if (!Number.isNaN(top)) top = Number(top);\n            let left = stack.pop();\n            if (!Number.isNaN(left)) left = Number(left);\n            let ret = false;\n            if (fc === '=') {\n                ret = (left === top);\n            } else if (expr === '>') {\n                ret = (left > top);\n            } else if (expr === '>=') {\n                ret = (left >= top);\n            } else if (expr === '<') {\n                ret = (left < top);\n            } else if (expr === '<=') {\n                ret = (left <= top);\n            }\n            stack.push(ret);\n        } else if (Array.isArray(expr)) {\n            const [formula, len] = expr;\n            const params = [];\n            for (let j = 0; j < len; j += 1) {\n                params.push(stack.pop());\n            }\n            stack.push(formulaMap[formula].render(params.reverse()));\n        } else {\n            if (cellList.includes(expr)) {\n                return 0;\n            }\n            if ((fc >= 'a' && fc <= 'z') || (fc >= 'A' && fc <= 'Z')) {\n                cellList.push(expr);\n            }\n            stack.push(evalSubExpr(expr, cellRender));\n            cellList.pop();\n        }\n        // console.log('stack:', stack);\n    }\n    return stack[0];\n};\n\nconst cellRender = (src, formulaMap, getCellText, cellList = []) => {\n    if (src[0] === '=') {\n        const stack = infixExprToSuffixExpr(src.substring(1));\n        if (stack.length <= 0) return src;\n        return evalSuffixExpr(\n            stack,\n            formulaMap,\n            (x, y) => cellRender(getCellText(x, y), formulaMap, getCellText, cellList),\n            cellList,\n        );\n    }\n    return src;\n};\n\nexport default {\n    render: cellRender,\n};\nexport {\n    infixExprToSuffixExpr,\n};\n","/**\n formula:\n key\n title\n render\n */\n/**\n * @typedef {object} Formula\n * @property {string} key\n * @property {function} title\n * @property {function} render\n */\nimport {tf} from '../locale/locale';\nimport {numberCalc} from './helper';\n\n/** @type {Formula[]} */\nconst baseFormulas = [\n    {\n        key: 'SUM',\n        title: tf('formula.sum'),\n        render: ary => ary.reduce((a, b) => numberCalc('+', a, b), 0),\n    },\n    {\n        key: 'AVERAGE',\n        title: tf('formula.average'),\n        render: ary => ary.reduce((a, b) => Number(a) + Number(b), 0) / ary.length,\n    },\n    {\n        key: 'MAX',\n        title: tf('formula.max'),\n        render: ary => Math.max(...ary.map(v => Number(v))),\n    },\n    {\n        key: 'MIN',\n        title: tf('formula.min'),\n        render: ary => Math.min(...ary.map(v => Number(v))),\n    },\n    {\n        key: 'IF',\n        title: tf('formula._if'),\n        render: ([b, t, f]) => (b ? t : f),\n    },\n    {\n        key: 'AND',\n        title: tf('formula.and'),\n        render: ary => ary.every(it => it),\n    },\n    {\n        key: 'OR',\n        title: tf('formula.or'),\n        render: ary => ary.some(it => it),\n    },\n    {\n        key: 'CONCAT',\n        title: tf('formula.concat'),\n        render: ary => ary.join(''),\n    },\n    /* support:  1 + A1 + B2 * 3\n    {\n      key: 'DIVIDE',\n      title: tf('formula.divide'),\n      render: ary => ary.reduce((a, b) => Number(a) / Number(b)),\n    },\n    {\n      key: 'PRODUCT',\n      title: tf('formula.product'),\n      render: ary => ary.reduce((a, b) => Number(a) * Number(b),1),\n    },\n    {\n      key: 'SUBTRACT',\n      title: tf('formula.subtract'),\n      render: ary => ary.reduce((a, b) => Number(a) - Number(b)),\n    },\n    */\n];\n\nconst formulas = baseFormulas;\n\n// const formulas = (formulaAry = []) => {\n//   const formulaMap = {};\n//   baseFormulas.concat(formulaAry).forEach((f) => {\n//     formulaMap[f.key] = f;\n//   });\n//   return formulaMap;\n// };\nconst formulam = {};\nbaseFormulas.forEach((f) => {\n    formulam[f.key] = f;\n});\n\nexport default {};\n\nexport {\n    formulam,\n    formulas,\n    baseFormulas,\n};\n","import {tf} from '../locale/locale';\n\nconst formatStringRender = v => v;\n\nconst formatNumberRender = (v) => {\n    // match \"-12.1\" or \"12\" or \"12.1\"\n    if (/^(-?\\d*.?\\d*)$/.test(v)) {\n        const v1 = Number(v).toFixed(2).toString();\n        const [first, ...parts] = v1.split('\\\\.');\n        return [first.replace(/(\\d)(?=(\\d{3})+(?!\\d))/g, '$1,'), ...parts];\n    }\n    return v;\n};\n\nconst baseFormats = [\n    {\n        key: 'normal',\n        title: tf('format.normal'),\n        type: 'string',\n        render: formatStringRender,\n    },\n    {\n        key: 'text',\n        title: tf('format.text'),\n        type: 'string',\n        render: formatStringRender,\n    },\n    {\n        key: 'number',\n        title: tf('format.number'),\n        type: 'number',\n        label: '1,000.12',\n        render: formatNumberRender,\n    },\n    {\n        key: 'percent',\n        title: tf('format.percent'),\n        type: 'number',\n        label: '10.12%',\n        render: v => `${v}%`,\n    },\n    {\n        key: 'rmb',\n        title: tf('format.rmb'),\n        type: 'number',\n        label: '10.00',\n        render: v => `${formatNumberRender(v)}`,\n    },\n    {\n        key: 'usd',\n        title: tf('format.usd'),\n        type: 'number',\n        label: '$10.00',\n        render: v => `$${formatNumberRender(v)}`,\n    },\n    {\n        key: 'eur',\n        title: tf('format.eur'),\n        type: 'number',\n        label: '10.00',\n        render: v => `${formatNumberRender(v)}`,\n    },\n    {\n        key: 'date',\n        title: tf('format.date'),\n        type: 'date',\n        label: '26/09/2008',\n        render: formatStringRender,\n    },\n    {\n        key: 'time',\n        title: tf('format.time'),\n        type: 'date',\n        label: '15:59:00',\n        render: formatStringRender,\n    },\n    {\n        key: 'datetime',\n        title: tf('format.datetime'),\n        type: 'date',\n        label: '26/09/2008 15:59:00',\n        render: formatStringRender,\n    },\n    {\n        key: 'duration',\n        title: tf('format.duration'),\n        type: 'date',\n        label: '24:01:00',\n        render: formatStringRender,\n    },\n];\n\n// const formats = (ary = []) => {\n//   const map = {};\n//   baseFormats.concat(ary).forEach((f) => {\n//     map[f.key] = f;\n//   });\n//   return map;\n// };\nconst formatm = {};\nbaseFormats.forEach((f) => {\n    formatm[f.key] = f;\n});\n\nexport default {};\nexport {\n    formatm,\n    baseFormats,\n};\n","import {stringAt} from '../core/alphabet';\nimport {getFontSizePxByPt} from '../core/font';\nimport _cell from '../core/cell';\nimport {formulam} from '../core/formula';\nimport {formatm} from '../core/format';\n\nimport {\n    Draw, DrawBox, thinLineWidth, npx,\n} from '../canvas/draw';\n// gobal var\nconst cellPaddingWidth = 5;\nconst tableFixedHeaderCleanStyle = {fillStyle: '#f4f5f8'};\nconst tableGridStyle = {\n    fillStyle: '#fff',\n    lineWidth: thinLineWidth,\n    strokeStyle: '#e6e6e6',\n};\n\nfunction tableFixedHeaderStyle() {\n    return {\n        textAlign: 'center',\n        textBaseline: 'middle',\n        font: `500 ${npx(12)}px Source Sans Pro`,\n        fillStyle: '#585757',\n        lineWidth: thinLineWidth(),\n        strokeStyle: '#e6e6e6',\n    };\n}\n\nfunction getDrawBox(data, rindex, cindex, yoffset = 0) {\n    const {\n        left, top, width, height,\n    } = data.cellRect(rindex, cindex);\n    return new DrawBox(left, top + yoffset, width, height, cellPaddingWidth);\n}\n\n/*\nfunction renderCellBorders(bboxes, translateFunc) {\n  const { draw } = this;\n  if (bboxes) {\n    const rset = new Set();\n    // console.log('bboxes:', bboxes);\n    bboxes.forEach(({ ri, ci, box }) => {\n      if (!rset.has(ri)) {\n        rset.add(ri);\n        translateFunc(ri);\n      }\n      draw.strokeBorders(box);\n    });\n  }\n}\n*/\n\nexport function renderCell(draw, data, rindex, cindex, yoffset = 0) {\n    const {sortedRowMap, rows, cols} = data;\n    if (rows.isHide(rindex) || cols.isHide(cindex)) return;\n    let nrindex = rindex;\n    if (sortedRowMap.has(rindex)) {\n        nrindex = sortedRowMap.get(rindex);\n    }\n\n    const cell = data.getCell(nrindex, cindex);\n    if (cell === null) return;\n    let frozen = false;\n    if ('editable' in cell && cell.editable === false) {\n        frozen = true;\n    }\n\n    const style = data.getCellStyleOrDefault(nrindex, cindex);\n    const dbox = getDrawBox(data, rindex, cindex, yoffset);\n    dbox.bgcolor = style.bgcolor;\n    if (style.border !== undefined) {\n        dbox.setBorders(style.border);\n        // bboxes.push({ ri: rindex, ci: cindex, box: dbox });\n        draw.strokeBorders(dbox);\n    }\n    draw.rect(dbox, () => {\n        // render text\n        let cellText = '';\n        if (!data.settings.evalPaused) {\n            cellText = _cell.render(cell.text || '', formulam, (y, x) => (data.getCellTextOrDefault(x, y)));\n        } else {\n            cellText = cell.text || '';\n        }\n        if (style.format) {\n            // console.log(data.formatm, '>>', cell.format);\n            cellText = formatm[style.format].render(cellText);\n        }\n        const font = Object.assign({}, style.font);\n        font.size = getFontSizePxByPt(font.size);\n        // console.log('style:', style);\n        draw.text(cellText, dbox, {\n            align: style.align,\n            valign: style.valign,\n            font,\n            color: style.color,\n            strike: style.strike,\n            underline: style.underline,\n        }, style.textwrap);\n        // error\n        const error = data.validations.getError(rindex, cindex);\n        if (error) {\n            // console.log('error:', rindex, cindex, error);\n            draw.error(dbox);\n        }\n        if (frozen) {\n            draw.frozen(dbox);\n        }\n    });\n}\n\nfunction renderAutofilter(viewRange) {\n    const {data, draw} = this;\n    if (viewRange) {\n        const {autoFilter} = data;\n        if (!autoFilter.active()) return;\n        const afRange = autoFilter.hrange();\n        if (viewRange.intersects(afRange)) {\n            afRange.each((ri, ci) => {\n                const dbox = getDrawBox(data, ri, ci);\n                draw.dropdown(dbox);\n            });\n        }\n    }\n}\n\nfunction renderContent(viewRange, fw, fh, tx, ty) {\n    const {draw, data} = this;\n    draw.save();\n    draw.translate(fw, fh)\n        .translate(tx, ty);\n\n    const {exceptRowSet} = data;\n    // const exceptRows = Array.from(exceptRowSet);\n    const filteredTranslateFunc = (ri) => {\n        const ret = exceptRowSet.has(ri);\n        if (ret) {\n            const height = data.rows.getHeight(ri);\n            draw.translate(0, -height);\n        }\n        return !ret;\n    };\n\n    const exceptRowTotalHeight = data.exceptRowTotalHeight(viewRange.sri, viewRange.eri);\n    // 1 render cell\n    draw.save();\n    draw.translate(0, -exceptRowTotalHeight);\n    viewRange.each((ri, ci) => {\n        renderCell(draw, data, ri, ci);\n    }, ri => filteredTranslateFunc(ri));\n    draw.restore();\n\n\n    // 2 render mergeCell\n    const rset = new Set();\n    draw.save();\n    draw.translate(0, -exceptRowTotalHeight);\n    data.eachMergesInView(viewRange, ({sri, sci, eri}) => {\n        if (!exceptRowSet.has(sri)) {\n            renderCell(draw, data, sri, sci);\n        } else if (!rset.has(sri)) {\n            rset.add(sri);\n            const height = data.rows.sumHeight(sri, eri + 1);\n            draw.translate(0, -height);\n        }\n    });\n    draw.restore();\n\n    // 3 render autofilter\n    renderAutofilter.call(this, viewRange);\n\n    draw.restore();\n}\n\nfunction renderSelectedHeaderCell(x, y, w, h) {\n    const {draw} = this;\n    draw.save();\n    draw.attr({fillStyle: 'rgba(75, 137, 255, 0.08)'})\n        .fillRect(x, y, w, h);\n    draw.restore();\n}\n\n// viewRange\n// type: all | left | top\n// w: the fixed width of header\n// h: the fixed height of header\n// tx: moving distance on x-axis\n// ty: moving distance on y-axis\nfunction renderFixedHeaders(type, viewRange, w, h, tx, ty) {\n    const {draw, data} = this;\n    const sumHeight = viewRange.h; // rows.sumHeight(viewRange.sri, viewRange.eri + 1);\n    const sumWidth = viewRange.w; // cols.sumWidth(viewRange.sci, viewRange.eci + 1);\n    const nty = ty + h;\n    const ntx = tx + w;\n\n    draw.save();\n    // draw rect background\n    draw.attr(tableFixedHeaderCleanStyle);\n    if (type === 'all' || type === 'left') draw.fillRect(0, nty, w, sumHeight);\n    if (type === 'all' || type === 'top') draw.fillRect(ntx, 0, sumWidth, h);\n\n    const {\n        sri, sci, eri, eci,\n    } = data.selector.range;\n    // console.log(data.selectIndexes);\n    // draw text\n    // text font, align...\n    draw.attr(tableFixedHeaderStyle());\n    // y-header-text\n    if (type === 'all' || type === 'left') {\n        data.rowEach(viewRange.sri, viewRange.eri, (i, y1, rowHeight) => {\n            const y = nty + y1;\n            const ii = i;\n            draw.line([0, y], [w, y]);\n            if (sri <= ii && ii < eri + 1) {\n                renderSelectedHeaderCell.call(this, 0, y, w, rowHeight);\n            }\n            draw.fillText(ii + 1, w / 2, y + (rowHeight / 2));\n            if (i > 0 && data.rows.isHide(i - 1)) {\n                draw.save();\n                draw.attr({strokeStyle: '#c6c6c6'});\n                draw.line([5, y + 5], [w - 5, y + 5]);\n                draw.restore();\n            }\n        });\n        draw.line([0, sumHeight + nty], [w, sumHeight + nty]);\n        draw.line([w, nty], [w, sumHeight + nty]);\n    }\n    // x-header-text\n    if (type === 'all' || type === 'top') {\n        data.colEach(viewRange.sci, viewRange.eci, (i, x1, colWidth) => {\n            const x = ntx + x1;\n            const ii = i;\n            draw.line([x, 0], [x, h]);\n            if (sci <= ii && ii < eci + 1) {\n                renderSelectedHeaderCell.call(this, x, 0, colWidth, h);\n            }\n            draw.fillText(stringAt(ii), x + (colWidth / 2), h / 2);\n            if (i > 0 && data.cols.isHide(i - 1)) {\n                draw.save();\n                draw.attr({strokeStyle: '#c6c6c6'});\n                draw.line([x + 5, 5], [x + 5, h - 5]);\n                draw.restore();\n            }\n        });\n        draw.line([sumWidth + ntx, 0], [sumWidth + ntx, h]);\n        draw.line([0, h], [sumWidth + ntx, h]);\n    }\n    draw.restore();\n}\n\nfunction renderFixedLeftTopCell(fw, fh) {\n    const {draw} = this;\n    draw.save();\n    // left-top-cell\n    draw.attr({fillStyle: '#f4f5f8'})\n        .fillRect(0, 0, fw, fh);\n    draw.restore();\n}\n\nfunction renderContentGrid({\n    sri, sci, eri, eci, w, h,\n}, fw, fh, tx, ty) {\n    const {draw, data} = this;\n    const {settings} = data;\n\n    draw.save();\n    draw.attr(tableGridStyle)\n        .translate(fw + tx, fh + ty);\n    // const sumWidth = cols.sumWidth(sci, eci + 1);\n    // const sumHeight = rows.sumHeight(sri, eri + 1);\n    // console.log('sumWidth:', sumWidth);\n    // draw.clearRect(0, 0, w, h);\n    if (!settings.showGrid) {\n        draw.restore();\n        return;\n    }\n    // console.log('rowStart:', rowStart, ', rowLen:', rowLen);\n    data.rowEach(sri, eri, (i, y, ch) => {\n        // console.log('y:', y);\n        if (i !== sri) draw.line([0, y], [w, y]);\n        if (i === eri) draw.line([0, y + ch], [w, y + ch]);\n    });\n    data.colEach(sci, eci, (i, x, cw) => {\n        if (i !== sci) draw.line([x, 0], [x, h]);\n        if (i === eci) draw.line([x + cw, 0], [x + cw, h]);\n    });\n    draw.restore();\n}\n\nfunction renderFreezeHighlightLine(fw, fh, ftw, fth) {\n    const {draw, data} = this;\n    const twidth = data.viewWidth() - fw;\n    const theight = data.viewHeight() - fh;\n    draw.save()\n        .translate(fw, fh)\n        .attr({strokeStyle: 'rgba(75, 137, 255, .6)'});\n    draw.line([0, fth], [twidth, fth]);\n    draw.line([ftw, 0], [ftw, theight]);\n    draw.restore();\n}\n\n/** end */\nclass Table {\n    constructor(el, data) {\n        this.el = el;\n        this.draw = new Draw(el, data.viewWidth(), data.viewHeight());\n        this.data = data;\n    }\n\n    resetData(data) {\n        this.data = data;\n        this.render();\n    }\n\n    render() {\n        // resize canvas\n        const {data} = this;\n        const {rows, cols} = data;\n        // fixed width of header\n        const fw = cols.indexWidth;\n        // fixed height of header\n        const fh = rows.height;\n\n        this.draw.resize(data.viewWidth(), data.viewHeight());\n        this.clear();\n\n        const viewRange = data.viewRange();\n        // renderAll.call(this, viewRange, data.scroll);\n        const tx = data.freezeTotalWidth();\n        const ty = data.freezeTotalHeight();\n        const {x, y} = data.scroll;\n        // 1\n        renderContentGrid.call(this, viewRange, fw, fh, tx, ty);\n        renderContent.call(this, viewRange, fw, fh, -x, -y);\n        renderFixedHeaders.call(this, 'all', viewRange, fw, fh, tx, ty);\n        renderFixedLeftTopCell.call(this, fw, fh);\n        const [fri, fci] = data.freeze;\n        if (fri > 0 || fci > 0) {\n            // 2\n            if (fri > 0) {\n                const vr = viewRange.clone();\n                vr.sri = 0;\n                vr.eri = fri - 1;\n                vr.h = ty;\n                renderContentGrid.call(this, vr, fw, fh, tx, 0);\n                renderContent.call(this, vr, fw, fh, -x, 0);\n                renderFixedHeaders.call(this, 'top', vr, fw, fh, tx, 0);\n            }\n            // 3\n            if (fci > 0) {\n                const vr = viewRange.clone();\n                vr.sci = 0;\n                vr.eci = fci - 1;\n                vr.w = tx;\n                renderContentGrid.call(this, vr, fw, fh, 0, ty);\n                renderFixedHeaders.call(this, 'left', vr, fw, fh, 0, ty);\n                renderContent.call(this, vr, fw, fh, 0, -y);\n            }\n            // 4\n            const freezeViewRange = data.freezeViewRange();\n            renderContentGrid.call(this, freezeViewRange, fw, fh, 0, 0);\n            renderFixedHeaders.call(this, 'all', freezeViewRange, fw, fh, 0, 0);\n            renderContent.call(this, freezeViewRange, fw, fh, 0, 0);\n            // 5\n            renderFreezeHighlightLine.call(this, fw, fh, tx, ty);\n        }\n    }\n\n    clear() {\n        this.draw.clear();\n    }\n}\n\nexport default Table;\n","/* global window document */\nimport {h} from './element';\nimport {cssPrefix} from '../config';\nimport Button from './button';\nimport {Draw} from '../canvas/draw';\nimport {renderCell} from './table';\nimport {t} from '../locale/locale';\n\n// resolution: 72 => 595 x 842\n// 150 => 1240 x 1754\n// 200 => 1654 x 2339\n// 300 => 2479 x 3508\n// 96 * cm / 2.54 , 96 * cm / 2.54\n\nconst PAGER_SIZES = [\n    ['A3', 11.69, 16.54],\n    ['A4', 8.27, 11.69],\n    ['A5', 5.83, 8.27],\n    ['B4', 9.84, 13.90],\n    ['B5', 6.93, 9.84],\n];\n\nconst PAGER_ORIENTATIONS = ['landscape', 'portrait'];\n\nfunction inches2px(inc) {\n    return parseInt(96 * inc, 10);\n}\n\nfunction btnClick(type) {\n    if (type === 'cancel') {\n        this.el.hide();\n    } else {\n        this.toPrint();\n    }\n}\n\nfunction pagerSizeChange(evt) {\n    const {paper} = this;\n    const {value} = evt.target;\n    const ps = PAGER_SIZES[value];\n    paper.w = inches2px(ps[1]);\n    paper.h = inches2px(ps[2]);\n    // console.log('paper:', ps, paper);\n    this.preview();\n}\n\nfunction pagerOrientationChange(evt) {\n    const {paper} = this;\n    const {value} = evt.target;\n    const v = PAGER_ORIENTATIONS[value];\n    paper.orientation = v;\n    this.preview();\n}\n\nexport default class Print {\n    constructor(data) {\n        this.paper = {\n            w: inches2px(PAGER_SIZES[0][1]),\n            h: inches2px(PAGER_SIZES[0][2]),\n            padding: 50,\n            orientation: PAGER_ORIENTATIONS[0],\n            get width() {\n                return this.orientation === 'landscape' ? this.h : this.w;\n            },\n            get height() {\n                return this.orientation === 'landscape' ? this.w : this.h;\n            },\n        };\n        this.data = data;\n        this.el = h('div', `${cssPrefix}-print`)\n            .children(\n                h('div', `${cssPrefix}-print-bar`)\n                    .children(\n                        h('div', '-title').child('Print settings'),\n                        h('div', '-right').children(\n                            h('div', `${cssPrefix}-buttons`).children(\n                                new Button('cancel').on('click', btnClick.bind(this, 'cancel')),\n                                new Button('next', 'primary').on('click', btnClick.bind(this, 'next')),\n                            ),\n                        ),\n                    ),\n                h('div', `${cssPrefix}-print-content`)\n                    .children(\n                        this.contentEl = h('div', '-content'),\n                        h('div', '-sider').child(\n                            h('form', '').children(\n                                h('fieldset', '').children(\n                                    h('label', '').child(`${t('print.size')}`),\n                                    h('select', '').children(\n                                        ...PAGER_SIZES.map((it, index) => h('option', '').attr('value', index).child(`${it[0]} ( ${it[1]}''x${it[2]}'' )`)),\n                                    ).on('change', pagerSizeChange.bind(this)),\n                                ),\n                                h('fieldset', '').children(\n                                    h('label', '').child(`${t('print.orientation')}`),\n                                    h('select', '').children(\n                                        ...PAGER_ORIENTATIONS.map((it, index) => h('option', '').attr('value', index).child(`${t('print.orientations')[index]}`)),\n                                    ).on('change', pagerOrientationChange.bind(this)),\n                                ),\n                            ),\n                        ),\n                    ),\n            ).hide();\n    }\n\n    resetData(data) {\n        this.data = data;\n    }\n\n    preview() {\n        const {data, paper} = this;\n        const {width, height, padding} = paper;\n        const iwidth = width - padding * 2;\n        const iheight = height - padding * 2;\n        const cr = data.contentRange();\n        const pages = parseInt(cr.h / iheight, 10) + 1;\n        const scale = iwidth / cr.w;\n        let left = padding;\n        const top = padding;\n        if (scale > 1) {\n            left += (iwidth - cr.w) / 2;\n        }\n        let ri = 0;\n        let yoffset = 0;\n        this.contentEl.html('');\n        this.canvases = [];\n        const mViewRange = {\n            sri: 0,\n            sci: 0,\n            eri: 0,\n            eci: 0,\n        };\n        for (let i = 0; i < pages; i += 1) {\n            let th = 0;\n            let yo = 0;\n            const wrap = h('div', `${cssPrefix}-canvas-card`);\n            const canvas = h('canvas', `${cssPrefix}-canvas`);\n            this.canvases.push(canvas.el);\n            const draw = new Draw(canvas.el, width, height);\n            // cell-content\n            draw.save();\n            draw.translate(left, top);\n            if (scale < 1) draw.scale(scale, scale);\n            // console.log('ri:', ri, cr.eri, yoffset);\n            for (; ri <= cr.eri; ri += 1) {\n                const rh = data.rows.getHeight(ri);\n                th += rh;\n                if (th < iheight) {\n                    for (let ci = 0; ci <= cr.eci; ci += 1) {\n                        renderCell(draw, data, ri, ci, yoffset);\n                        mViewRange.eci = ci;\n                    }\n                } else {\n                    yo = -(th - rh);\n                    break;\n                }\n            }\n            mViewRange.eri = ri;\n            draw.restore();\n            // merge-cell\n            draw.save();\n            draw.translate(left, top);\n            if (scale < 1) draw.scale(scale, scale);\n            const yof = yoffset;\n            data.eachMergesInView(mViewRange, ({sri, sci}) => {\n                renderCell(draw, data, sri, sci, yof);\n            });\n            draw.restore();\n\n            mViewRange.sri = mViewRange.eri;\n            mViewRange.sci = mViewRange.eci;\n            yoffset += yo;\n            this.contentEl.child(h('div', `${cssPrefix}-canvas-card-wraper`).child(wrap.child(canvas)));\n        }\n        this.el.show();\n    }\n\n    toPrint() {\n        this.el.hide();\n        const {paper} = this;\n        const iframe = h('iframe', '').hide();\n        const {el} = iframe;\n        window.document.body.appendChild(el);\n        const {contentWindow} = el;\n        const idoc = contentWindow.document;\n        const style = document.createElement('style');\n        style.innerHTML = `\n      @page { size: ${paper.width}px ${paper.height}px; };\n      canvas {\n        page-break-before: auto;\n        page-break-after: always;\n        image-rendering: pixelated;\n      };\n    `;\n        idoc.head.appendChild(style);\n        this.canvases.forEach((it) => {\n            const cn = it.cloneNode(false);\n            const ctx = cn.getContext('2d');\n            // ctx.imageSmoothingEnabled = true;\n            ctx.drawImage(it, 0, 0);\n            idoc.body.appendChild(cn);\n        });\n        contentWindow.print();\n    }\n}\n","import { h } from './element';\nimport { bindClickoutside, unbindClickoutside } from './event';\nimport { cssPrefix } from '../config';\nimport { tf } from '../locale/locale';\n\nlet menuItems = [\n  { key: 'copy', title: tf('contextmenu.copy'), label: 'Ctrl+C' },\n  { key: 'cut', title: tf('contextmenu.cut'), label: 'Ctrl+X' },\n  { key: 'paste', title: tf('contextmenu.paste'), label: 'Ctrl+V' },\n  { key: 'paste-value', title: tf('contextmenu.pasteValue'), label: 'Ctrl+Shift+V' },\n  { key: 'paste-format', title: tf('contextmenu.pasteFormat'), label: 'Ctrl+Alt+V' },\n  { key: 'divider' },\n  { key: 'insert-row', title: tf('contextmenu.insertRow'), input: true },\n  { key: 'insert-row-bottom', title: tf('contextmenu.insertRowBottom'), input: true },\n  { key: 'insert-column', title: tf('contextmenu.insertColumn'), input: true },\n  { key: 'insert-column-right', title: tf('contextmenu.insertColumnRight'), input: true },\n  { key: 'divider' },\n  { key: 'delete-row', title: tf('contextmenu.deleteRow') },\n  { key: 'delete-column', title: tf('contextmenu.deleteColumn') },\n  { key: 'delete-cell-text', title: tf('contextmenu.deleteCellText') },\n  { key: 'hide', title: tf('contextmenu.hide') },\n  { key: 'divider' },\n  { key: 'validation', title: tf('contextmenu.validation') },\n  { key: 'divider' },\n  { key: 'cell-printable', title: tf('contextmenu.cellprintable') },\n  { key: 'cell-non-printable', title: tf('contextmenu.cellnonprintable') },\n  { key: 'divider' },\n  { key: 'cell-editable', title: tf('contextmenu.celleditable') },\n  { key: 'cell-non-editable', title: tf('contextmenu.cellnoneditable') },\n  { key: 'split', title: tf('contextmenu.split') },\n];\n\nfunction buildMenuItem(item) {\n  if (item.key === 'divider') {\n    return h('div', `${cssPrefix}-item divider`);\n  }\n  if (item.input) {\n    const input = h('input', `${cssPrefix}-item-input`)\n      .on('keydown', (evt) => {\n        evt.stopPropagation();\n      }).on('keyup', (evt) => {\n        evt.stopPropagation();\n        if (evt.keyCode === 13) {\n          this.itemClick(item.key, item, Number(evt.target.value));\n          this.hide();\n        }\n      });\n    input.el.setAttribute('type', 'number');\n    input.el.setAttribute('value', 1);\n    return h('div', `${cssPrefix}-item`)\n      .children(\n        item.title(),\n        input,\n      );\n  }\n  return h('div', `${cssPrefix}-item`)\n    .on('click', () => {\n      this.itemClick(item.key, item);\n      this.hide();\n    })\n    .children(\n      item.title(),\n      h('div', 'label').child(item.label || ''),\n    );\n}\n\nfunction buildMenu(menus) {\n  if (menus) {\n    menuItems = menus;\n  }\n  return menuItems.map(it => buildMenuItem.call(this, it));\n}\n\nexport default class ContextMenu {\n  constructor(viewFn, isHide = false, menus) {\n    this.menuItems = buildMenu.call(this, menus);\n    this.el = h('div', `${cssPrefix}-contextmenu`)\n      .children(...this.menuItems)\n      .hide();\n    this.viewFn = viewFn;\n    this.itemClick = () => {\n    };\n    this.isHide = isHide;\n    this.setMode('range');\n  }\n\n  // row-col: the whole rows or the whole cols\n  // range: select range\n  setMode(mode) {\n    const hideEl = this.menuItems.find(it => it.key === 'hide');\n    if (hideEl && mode === 'row-col') {\n      hideEl.show();\n    } else {\n      hideEl && hideEl.hide();\n    }\n  }\n\n  hide() {\n    const { el } = this;\n    el.hide();\n    unbindClickoutside(el);\n  }\n\n  setPosition(x, y) {\n    if (this.isHide) return;\n    const { el } = this;\n    const { width } = el.show().offset();\n    const view = this.viewFn();\n    const vhf = view.height / 2;\n    let left = x;\n    if (view.width - x <= width) {\n      left -= width;\n    }\n    el.css('left', `${left}px`);\n    if (y > vhf) {\n      el.css('bottom', `${view.height - y}px`)\n        .css('max-height', `${y}px`)\n        .css('top', 'auto');\n    } else {\n      el.css('top', `${y}px`)\n        .css('max-height', `${view.height - y}px`)\n        .css('bottom', 'auto');\n    }\n    bindClickoutside(el);\n  }\n}\n","import {cssPrefix} from '../../config';\nimport tooltip from '../tooltip';\nimport {h} from '../element';\nimport {t} from '../../locale/locale';\n\nexport default class Item {\n    // tooltip\n    // tag: the subclass type\n    // shortcut: shortcut key\n    constructor(tag, shortcut, value) {\n        this.tip = '';\n        if (tag) this.tip = t(`toolbar.${tag.replace(/-[a-z]/g, c => c[1].toUpperCase())}`);\n        if (shortcut) this.tip += ` (${shortcut})`;\n        this.tag = tag;\n        this.shortcut = shortcut;\n        this.value = value;\n        this.el = this.element();\n        this.change = () => {\n        };\n    }\n\n    element() {\n        const {tip} = this;\n        return h('div', `${cssPrefix}-toolbar-btn`)\n            .on('mouseenter', (evt) => {\n                if (this.tip) tooltip(this.tip, evt.target);\n            })\n            .attr('data-tooltip', tip);\n    }\n\n    setState() {\n    }\n}\n","/* global document */\r\nimport { h } from './element';\r\nimport { bind } from './event';\r\nimport { cssPrefix } from '../config';\r\n\r\nexport default function tooltip(html, target) {\r\n  if (target.classList.contains('active')) {\r\n    return;\r\n  }\r\n  const {\r\n    left, top, width, height,\r\n  } = target.getBoundingClientRect();\r\n  const el = h('div', `${cssPrefix}-tooltip`).html(html).show();\r\n  document.body.appendChild(el.el);\r\n  const elBox = el.box();\r\n  // console.log('elBox:', elBox);\r\n  el.css('left', `${left + (width / 2) - (elBox.width / 2)}px`)\r\n    .css('top', `${top + height + 2}px`);\r\n\r\n  bind(target, 'mouseleave', () => {\r\n    if (document.body.contains(el.el)) {\r\n      document.body.removeChild(el.el);\r\n    }\r\n  });\r\n\r\n  bind(target, 'click', () => {\r\n    if (document.body.contains(el.el)) {\r\n      document.body.removeChild(el.el);\r\n    }\r\n  });\r\n}\r\n","import Item from './item';\n\nexport default class DropdownItem extends Item {\n    dropdown() {\n    }\n\n    getValue(v) {\n        return v;\n    }\n\n    element() {\n        const {tag} = this;\n        this.dd = this.dropdown();\n        this.dd.change = it => this.change(tag, this.getValue(it));\n        return super.element().child(\n            this.dd,\n        );\n    }\n\n    setState(v) {\n        if (v) {\n            this.value = v;\n            this.dd.setTitle(v);\n        }\n    }\n}\n","import { Element, h } from './element';\r\nimport { bindClickoutside, unbindClickoutside } from './event';\r\nimport { cssPrefix } from '../config';\r\n\r\nexport default class Dropdown extends Element {\r\n  constructor(title, width, showArrow, placement, ...children) {\r\n    super('div', `${cssPrefix}-dropdown ${placement}`);\r\n    this.title = title;\r\n    this.change = () => {};\r\n    this.headerClick = () => {};\r\n    if (typeof title === 'string') {\r\n      this.title = h('div', `${cssPrefix}-dropdown-title`).child(title);\r\n    } else if (showArrow) {\r\n      this.title.addClass('arrow-left');\r\n    }\r\n    this.contentEl = h('div', `${cssPrefix}-dropdown-content`)\r\n      .css('width', width)\r\n      .hide();\r\n\r\n    this.setContentChildren(...children);\r\n\r\n    this.headerEl = h('div', `${cssPrefix}-dropdown-header`);\r\n    this.headerEl.on('click', () => {\r\n      if (this.contentEl.css('display') !== 'block') {\r\n        this.show();\r\n      } else {\r\n        this.hide();\r\n      }\r\n    }).children(\r\n      this.title,\r\n      showArrow ? h('div', `${cssPrefix}-icon arrow-right`).child(\r\n        h('div', `${cssPrefix}-icon-img arrow-down`),\r\n      ) : '',\r\n    );\r\n    this.children(this.headerEl, this.contentEl);\r\n  }\r\n\r\n  setContentChildren(...children) {\r\n    this.contentEl.html('');\r\n    if (children.length > 0) {\r\n      this.contentEl.children(...children);\r\n    }\r\n  }\r\n\r\n  setTitle(title) {\r\n    this.title.html(title);\r\n    this.hide();\r\n  }\r\n\r\n  show() {\r\n    const { contentEl } = this;\r\n    contentEl.show();\r\n    this.parent().active();\r\n    bindClickoutside(this.parent(), () => {\r\n      this.hide();\r\n    });\r\n  }\r\n\r\n  hide() {\r\n    this.parent().active(false);\r\n    this.contentEl.hide();\r\n    unbindClickoutside(this.parent());\r\n  }\r\n}\r\n","import Dropdown from './dropdown';\r\nimport { h } from './element';\r\nimport Icon from './icon';\r\nimport { cssPrefix } from '../config';\r\n\r\nfunction buildItemWithIcon(iconName) {\r\n  return h('div', `${cssPrefix}-item`).child(new Icon(iconName));\r\n}\r\n\r\nexport default class DropdownAlign extends Dropdown {\r\n  constructor(aligns, align) {\r\n    const icon = new Icon(`align-${align}`);\r\n    const naligns = aligns.map(it => buildItemWithIcon(`align-${it}`)\r\n      .on('click', () => {\r\n        this.setTitle(it);\r\n        this.change(it);\r\n      }));\r\n    super(icon, 'auto', true, 'bottom-left', ...naligns);\r\n  }\r\n\r\n  setTitle(align) {\r\n    this.title.setName(`align-${align}`);\r\n    this.hide();\r\n  }\r\n}\r\n","import DropdownItem from './dropdown_item';\nimport DropdownAlign from '../dropdown_align';\n\nexport default class Align extends DropdownItem {\n    constructor(value) {\n        super('align', '', value);\n    }\n\n    dropdown() {\n        const {value} = this;\n        return new DropdownAlign(['left', 'center', 'right'], value);\n    }\n}\n","import DropdownItem from './dropdown_item';\nimport DropdownAlign from '../dropdown_align';\n\nexport default class Valign extends DropdownItem {\n    constructor(value) {\n        super('valign', '', value);\n    }\n\n    dropdown() {\n        const {value} = this;\n        return new DropdownAlign(['top', 'middle', 'bottom'], value);\n    }\n}\n","import Item from './item';\nimport Icon from '../icon';\n\nexport default class ToggleItem extends Item {\n    element() {\n        const {tag} = this;\n        return super.element()\n            .child(new Icon(tag))\n            .on('click', () => this.click());\n    }\n\n    click() {\n        this.change(this.tag, this.toggle());\n    }\n\n    setState(active) {\n        this.el.active(active);\n    }\n\n    toggle() {\n        return this.el.toggle();\n    }\n\n    active() {\n        return this.el.hasClass('active');\n    }\n}\n","import ToggleItem from './toggle_item';\n\nexport default class Autofilter extends ToggleItem {\n    constructor() {\n        super('autofilter');\n    }\n\n    setState() {\n    }\n}\n","import ToggleItem from './toggle_item';\n\nexport default class Bold extends ToggleItem {\n    constructor() {\n        super('font-bold', 'Ctrl+B');\n    }\n}\n","import ToggleItem from './toggle_item';\n\nexport default class Italic extends ToggleItem {\n    constructor() {\n        super('font-italic', 'Ctrl+I');\n    }\n}\n","import ToggleItem from './toggle_item';\n\nexport default class Strike extends ToggleItem {\n    constructor() {\n        super('strike', 'Ctrl+U');\n    }\n}\n","import ToggleItem from './toggle_item';\n\nexport default class Underline extends ToggleItem {\n    constructor() {\n        super('underline', 'Ctrl+U');\n    }\n}\n","import { h } from './element';\r\nimport { cssPrefix } from '../config';\r\n\r\nconst themeColorPlaceHolders = ['#ffffff', '#000100', '#e7e5e6', '#445569', '#5b9cd6', '#ed7d31', '#a5a5a5', '#ffc001', '#4371c6', '#71ae47'];\r\n\r\nconst themeColors = [\r\n  ['#f2f2f2', '#7f7f7f', '#d0cecf', '#d5dce4', '#deeaf6', '#fce5d5', '#ededed', '#fff2cd', '#d9e2f3', '#e3efd9'],\r\n  ['#d8d8d8', '#595959', '#afabac', '#adb8ca', '#bdd7ee', '#f7ccac', '#dbdbdb', '#ffe59a', '#b3c6e7', '#c5e0b3'],\r\n  ['#bfbfbf', '#3f3f3f', '#756f6f', '#8596b0', '#9cc2e6', '#f4b184', '#c9c9c9', '#fed964', '#8eaada', '#a7d08c'],\r\n  ['#a5a5a5', '#262626', '#3a3839', '#333f4f', '#2e75b5', '#c45a10', '#7b7b7b', '#bf8e01', '#2f5596', '#538136'],\r\n  ['#7f7f7f', '#0c0c0c', '#171516', '#222a35', '#1f4e7a', '#843c0a', '#525252', '#7e6000', '#203864', '#365624'],\r\n];\r\n\r\nconst standardColors = ['#c00000', '#fe0000', '#fdc101', '#ffff01', '#93d051', '#00b04e', '#01b0f1', '#0170c1', '#012060', '#7030a0'];\r\n\r\nfunction buildTd(bgcolor) {\r\n  return h('td', '').child(\r\n    h('div', `${cssPrefix}-color-palette-cell`)\r\n      .on('click.stop', () => this.change(bgcolor))\r\n      .css('background-color', bgcolor),\r\n  );\r\n}\r\n\r\nexport default class ColorPalette {\r\n  constructor() {\r\n    this.el = h('div', `${cssPrefix}-color-palette`);\r\n    this.change = () => {};\r\n    const table = h('table', '').children(\r\n      h('tbody', '').children(\r\n        h('tr', `${cssPrefix}-theme-color-placeholders`).children(\r\n          ...themeColorPlaceHolders.map(color => buildTd.call(this, color)),\r\n        ),\r\n        ...themeColors.map(it => h('tr', `${cssPrefix}-theme-colors`).children(\r\n          ...it.map(color => buildTd.call(this, color)),\r\n        )),\r\n        h('tr', `${cssPrefix}-standard-colors`).children(\r\n          ...standardColors.map(color => buildTd.call(this, color)),\r\n        ),\r\n      ),\r\n    );\r\n    this.el.child(table);\r\n  }\r\n}\r\n","import Dropdown from './dropdown';\r\nimport Icon from './icon';\r\nimport ColorPalette from './color_palette';\r\n\r\nexport default class DropdownColor extends Dropdown {\r\n  constructor(iconName, color) {\r\n    const icon = new Icon(iconName)\r\n      .css('height', '16px')\r\n      .css('border-bottom', `3px solid ${color}`);\r\n    const colorPalette = new ColorPalette();\r\n    colorPalette.change = (v) => {\r\n      this.setTitle(v);\r\n      this.change(v);\r\n    };\r\n    super(icon, 'auto', false, 'bottom-left', colorPalette.el);\r\n  }\r\n\r\n  setTitle(color) {\r\n    this.title.css('border-color', color);\r\n    this.hide();\r\n  }\r\n}\r\n","import Dropdown from './dropdown';\r\nimport { h } from './element';\r\nimport Icon from './icon';\r\nimport { cssPrefix } from '../config';\r\n\r\nconst lineTypes = [\r\n  ['thin', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"1\" style=\"user-select: none;\"><line x1=\"0\" y1=\"0.5\" x2=\"50\" y2=\"0.5\" stroke-width=\"1\" stroke=\"black\" style=\"user-select: none;\"></line></svg>'],\r\n  ['medium', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"2\" style=\"user-select: none;\"><line x1=\"0\" y1=\"1.0\" x2=\"50\" y2=\"1.0\" stroke-width=\"2\" stroke=\"black\" style=\"user-select: none;\"></line></svg>'],\r\n  ['thick', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"3\" style=\"user-select: none;\"><line x1=\"0\" y1=\"1.5\" x2=\"50\" y2=\"1.5\" stroke-width=\"3\" stroke=\"black\" style=\"user-select: none;\"></line></svg>'],\r\n  ['dashed', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"1\" style=\"user-select: none;\"><line x1=\"0\" y1=\"0.5\" x2=\"50\" y2=\"0.5\" stroke-width=\"1\" stroke=\"black\" stroke-dasharray=\"2\" style=\"user-select: none;\"></line></svg>'],\r\n  ['dotted', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"1\" style=\"user-select: none;\"><line x1=\"0\" y1=\"0.5\" x2=\"50\" y2=\"0.5\" stroke-width=\"1\" stroke=\"black\" stroke-dasharray=\"1\" style=\"user-select: none;\"></line></svg>'],\r\n  // ['double', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"3\" style=\"user-select: none;\"><line x1=\"0\" y1=\"0.5\" x2=\"50\" y2=\"0.5\" stroke-width=\"1\" stroke=\"black\" style=\"user-select: none;\"></line><line x1=\"0\" y1=\"2.5\" x2=\"50\" y2=\"2.5\" stroke-width=\"1\" stroke=\"black\" style=\"user-select: none;\"></line></svg>'],\r\n];\r\n\r\nexport default class DropdownLineType extends Dropdown {\r\n  constructor(type) {\r\n    const icon = new Icon('line-type');\r\n    let beforei = 0;\r\n    const lineTypeEls = lineTypes.map((it, iti) => h('div', `${cssPrefix}-item state ${type === it[0] ? 'checked' : ''}`)\r\n      .on('click', () => {\r\n        lineTypeEls[beforei].toggle('checked');\r\n        lineTypeEls[iti].toggle('checked');\r\n        beforei = iti;\r\n        this.hide();\r\n        this.change(it);\r\n      })\r\n      .child(\r\n        h('div', `${cssPrefix}-line-type`).html(it[1]),\r\n      ));\r\n\r\n    super(icon, 'auto', false, 'bottom-left', ...lineTypeEls);\r\n  }\r\n}\r\n","import { h } from './element';\r\nimport Icon from './icon';\r\nimport DropdownColor from './dropdown_color';\r\nimport DropdownLineType from './dropdown_linetype';\r\nimport { cssPrefix } from '../config';\r\n\r\nfunction buildTable(...trs) {\r\n  return h('table', '').child(\r\n    h('tbody', '').children(...trs),\r\n  );\r\n}\r\n\r\nfunction buildTd(iconName) {\r\n  return h('td', '').child(\r\n    h('div', `${cssPrefix}-border-palette-cell`).child(\r\n      new Icon(`border-${iconName}`),\r\n    ).on('click', () => {\r\n      this.mode = iconName;\r\n      const { mode, style, color } = this;\r\n      this.change({ mode, style, color });\r\n    }),\r\n  );\r\n}\r\n\r\nexport default class BorderPalette {\r\n  constructor() {\r\n    this.color = '#000';\r\n    this.style = 'thin';\r\n    this.mode = 'all';\r\n    this.change = () => {};\r\n    this.ddColor = new DropdownColor('line-color', this.color);\r\n    this.ddColor.change = (color) => {\r\n      this.color = color;\r\n    };\r\n    this.ddType = new DropdownLineType(this.style);\r\n    this.ddType.change = ([s]) => {\r\n      this.style = s;\r\n    };\r\n    this.el = h('div', `${cssPrefix}-border-palette`);\r\n    const table = buildTable(\r\n      h('tr', '').children(\r\n        h('td', `${cssPrefix}-border-palette-left`).child(\r\n          buildTable(\r\n            h('tr', '').children(\r\n              ...['all', 'inside', 'horizontal', 'vertical', 'outside'].map(it => buildTd.call(this, it)),\r\n            ),\r\n            h('tr', '').children(\r\n              ...['left', 'top', 'right', 'bottom', 'none'].map(it => buildTd.call(this, it)),\r\n            ),\r\n          ),\r\n        ),\r\n        h('td', `${cssPrefix}-border-palette-right`).children(\r\n          h('div', `${cssPrefix}-toolbar-btn`).child(this.ddColor.el),\r\n          h('div', `${cssPrefix}-toolbar-btn`).child(this.ddType.el),\r\n        ),\r\n      ),\r\n    );\r\n    this.el.child(table);\r\n  }\r\n}\r\n","import Dropdown from './dropdown';\r\nimport Icon from './icon';\r\nimport BorderPalette from './border_palette';\r\n\r\nexport default class DropdownBorder extends Dropdown {\r\n  constructor() {\r\n    const icon = new Icon('border-all');\r\n    const borderPalette = new BorderPalette();\r\n    borderPalette.change = (v) => {\r\n      this.change(v);\r\n      this.hide();\r\n    };\r\n    super(icon, 'auto', false, 'bottom-left', borderPalette.el);\r\n  }\r\n}\r\n","import DropdownItem from './dropdown_item';\nimport DropdownBorder from '../dropdown_border';\n\nexport default class Border extends DropdownItem {\n    constructor() {\n        super('border');\n    }\n\n    dropdown() {\n        return new DropdownBorder();\n    }\n}\n","import Item from './item';\nimport Icon from '../icon';\n\nexport default class IconItem extends Item {\n    element() {\n        return super.element()\n            .child(new Icon(this.tag))\n            .on('click', () => this.change(this.tag));\n    }\n\n    setState(disabled) {\n        this.el.disabled(disabled);\n    }\n}\n","import IconItem from './icon_item';\n\nexport default class Clearformat extends IconItem {\n    constructor() {\n        super('clearformat');\n    }\n}\n","import ToggleItem from './toggle_item';\n\nexport default class Paintformat extends ToggleItem {\n    constructor() {\n        super('paintformat');\n    }\n\n    setState() {\n    }\n}\n","import DropdownItem from './dropdown_item';\nimport DropdownColor from '../dropdown_color';\n\nexport default class TextColor extends DropdownItem {\n    constructor(color) {\n        super('color', undefined, color);\n    }\n\n    dropdown() {\n        const {tag, value} = this;\n        return new DropdownColor(tag, value);\n    }\n}\n","import DropdownItem from './dropdown_item';\nimport DropdownColor from '../dropdown_color';\n\nexport default class FillColor extends DropdownItem {\n    constructor(color) {\n        super('bgcolor', undefined, color);\n    }\n\n    dropdown() {\n        const {tag, value} = this;\n        return new DropdownColor(tag, value);\n    }\n}\n","import Dropdown from './dropdown';\r\nimport { h } from './element';\r\nimport { fontSizes } from '../core/font';\r\nimport { cssPrefix } from '../config';\r\n\r\nexport default class DropdownFontSize extends Dropdown {\r\n  constructor() {\r\n    const nfontSizes = fontSizes.map(it => h('div', `${cssPrefix}-item`)\r\n      .on('click', () => {\r\n        this.setTitle(`${it.pt}`);\r\n        this.change(it);\r\n      })\r\n      .child(`${it.pt}`));\r\n    super('10', '60px', true, 'bottom-left', ...nfontSizes);\r\n  }\r\n}\r\n","import DropdownItem from './dropdown_item';\nimport DropdownFontsize from '../dropdown_fontsize';\n\nexport default class Format extends DropdownItem {\n    constructor() {\n        super('font-size');\n    }\n\n    getValue(it) {\n        return it.pt;\n    }\n\n    dropdown() {\n        return new DropdownFontsize();\n    }\n}\n","import Dropdown from './dropdown';\r\nimport { h } from './element';\r\nimport { baseFonts } from '../core/font';\r\nimport { cssPrefix } from '../config';\r\n\r\nexport default class DropdownFont extends Dropdown {\r\n  constructor() {\r\n    const nfonts = baseFonts.map(it => h('div', `${cssPrefix}-item`)\r\n      .on('click', () => {\r\n        this.setTitle(it.title);\r\n        this.change(it);\r\n      })\r\n      .child(it.title));\r\n    super(baseFonts[0].title, '160px', true, 'bottom-left', ...nfonts);\r\n  }\r\n}\r\n","import DropdownItem from './dropdown_item';\nimport DropdownFont from '../dropdown_font';\n\nexport default class Font extends DropdownItem {\n    constructor() {\n        super('font-name');\n    }\n\n    getValue(it) {\n        return it.key;\n    }\n\n    dropdown() {\n        return new DropdownFont();\n    }\n}\n","import Dropdown from './dropdown';\r\nimport { h } from './element';\r\nimport { baseFormats } from '../core/format';\r\nimport { cssPrefix } from '../config';\r\n\r\nexport default class DropdownFormat extends Dropdown {\r\n  constructor() {\r\n    let nformats = baseFormats.slice(0);\r\n    nformats.splice(2, 0, { key: 'divider' });\r\n    nformats.splice(8, 0, { key: 'divider' });\r\n    nformats = nformats.map((it) => {\r\n      const item = h('div', `${cssPrefix}-item`);\r\n      if (it.key === 'divider') {\r\n        item.addClass('divider');\r\n      } else {\r\n        item.child(it.title())\r\n          .on('click', () => {\r\n            this.setTitle(it.title());\r\n            this.change(it);\r\n          });\r\n        if (it.label) item.child(h('div', 'label').html(it.label));\r\n      }\r\n      return item;\r\n    });\r\n    super('Normal', '220px', true, 'bottom-left', ...nformats);\r\n  }\r\n\r\n  setTitle(key) {\r\n    for (let i = 0; i < baseFormats.length; i += 1) {\r\n      if (baseFormats[i].key === key) {\r\n        this.title.html(baseFormats[i].title());\r\n      }\r\n    }\r\n    this.hide();\r\n  }\r\n}\r\n","import DropdownItem from './dropdown_item';\nimport DropdownFormat from '../dropdown_format';\n\nexport default class Format extends DropdownItem {\n    constructor() {\n        super('format');\n    }\n\n    getValue(it) {\n        return it.key;\n    }\n\n    dropdown() {\n        return new DropdownFormat();\n    }\n}\n","import Dropdown from './dropdown';\r\nimport Icon from './icon';\r\nimport { h } from './element';\r\nimport { baseFormulas } from '../core/formula';\r\nimport { cssPrefix } from '../config';\r\n\r\nexport default class DropdownFormula extends Dropdown {\r\n  constructor() {\r\n    const nformulas = baseFormulas.map(it => h('div', `${cssPrefix}-item`)\r\n      .on('click', () => {\r\n        this.hide();\r\n        this.change(it);\r\n      })\r\n      .child(it.key));\r\n    super(new Icon('formula'), '180px', true, 'bottom-left', ...nformulas);\r\n  }\r\n}\r\n","import DropdownItem from './dropdown_item';\nimport DropdownFormula from '../dropdown_formula';\n\nexport default class Format extends DropdownItem {\n    constructor() {\n        super('formula');\n    }\n\n    getValue(it) {\n        return it.key;\n    }\n\n    dropdown() {\n        return new DropdownFormula();\n    }\n}\n","import ToggleItem from './toggle_item';\n\nexport default class Freeze extends ToggleItem {\n    constructor() {\n        super('freeze');\n    }\n}\n","import ToggleItem from './toggle_item';\n\nexport default class Merge extends ToggleItem {\n    constructor() {\n        super('merge');\n    }\n\n    setState(active, disabled) {\n        this.el.active(active).disabled(disabled);\n    }\n}\n","import IconItem from './icon_item';\n\nexport default class Redo extends IconItem {\n    constructor() {\n        super('redo', 'Ctrl+Y');\n    }\n}\n","import IconItem from './icon_item';\n\nexport default class Undo extends IconItem {\n    constructor() {\n        super('undo', 'Ctrl+Z');\n    }\n}\n","import IconItem from './icon_item';\n\nexport default class Print extends IconItem {\n    constructor() {\n        super('print', 'Ctrl+P');\n    }\n}\n","import ToggleItem from './toggle_item';\n\nexport default class Textwrap extends ToggleItem {\n    constructor() {\n        super('textwrap');\n    }\n}\n","import Dropdown from '../dropdown';\nimport DropdownItem from './dropdown_item';\n\nimport {cssPrefix} from '../../config';\nimport {h} from '../element';\nimport Icon from '../icon';\n\nclass DropdownMore extends Dropdown {\n    constructor() {\n        const icon = new Icon('ellipsis');\n        const moreBtns = h('div', `${cssPrefix}-toolbar-more`);\n        super(icon, 'auto', false, 'bottom-right', moreBtns);\n        this.moreBtns = moreBtns;\n        this.contentEl.css('max-width', '420px');\n    }\n}\n\nexport default class More extends DropdownItem {\n    constructor() {\n        super('more');\n        this.el.hide();\n    }\n\n    dropdown() {\n        return new DropdownMore();\n    }\n\n    show() {\n        this.el.show();\n    }\n\n    hide() {\n        this.el.hide();\n    }\n}\n","/* global window */\n\nimport Align from './align';\nimport Valign from './valign';\nimport Autofilter from './autofilter';\nimport Bold from './bold';\nimport Italic from './italic';\nimport Strike from './strike';\nimport Underline from './underline';\nimport Border from './border';\nimport Clearformat from './clearformat';\nimport Paintformat from './paintformat';\nimport TextColor from './text_color';\nimport FillColor from './fill_color';\nimport FontSize from './font_size';\nimport Font from './font';\nimport Format from './format';\nimport Formula from './formula';\nimport Freeze from './freeze';\nimport Merge from './merge';\nimport Redo from './redo';\nimport Undo from './undo';\nimport Print from './print';\nimport Textwrap from './textwrap';\nimport More from './more';\nimport Item from './item';\n\nimport {h} from '../element';\nimport {cssPrefix} from '../../config';\nimport {bind} from '../event';\n\nfunction buildDivider() {\n    return h('div', `${cssPrefix}-toolbar-divider`);\n}\n\nfunction initBtns2() {\n    this.btns2 = [];\n    this.items.forEach((it) => {\n        if (Array.isArray(it)) {\n            it.forEach(({el}) => {\n                const rect = el.box();\n                const {marginLeft, marginRight} = el.computedStyle();\n                this.btns2.push([el, rect.width + parseInt(marginLeft, 10) + parseInt(marginRight, 10)]);\n            });\n        } else {\n            const rect = it.box();\n            const {marginLeft, marginRight} = it.computedStyle();\n            this.btns2.push([it, rect.width + parseInt(marginLeft, 10) + parseInt(marginRight, 10)]);\n        }\n    });\n}\n\nfunction moreResize() {\n    const {\n        el, btns, moreEl, btns2,\n    } = this;\n    const {moreBtns, contentEl} = moreEl.dd;\n    el.css('width', `${this.widthFn()}px`);\n    const elBox = el.box();\n\n    let sumWidth = 160;\n    let sumWidth2 = 12;\n    const list1 = [];\n    const list2 = [];\n    btns2.forEach(([it, w], index) => {\n        sumWidth += w;\n        if (index === btns2.length - 1 || sumWidth < elBox.width) {\n            list1.push(it);\n        } else {\n            sumWidth2 += w;\n            list2.push(it);\n        }\n    });\n    btns.html('').children(...list1);\n    moreBtns.html('').children(...list2);\n    contentEl.css('width', `${sumWidth2}px`);\n    if (list2.length > 0) {\n        moreEl.show();\n    } else {\n        moreEl.hide();\n    }\n}\n\nfunction genBtn(it) {\n    const btn = new Item();\n    btn.el.on('click', () => {\n        if (it.onClick) it.onClick(this.data.getData(), this.data);\n    });\n    btn.tip = it.tip || '';\n\n    let {el} = it;\n\n    if (it.icon) {\n        el = h('img').attr('src', it.icon);\n    }\n\n    if (el) {\n        const icon = h('div', `${cssPrefix}-icon`);\n        icon.child(el);\n        btn.el.child(icon);\n    }\n\n    return btn;\n}\n\nexport default class Toolbar {\n    constructor(data, widthFn, isHide = false) {\n        this.data = data;\n        this.change = () => {\n        };\n        this.widthFn = widthFn;\n        this.isHide = isHide;\n        const style = data.defaultStyle();\n        this.items = [\n            [\n                this.undoEl = new Undo(),\n                this.redoEl = new Redo(),\n                new Print(),\n                this.paintformatEl = new Paintformat(),\n                this.clearformatEl = new Clearformat(),\n            ],\n            buildDivider(),\n            [\n                this.formatEl = new Format(),\n            ],\n            buildDivider(),\n            [\n                this.fontEl = new Font(),\n                this.fontSizeEl = new FontSize(),\n            ],\n            buildDivider(),\n            [\n                this.boldEl = new Bold(),\n                this.italicEl = new Italic(),\n                this.underlineEl = new Underline(),\n                this.strikeEl = new Strike(),\n                this.textColorEl = new TextColor(style.color),\n            ],\n            buildDivider(),\n            [\n                this.fillColorEl = new FillColor(style.bgcolor),\n                this.borderEl = new Border(),\n                this.mergeEl = new Merge(),\n            ],\n            buildDivider(),\n            [\n                this.alignEl = new Align(style.align),\n                this.valignEl = new Valign(style.valign),\n                this.textwrapEl = new Textwrap(),\n            ],\n            buildDivider(),\n            [\n                this.freezeEl = new Freeze(),\n                this.autofilterEl = new Autofilter(),\n                this.formulaEl = new Formula(),\n            ],\n        ];\n\n        const {extendToolbar = {}} = data.settings;\n\n        if (extendToolbar.left && extendToolbar.left.length > 0) {\n            this.items.unshift(buildDivider());\n            const btns = extendToolbar.left.map(genBtn.bind(this));\n\n            this.items.unshift(btns);\n        }\n        if (extendToolbar.right && extendToolbar.right.length > 0) {\n            this.items.push(buildDivider());\n            const btns = extendToolbar.right.map(genBtn.bind(this));\n            this.items.push(btns);\n        }\n\n        this.items.push([this.moreEl = new More()]);\n\n        this.el = h('div', `${cssPrefix}-toolbar`);\n        this.btns = h('div', `${cssPrefix}-toolbar-btns`);\n\n        this.items.forEach((it) => {\n            if (Array.isArray(it)) {\n                it.forEach((i) => {\n                    this.btns.child(i.el);\n                    i.change = (...args) => {\n                        this.change(...args);\n                    };\n                });\n            } else {\n                this.btns.child(it.el);\n            }\n        });\n\n        this.el.child(this.btns);\n        if (isHide) {\n            this.el.hide();\n        } else {\n            this.reset();\n            setTimeout(() => {\n                initBtns2.call(this);\n                moreResize.call(this);\n            }, 0);\n            bind(window, 'resize', () => {\n                moreResize.call(this);\n            });\n        }\n    }\n\n    paintformatActive() {\n        return this.paintformatEl.active();\n    }\n\n    paintformatToggle() {\n        this.paintformatEl.toggle();\n    }\n\n    trigger(type) {\n        this[`${type}El`].click();\n    }\n\n    resetData(data) {\n        this.data = data;\n        this.reset();\n    }\n\n    reset() {\n        if (this.isHide) return;\n        const {data} = this;\n        const style = data.getSelectedCellStyle();\n        // console.log('canUndo:', data.canUndo());\n        this.undoEl.setState(!data.canUndo());\n        this.redoEl.setState(!data.canRedo());\n        this.mergeEl.setState(data.canUnmerge(), !data.selector.multiple());\n        this.autofilterEl.setState(!data.canAutofilter());\n        // this.mergeEl.disabled();\n        // console.log('selectedCell:', style, cell);\n        const {font, format} = style;\n        this.formatEl.setState(format);\n        this.fontEl.setState(font.name);\n        this.fontSizeEl.setState(font.size);\n        this.boldEl.setState(font.bold);\n        this.italicEl.setState(font.italic);\n        this.underlineEl.setState(style.underline);\n        this.strikeEl.setState(style.strike);\n        this.textColorEl.setState(style.color);\n        this.fillColorEl.setState(style.bgcolor);\n        this.alignEl.setState(style.align);\n        this.valignEl.setState(style.valign);\n        this.textwrapEl.setState(style.textwrap);\n        // console.log('freeze is Active:', data.freezeIsActive());\n        this.freezeEl.setState(data.freezeIsActive());\n    }\n}\n","/* global document */\n/* global window */\nimport {h} from './element';\nimport Icon from './icon';\nimport {cssPrefix} from '../config';\nimport {bind, unbind} from './event';\n\nexport default class Modal {\n    constructor(title, content, width = '600px') {\n        this.title = title;\n        this.el = h('div', `${cssPrefix}-modal`).css('width', width).children(\n            h('div', `${cssPrefix}-modal-header`).children(\n                new Icon('close').on('click.stop', () => this.hide()),\n                this.title,\n            ),\n            h('div', `${cssPrefix}-modal-content`).children(...content),\n        ).hide();\n    }\n\n    show() {\n        // dimmer\n        this.dimmer = h('div', `${cssPrefix}-dimmer active`);\n        document.body.appendChild(this.dimmer.el);\n        const {width, height} = this.el.show().box();\n        const {clientHeight, clientWidth} = document.documentElement;\n        this.el.offset({\n            left: (clientWidth - width) / 2,\n            top: (clientHeight - height) / 3,\n        });\n        window.xkeydownEsc = (evt) => {\n            if (evt.keyCode === 27) {\n                this.hide();\n            }\n        };\n        bind(window, 'keydown', window.xkeydownEsc);\n    }\n\n    hide() {\n        this.el.hide();\n        document.body.removeChild(this.dimmer.el);\n        unbind(window, 'keydown', window.xkeydownEsc);\n        delete window.xkeydownEsc;\n    }\n}\n","import { h } from './element';\r\nimport { cssPrefix } from '../config';\r\n\r\nexport default class FormInput {\r\n  constructor(width, hint) {\r\n    this.vchange = () => {};\r\n    this.el = h('div', `${cssPrefix}-form-input`);\r\n    this.input = h('input', '').css('width', width)\r\n      .on('input', evt => this.vchange(evt))\r\n      .attr('placeholder', hint);\r\n    this.el.child(this.input);\r\n  }\r\n\r\n  focus() {\r\n    setTimeout(() => {\r\n      this.input.el.focus();\r\n    }, 10);\r\n  }\r\n\r\n  hint(v) {\r\n    this.input.attr('placeholder', v);\r\n  }\r\n\r\n  val(v) {\r\n    return this.input.val(v);\r\n  }\r\n}\r\n","import { h } from './element';\r\nimport Suggest from './suggest';\r\nimport { cssPrefix } from '../config';\r\n\r\nexport default class FormSelect {\r\n  constructor(key, items, width, getTitle = it => it, change = () => {}) {\r\n    this.key = key;\r\n    this.getTitle = getTitle;\r\n    this.vchange = () => {};\r\n    this.el = h('div', `${cssPrefix}-form-select`);\r\n    this.suggest = new Suggest(items.map(it => ({ key: it, title: this.getTitle(it) })), (it) => {\r\n      this.itemClick(it.key);\r\n      change(it.key);\r\n      this.vchange(it.key);\r\n    }, width, this.el);\r\n    this.el.children(\r\n      this.itemEl = h('div', 'input-text').html(this.getTitle(key)),\r\n      this.suggest.el,\r\n    ).on('click', () => this.show());\r\n  }\r\n\r\n  show() {\r\n    this.suggest.search('');\r\n  }\r\n\r\n  itemClick(it) {\r\n    this.key = it;\r\n    this.itemEl.html(this.getTitle(it));\r\n  }\r\n\r\n  val(v) {\r\n    if (v !== undefined) {\r\n      this.key = v;\r\n      this.itemEl.html(this.getTitle(v));\r\n      return this;\r\n    }\r\n    return this.key;\r\n  }\r\n}\r\n","import { h } from './element';\r\nimport { cssPrefix } from '../config';\r\nimport { t } from '../locale/locale';\r\n\r\nconst patterns = {\r\n  number: /(^\\d+$)|(^\\d+(\\.\\d{0,4})?$)/,\r\n  date: /^\\d{4}-\\d{1,2}-\\d{1,2}$/,\r\n};\r\n\r\n// rule: { required: false, type, pattern: // }\r\nexport default class FormField {\r\n  constructor(input, rule, label, labelWidth) {\r\n    this.label = '';\r\n    this.rule = rule;\r\n    if (label) {\r\n      this.label = h('label', 'label').css('width', `${labelWidth}px`).html(label);\r\n    }\r\n    this.tip = h('div', 'tip').child('tip').hide();\r\n    this.input = input;\r\n    this.input.vchange = () => this.validate();\r\n    this.el = h('div', `${cssPrefix}-form-field`)\r\n      .children(this.label, input.el, this.tip);\r\n  }\r\n\r\n  isShow() {\r\n    return this.el.css('display') !== 'none';\r\n  }\r\n\r\n  show() {\r\n    this.el.show();\r\n  }\r\n\r\n  hide() {\r\n    this.el.hide();\r\n    return this;\r\n  }\r\n\r\n  val(v) {\r\n    return this.input.val(v);\r\n  }\r\n\r\n  hint(hint) {\r\n    this.input.hint(hint);\r\n  }\r\n\r\n  validate() {\r\n    const {\r\n      input, rule, tip, el,\r\n    } = this;\r\n    const v = input.val();\r\n    if (rule.required) {\r\n      if (/^\\s*$/.test(v)) {\r\n        tip.html(t('validation.required'));\r\n        el.addClass('error');\r\n        return false;\r\n      }\r\n    }\r\n    if (rule.type || rule.pattern) {\r\n      const pattern = rule.pattern || patterns[rule.type];\r\n      if (!pattern.test(v)) {\r\n        tip.html(t('validation.notMatch'));\r\n        el.addClass('error');\r\n        return false;\r\n      }\r\n    }\r\n    el.removeClass('error');\r\n    return true;\r\n  }\r\n}\r\n","import Modal from './modal';\r\nimport FormInput from './form_input';\r\nimport FormSelect from './form_select';\r\nimport FormField from './form_field';\r\nimport Button from './button';\r\nimport { t } from '../locale/locale';\r\nimport { h } from './element';\r\nimport { cssPrefix } from '../config';\r\n\r\nconst fieldLabelWidth = 100;\r\n\r\nexport default class ModalValidation extends Modal {\r\n  constructor() {\r\n    const mf = new FormField(\r\n      new FormSelect('cell',\r\n        ['cell'], // cell|row|column\r\n        '100%',\r\n        it => t(`dataValidation.modeType.${it}`)),\r\n      { required: true },\r\n      `${t('dataValidation.range')}:`,\r\n      fieldLabelWidth,\r\n    );\r\n    const rf = new FormField(\r\n      new FormInput('120px', 'E3 or E3:F12'),\r\n      { required: true, pattern: /^([A-Z]{1,2}[1-9]\\d*)(:[A-Z]{1,2}[1-9]\\d*)?$/ },\r\n    );\r\n    const cf = new FormField(\r\n      new FormSelect('list',\r\n        ['list', 'number', 'date', 'phone', 'email'],\r\n        '100%',\r\n        it => t(`dataValidation.type.${it}`),\r\n        it => this.criteriaSelected(it)),\r\n      { required: true },\r\n      `${t('dataValidation.criteria')}:`,\r\n      fieldLabelWidth,\r\n    );\r\n\r\n    // operator\r\n    const of = new FormField(\r\n      new FormSelect('be',\r\n        ['be', 'nbe', 'eq', 'neq', 'lt', 'lte', 'gt', 'gte'],\r\n        '160px',\r\n        it => t(`dataValidation.operator.${it}`),\r\n        it => this.criteriaOperatorSelected(it)),\r\n      { required: true },\r\n    ).hide();\r\n    // min, max\r\n    const minvf = new FormField(\r\n      new FormInput('70px', '10'),\r\n      { required: true },\r\n    ).hide();\r\n    const maxvf = new FormField(\r\n      new FormInput('70px', '100'),\r\n      { required: true, type: 'number' },\r\n    ).hide();\r\n    // value\r\n    const svf = new FormField(\r\n      new FormInput('120px', 'a,b,c'),\r\n      { required: true },\r\n    );\r\n    const vf = new FormField(\r\n      new FormInput('70px', '10'),\r\n      { required: true, type: 'number' },\r\n    ).hide();\r\n\r\n    super(t('contextmenu.validation'), [\r\n      h('div', `${cssPrefix}-form-fields`).children(\r\n        mf.el,\r\n        rf.el,\r\n      ),\r\n      h('div', `${cssPrefix}-form-fields`).children(\r\n        cf.el,\r\n        of.el,\r\n        minvf.el,\r\n        maxvf.el,\r\n        vf.el,\r\n        svf.el,\r\n      ),\r\n      h('div', `${cssPrefix}-buttons`).children(\r\n        new Button('cancel').on('click', () => this.btnClick('cancel')),\r\n        new Button('remove').on('click', () => this.btnClick('remove')),\r\n        new Button('save', 'primary').on('click', () => this.btnClick('save')),\r\n      ),\r\n    ]);\r\n    this.mf = mf;\r\n    this.rf = rf;\r\n    this.cf = cf;\r\n    this.of = of;\r\n    this.minvf = minvf;\r\n    this.maxvf = maxvf;\r\n    this.vf = vf;\r\n    this.svf = svf;\r\n    this.change = () => {};\r\n  }\r\n\r\n  showVf(it) {\r\n    const hint = it === 'date' ? '2018-11-12' : '10';\r\n    const { vf } = this;\r\n    vf.input.hint(hint);\r\n    vf.show();\r\n  }\r\n\r\n  criteriaSelected(it) {\r\n    const {\r\n      of, minvf, maxvf, vf, svf,\r\n    } = this;\r\n    if (it === 'date' || it === 'number') {\r\n      of.show();\r\n      minvf.rule.type = it;\r\n      maxvf.rule.type = it;\r\n      if (it === 'date') {\r\n        minvf.hint('2018-11-12');\r\n        maxvf.hint('2019-11-12');\r\n      } else {\r\n        minvf.hint('10');\r\n        maxvf.hint('100');\r\n      }\r\n      minvf.show();\r\n      maxvf.show();\r\n      vf.hide();\r\n      svf.hide();\r\n    } else {\r\n      if (it === 'list') {\r\n        svf.show();\r\n      } else {\r\n        svf.hide();\r\n      }\r\n      vf.hide();\r\n      of.hide();\r\n      minvf.hide();\r\n      maxvf.hide();\r\n    }\r\n  }\r\n\r\n  criteriaOperatorSelected(it) {\r\n    if (!it) return;\r\n    const {\r\n      minvf, maxvf, vf,\r\n    } = this;\r\n    if (it === 'be' || it === 'nbe') {\r\n      minvf.show();\r\n      maxvf.show();\r\n      vf.hide();\r\n    } else {\r\n      const type = this.cf.val();\r\n      vf.rule.type = type;\r\n      if (type === 'date') {\r\n        vf.hint('2018-11-12');\r\n      } else {\r\n        vf.hint('10');\r\n      }\r\n      vf.show();\r\n      minvf.hide();\r\n      maxvf.hide();\r\n    }\r\n  }\r\n\r\n  btnClick(action) {\r\n    if (action === 'cancel') {\r\n      this.hide();\r\n    } else if (action === 'remove') {\r\n      this.change('remove');\r\n      this.hide();\r\n    } else if (action === 'save') {\r\n      // validate\r\n      const attrs = ['mf', 'rf', 'cf', 'of', 'svf', 'vf', 'minvf', 'maxvf'];\r\n      for (let i = 0; i < attrs.length; i += 1) {\r\n        const field = this[attrs[i]];\r\n        // console.log('field:', field);\r\n        if (field.isShow()) {\r\n          // console.log('it:', it);\r\n          if (!field.validate()) return;\r\n        }\r\n      }\r\n\r\n      const mode = this.mf.val();\r\n      const ref = this.rf.val();\r\n      const type = this.cf.val();\r\n      const operator = this.of.val();\r\n      let value = this.svf.val();\r\n      if (type === 'number' || type === 'date') {\r\n        if (operator === 'be' || operator === 'nbe') {\r\n          value = [this.minvf.val(), this.maxvf.val()];\r\n        } else {\r\n          value = this.vf.val();\r\n        }\r\n      }\r\n      // console.log(mode, ref, type, operator, value);\r\n      this.change('save',\r\n        mode,\r\n        ref,\r\n        {\r\n          type, operator, required: false, value,\r\n        });\r\n      this.hide();\r\n    }\r\n  }\r\n\r\n  // validation: { mode, ref, validator }\r\n  setValue(v) {\r\n    if (v) {\r\n      const {\r\n        mf, rf, cf, of, svf, vf, minvf, maxvf,\r\n      } = this;\r\n      const {\r\n        mode, ref, validator,\r\n      } = v;\r\n      const {\r\n        type, operator, value,\r\n      } = validator || { type: 'list' };\r\n      mf.val(mode || 'cell');\r\n      rf.val(ref);\r\n      cf.val(type);\r\n      of.val(operator);\r\n      if (Array.isArray(value)) {\r\n        minvf.val(value[0]);\r\n        maxvf.val(value[1]);\r\n      } else {\r\n        svf.val(value || '');\r\n        vf.val(value || '');\r\n      }\r\n      this.criteriaSelected(type);\r\n      this.criteriaOperatorSelected(operator);\r\n    }\r\n    this.show();\r\n  }\r\n}\r\n","import { h } from './element';\r\nimport Button from './button';\r\nimport { bindClickoutside, unbindClickoutside } from './event';\r\nimport { cssPrefix } from '../config';\r\nimport { t } from '../locale/locale';\r\n\r\nfunction buildMenu(clsName) {\r\n  return h('div', `${cssPrefix}-item ${clsName}`);\r\n}\r\n\r\nfunction buildSortItem(it) {\r\n  return buildMenu('state').child(t(`sort.${it}`))\r\n    .on('click.stop', () => this.itemClick(it));\r\n}\r\n\r\nfunction buildFilterBody(items) {\r\n  const { filterbEl, filterValues } = this;\r\n  filterbEl.html('');\r\n  const itemKeys = Object.keys(items);\r\n  itemKeys.forEach((it, index) => {\r\n    const cnt = items[it];\r\n    const active = filterValues.includes(it) ? 'checked' : '';\r\n    filterbEl.child(h('div', `${cssPrefix}-item state ${active}`)\r\n      .on('click.stop', () => this.filterClick(index, it))\r\n      .children(it === '' ? t('filter.empty') : it, h('div', 'label').html(`(${cnt})`)));\r\n  });\r\n}\r\n\r\nfunction resetFilterHeader() {\r\n  const { filterhEl, filterValues, values } = this;\r\n  filterhEl.html(`${filterValues.length} / ${values.length}`);\r\n  filterhEl.checked(filterValues.length === values.length);\r\n}\r\n\r\nexport default class SortFilter {\r\n  constructor() {\r\n    this.filterbEl = h('div', `${cssPrefix}-body`);\r\n    this.filterhEl = h('div', `${cssPrefix}-header state`).on('click.stop', () => this.filterClick(0, 'all'));\r\n    this.el = h('div', `${cssPrefix}-sort-filter`).children(\r\n      this.sortAscEl = buildSortItem.call(this, 'asc'),\r\n      this.sortDescEl = buildSortItem.call(this, 'desc'),\r\n      buildMenu('divider'),\r\n      h('div', `${cssPrefix}-filter`).children(\r\n        this.filterhEl,\r\n        this.filterbEl,\r\n      ),\r\n      h('div', `${cssPrefix}-buttons`).children(\r\n        new Button('cancel').on('click', () => this.btnClick('cancel')),\r\n        new Button('ok', 'primary').on('click', () => this.btnClick('ok')),\r\n      ),\r\n    ).hide();\r\n    // this.setFilters(['test1', 'test2', 'text3']);\r\n    this.ci = null;\r\n    this.sortDesc = null;\r\n    this.values = null;\r\n    this.filterValues = [];\r\n  }\r\n\r\n  btnClick(it) {\r\n    if (it === 'ok') {\r\n      const { ci, sort, filterValues } = this;\r\n      if (this.ok) {\r\n        this.ok(ci, sort, 'in', filterValues);\r\n      }\r\n    }\r\n    this.hide();\r\n  }\r\n\r\n  itemClick(it) {\r\n    // console.log('it:', it);\r\n    this.sort = it;\r\n    const { sortAscEl, sortDescEl } = this;\r\n    sortAscEl.checked(it === 'asc');\r\n    sortDescEl.checked(it === 'desc');\r\n  }\r\n\r\n  filterClick(index, it) {\r\n    // console.log('index:', index, it);\r\n    const { filterbEl, filterValues, values } = this;\r\n    const children = filterbEl.children();\r\n    if (it === 'all') {\r\n      if (children.length === filterValues.length) {\r\n        this.filterValues = [];\r\n        children.forEach(i => h(i).checked(false));\r\n      } else {\r\n        this.filterValues = Array.from(values);\r\n        children.forEach(i => h(i).checked(true));\r\n      }\r\n    } else {\r\n      const checked = h(children[index]).toggle('checked');\r\n      if (checked) {\r\n        filterValues.push(it);\r\n      } else {\r\n        filterValues.splice(filterValues.findIndex(i => i === it), 1);\r\n      }\r\n    }\r\n    resetFilterHeader.call(this);\r\n  }\r\n\r\n  // v: autoFilter\r\n  // items: {value: cnt}\r\n  // sort { ci, order }\r\n  set(ci, items, filter, sort) {\r\n    this.ci = ci;\r\n    const { sortAscEl, sortDescEl } = this;\r\n    if (sort !== null) {\r\n      this.sort = sort.order;\r\n      sortAscEl.checked(sort.asc());\r\n      sortDescEl.checked(sort.desc());\r\n    } else {\r\n      this.sortDesc = null;\r\n      sortAscEl.checked(false);\r\n      sortDescEl.checked(false);\r\n    }\r\n    // this.setFilters(items, filter);\r\n    this.values = Object.keys(items);\r\n    this.filterValues = filter ? Array.from(filter.value) : Object.keys(items);\r\n    buildFilterBody.call(this, items, filter);\r\n    resetFilterHeader.call(this);\r\n  }\r\n\r\n  setOffset(v) {\r\n    this.el.offset(v).show();\r\n    let tindex = 1;\r\n    bindClickoutside(this.el, () => {\r\n      if (tindex <= 0) {\r\n        this.hide();\r\n      }\r\n      tindex -= 1;\r\n    });\r\n  }\r\n\r\n  show() {\r\n    this.el.show();\r\n  }\r\n\r\n  hide() {\r\n    this.el.hide();\r\n    unbindClickoutside(this.el);\r\n  }\r\n}\r\n","/* global document */\r\nimport { h } from './element';\r\nimport Icon from './icon';\r\nimport { cssPrefix } from '../config';\r\n\r\nexport function xtoast(title, content) {\r\n  const el = h('div', `${cssPrefix}-toast`);\r\n  const dimmer = h('div', `${cssPrefix}-dimmer active`);\r\n  const remove = () => {\r\n    document.body.removeChild(el.el);\r\n    document.body.removeChild(dimmer.el);\r\n  };\r\n\r\n  el.children(\r\n    h('div', `${cssPrefix}-toast-header`).children(\r\n      new Icon('close').on('click.stop', () => remove()),\r\n      title,\r\n    ),\r\n    h('div', `${cssPrefix}-toast-content`).html(content),\r\n  );\r\n  document.body.appendChild(el.el);\r\n  document.body.appendChild(dimmer.el);\r\n  // set offset\r\n  const { width, height } = el.box();\r\n  const { clientHeight, clientWidth } = document.documentElement;\r\n  el.offset({\r\n    left: (clientWidth - width) / 2,\r\n    top: (clientHeight - height) / 3,\r\n  });\r\n}\r\n\r\nexport default {};\r\n","import {h} from './element';\n\nexport default class Comment {\n    constructor() {\n        this.el = h('div', 'comments')\n            .children(\n                this.titleEl = h('div', 'title'),\n                this.contentEl = h('div', 'content')\n            );\n        this.el.hide();\n    }\n\n    init(title, content) {\n        this.titleEl.html(title || '');\n        this.contentEl.html(content);\n        return this;\n    }\n\n    setPos(pos) {\n        this.el.css('left', `${pos.left}px`)\n            .css('top', `${pos.top}px`);\n        return this;\n    }\n\n    showComment({\n        title,\n        content,\n        left,\n        top\n    }) {\n        this.init(title, content);\n        this.setPos({\n            left,\n            top\n        });\n        this.el.show();\n    }\n\n    hideComment() {\n        this.el.hide()\n    }\n}\n","import { h } from './element';\r\nimport { cssPrefix } from '../config';\r\nimport Modal from './modal';\r\nimport Button from './button';\r\n\r\nexport default class SplitColumn extends Modal {\r\n  constructor() {\r\n    const html = `\r\n   <div class=\"split-title\"></div>\r\n   <div class=\"options\">\r\n     <div>\r\n      <input type=\"checkbox\"  name=\"separator\" class=\"separator\" value=\"\\t\" />\r\n      <label for=\"tab\">Tab</label>\r\n    </div>\r\n     <div>\r\n      <input type=\"checkbox\"  name=\"separator\" class=\"separator\"   value=\";\" />\r\n      <label for=\"semicolon\"></label>\r\n    </div>\r\n    <div>\r\n      <input type=\"checkbox\"  name=\"separator\" class=\"separator\"   value=\",\" />\r\n      <label for=\"comma\"></label>\r\n    </div>\r\n    <div>\r\n      <input type=\"checkbox\"  name=\"separator\" class=\"separator\"  value=\"\\s\" />\r\n      <label for=\"space\"></label>\r\n    </div>\r\n    <div>\r\n      <input type=\"checkbox\"  name=\"separator\" class=\"other separator\" value=\"other\" />\r\n      <label for=\"other\"></label>\r\n      <input type=\"text\" class=\"otherValue\">\r\n    </div>\r\n</div>\r\n\r\n    <div class=\"split-title\"></div>\r\n    <div class=\"split-preview\">\r\n\r\n</div>\r\n`;\r\n    // eslint-disable-next-line indent\r\n        const options = h('div', 'split-column').html(html);\r\n    super('', [options,\r\n      h('div', `${cssPrefix}-buttons`).children(\r\n        new Button('cancel').on('click', () => this.btnClick('cancel')),\r\n        new Button('save', 'primary').on('click', () => this.btnClick('save')),\r\n      )]);\r\n\r\n\r\n    this.splitCoumn = [];\r\n    this.checked = [];\r\n    this.change = () => {\r\n    };\r\n    setTimeout(() => {\r\n      const optionsDom = this.options.el.querySelectorAll('.separator');\r\n      const otherValue = this.options.el.querySelector('.otherValue');\r\n      const other = this.options.el.querySelector('.other');\r\n      otherValue.addEventListener('blur', () => {\r\n        if (otherValue.value && other.checked) {\r\n          this.checked.push(otherValue.value);\r\n        }\r\n        const result = this.splitData(this.data);\r\n        this.splitCoumn = result;\r\n        this.previewData(result);\r\n      });\r\n      optionsDom.forEach((item) => {\r\n        item.addEventListener('input', () => {\r\n          console.log(item.value, item.checked);\r\n          if (item.checked) {\r\n            if (item.value === 'other') {\r\n              if (otherValue.value) {\r\n                this.checked.push(otherValue.value);\r\n              }\r\n            } else {\r\n              this.checked.push(item.value);\r\n            }\r\n          } else if (item.value === 'other' && otherValue.value) {\r\n            this.checked = this.checked.filter(it => it !== otherValue.value);\r\n          } else {\r\n            this.checked = this.checked.filter(it => it !== item.value);\r\n          }\r\n          console.log('this.checked', this.checked);\r\n\r\n\r\n          const result = this.splitData(this.data);\r\n          this.splitCoumn = result;\r\n          this.previewData(result);\r\n        });\r\n      });\r\n      console.log(optionsDom);\r\n    });\r\n    this.options = options;\r\n  }\r\n\r\n  btnClick(action) {\r\n    console.log('action', action);\r\n    if (action === 'save') {\r\n      this.change(this.splitCoumn, Object.values(this.splitCoumn)[0].length);\r\n    }\r\n    this.resetData();\r\n    this.hide();\r\n  }\r\n\r\n  resetData() {\r\n    const optionsDom = this.options.el.querySelectorAll('.separator');\r\n    optionsDom.forEach((item) => {\r\n      item.checked = false;\r\n    });\r\n    const otherValue = this.options.el.querySelector('.otherValue');\r\n    otherValue.value = '';\r\n    this.checked = [];\r\n  }\r\n\r\n  buildRegex() {\r\n    const regex = this.checked.map((item) => {\r\n      if (item === '\\s') {\r\n        return '\\\\s';\r\n      }\r\n      return item;\r\n    }).join('|');\r\n    console.log('regex', regex, regex.length);\r\n    if (regex) {\r\n      return new RegExp(regex, 'g');\r\n    }\r\n    return '';\r\n  }\r\n\r\n  // data\r\n  splitData(data) {\r\n    const reg = this.buildRegex();\r\n    const v = Object.values(data);\r\n    const maxLength = reg ? Math.max(...v.map(str => str[0].split(reg).length)) : 1;\r\n\r\n    const result = {};\r\n    if (!reg) {\r\n      return data;\r\n    }\r\n    for (const key in data) {\r\n      const item = data[key];\r\n      const splitted = item[0].split(reg);\r\n      const diff = maxLength - splitted.length;\r\n      const padding = new Array(diff).fill('');\r\n      result[key] = [...splitted, ...padding];\r\n    }\r\n    return result;\r\n  }\r\n\r\n  showDlg(data) {\r\n    this.previewData(data);\r\n    // \r\n    this.data = data;\r\n    this.splitCoumn = data;\r\n\r\n    this.show();\r\n  }\r\n\r\n  previewData(v) {\r\n    const data = Object.values(v);\r\n    // \r\n    const previewDom = this.options.el.querySelector('.split-preview');\r\n    console.log('data', previewDom, data);\r\n    if (data && data.length > 0) {\r\n      let previewHtml = '<table border cellpadding=\"5\" cellspacing=\"0\">';\r\n      data.forEach((item) => {\r\n        previewHtml += '<tr>';\r\n        item.forEach((it) => {\r\n          previewHtml += `\r\n              <td>${it || ''}</td>`;\r\n        });\r\n        previewHtml += '</tr>';\r\n      });\r\n      previewHtml += '</table>';\r\n      console.log('previewHtml:', previewHtml);\r\n      previewDom.innerHTML = previewHtml;\r\n    }\r\n  }\r\n}\r\n","/* global window */\nimport {h} from './element';\nimport {\n    bind,\n    mouseMoveUp,\n    bindTouch,\n    unbind,\n    createEventEmitter,\n} from './event';\nimport Resizer from './resizer';\nimport Scrollbar from './scrollbar';\nimport Selector from './selector';\nimport Editor from './editor';\nimport Print from './print';\nimport ContextMenu from './contextmenu';\nimport Table from './table';\nimport Toolbar from './toolbar/index';\nimport ModalValidation from './modal_validation';\nimport SortFilter from './sort_filter';\nimport {xtoast} from './message';\nimport {cssPrefix} from '../config';\nimport {formulas} from '../core/formula';\nimport Comment from './comment';\nimport SplitColumn from './split_column';\n\n/**\n * @desc throttle fn\n * @param func function\n * @param wait Delay in milliseconds\n */\nfunction throttle(func, wait) {\n    let timeout;\n    return (...arg) => {\n        const that = this;\n        const args = arg;\n        if (!timeout) {\n            timeout = setTimeout(() => {\n                timeout = null;\n                func.apply(that, args);\n            }, wait);\n        }\n    };\n}\n\nfunction scrollbarMove() {\n    const {\n        data, verticalScrollbar, horizontalScrollbar,\n    } = this;\n    const {\n        l, t, left, top, width, height,\n    } = data.getSelectedRect();\n    const tableOffset = this.getTableOffset();\n    // console.log(',l:', l, ', left:', left, ', tOffset.left:', tableOffset.width);\n    if (Math.abs(left) + width > tableOffset.width) {\n        horizontalScrollbar.move({left: l + width - tableOffset.width});\n    } else {\n        const fsw = data.freezeTotalWidth();\n        if (left < fsw) {\n            horizontalScrollbar.move({left: l - 1 - fsw});\n        }\n    }\n    // console.log('top:', top, ', height:', height, ', tof.height:', tableOffset.height);\n    if (Math.abs(top) + height > tableOffset.height) {\n        verticalScrollbar.move({top: t + height - tableOffset.height - 1});\n    } else {\n        const fsh = data.freezeTotalHeight();\n        if (top < fsh) {\n            verticalScrollbar.move({top: t - 1 - fsh});\n        }\n    }\n}\n\nfunction selectorSet(multiple, ri, ci, indexesUpdated = true, moving = false) {\n    if (ri === -1 && ci === -1) return;\n    const {\n        table, selector, toolbar, data,\n        contextMenu,\n    } = this;\n    const cell = data.getCell(ri, ci);\n    if (multiple) {\n        selector.setEnd(ri, ci, moving);\n        this.trigger('cells-selected', cell, selector.range);\n    } else {\n        // trigger click event\n        selector.set(ri, ci, indexesUpdated);\n        this.trigger('cell-selected', cell, ri, ci);\n    }\n    contextMenu.setMode((ri === -1 || ci === -1) ? 'row-col' : 'range');\n    toolbar.reset();\n    table.render();\n}\n\n// multiple: boolean\n// direction: left | right | up | down | row-first | row-last | col-first | col-last\nfunction selectorMove(multiple, direction) {\n    const {\n        selector, data,\n    } = this;\n    const {rows, cols} = data;\n    let [ri, ci] = selector.indexes;\n    const {eri, eci} = selector.range;\n    if (multiple) {\n        [ri, ci] = selector.moveIndexes;\n    }\n    // console.log('selector.move:', ri, ci);\n    if (direction === 'left') {\n        if (ci > 0) ci -= 1;\n    } else if (direction === 'right') {\n        if (eci !== ci) ci = eci;\n        if (ci < cols.len - 1) ci += 1;\n    } else if (direction === 'up') {\n        if (ri > 0) ri -= 1;\n    } else if (direction === 'down') {\n        if (eri !== ri) ri = eri;\n        if (ri < rows.len - 1) ri += 1;\n    } else if (direction === 'row-first') {\n        ci = 0;\n    } else if (direction === 'row-last') {\n        ci = cols.len - 1;\n    } else if (direction === 'col-first') {\n        ri = 0;\n    } else if (direction === 'col-last') {\n        ri = rows.len - 1;\n    }\n    if (multiple) {\n        selector.moveIndexes = [ri, ci];\n    }\n    selectorSet.call(this, multiple, ri, ci);\n    scrollbarMove.call(this);\n}\n\n// private methods\nfunction overlayerMousemove(evt) {\n    // console.log('x:', evt.offsetX, ', y:', evt.offsetY);\n    // hover comment show\n    if (Object.values(this.data.comments).length && evt.buttons === 0) {\n        const cRect = this.data.getCellRectByXY(evt.offsetX, evt.offsetY);\n        if (cRect.ri >= 0 && cRect.ci >= 0) {\n            const tip = this.data.comments[`${[cRect.ri]}-${[cRect.ci]}`];\n            if (tip) {\n                const viewWidth = this.data.viewWidth();\n                const viewHeight = this.data.viewHeight();\n                // viewRange.height>cRect.top+tipHeight\n\n                let left = cRect.left + cRect.width;\n                if (cRect.left + cRect.width + 300 > viewWidth) {\n                    left = cRect.left - 300 - cRect.width / 2 + 10;\n                }\n\n\n                const {top} = cRect;\n                this.comment.showComment({\n                    content: tip,\n                    left,\n                    top,\n                });\n            } else {\n                this.comment.hideComment();\n            }\n        }\n    } else if (evt.buttons !== 0) {\n        // \n        if (evt.target.className === `${cssPrefix}-resizer-hover`) return;\n        const {\n            offsetX,\n            offsetY,\n        } = evt;\n        const {\n            rowResizer,\n            colResizer,\n            tableEl,\n            data,\n        } = this;\n        const {\n            rows,\n            cols,\n        } = data;\n        if (offsetX > cols.indexWidth && offsetY > rows.height) {\n            rowResizer.hide();\n            colResizer.hide();\n            return;\n        }\n        const tRect = tableEl.box();\n        const cRect = data.getCellRectByXY(evt.offsetX, evt.offsetY);\n        if (cRect.ri >= 0 && cRect.ci === -1) {\n            cRect.width = cols.indexWidth;\n            rowResizer.show(cRect, {\n                width: tRect.width,\n            });\n            if (rows.isHide(cRect.ri - 1)) {\n                rowResizer.showUnhide(cRect.ri);\n            } else {\n                rowResizer.hideUnhide();\n            }\n        } else {\n            rowResizer.hide();\n        }\n        if (cRect.ri === -1 && cRect.ci >= 0) {\n            cRect.height = rows.height;\n            colResizer.show(cRect, {\n                height: tRect.height,\n            });\n            if (cols.isHide(cRect.ci - 1)) {\n                colResizer.showUnhide(cRect.ci);\n            } else {\n                colResizer.hideUnhide();\n            }\n        } else {\n            colResizer.hide();\n        }\n    }\n}\n\n// let scrollThreshold = 15;\nfunction overlayerMousescroll(evt) {\n    // scrollThreshold -= 1;\n    // if (scrollThreshold > 0) return;\n    // scrollThreshold = 15;\n\n    const {verticalScrollbar, horizontalScrollbar, data} = this;\n    const {top} = verticalScrollbar.scroll();\n    const {left} = horizontalScrollbar.scroll();\n    // console.log('evt:::', evt.wheelDelta, evt.detail * 40);\n\n    const {rows, cols} = data;\n\n    // deltaY for vertical delta\n    const {deltaY, deltaX} = evt;\n    const loopValue = (ii, vFunc) => {\n        let i = ii;\n        let v = 0;\n        do {\n            v = vFunc(i);\n            i += 1;\n        } while (v <= 0);\n        return v;\n    };\n    // console.log('deltaX', deltaX, 'evt.detail', evt.detail);\n    // if (evt.detail) deltaY = evt.detail * 40;\n    const moveY = (vertical) => {\n        if (vertical > 0) {\n            // up\n            const ri = data.scroll.ri + 1;\n            if (ri < rows.len) {\n                const rh = loopValue(ri, i => rows.getHeight(i));\n                verticalScrollbar.move({top: top + rh - 1});\n            }\n        } else {\n            // down\n            const ri = data.scroll.ri - 1;\n            if (ri >= 0) {\n                const rh = loopValue(ri, i => rows.getHeight(i));\n                verticalScrollbar.move({top: ri === 0 ? 0 : top - rh});\n            }\n        }\n    };\n\n    // deltaX for Mac horizontal scroll\n    const moveX = (horizontal) => {\n        if (horizontal > 0) {\n            // left\n            const ci = data.scroll.ci + 1;\n            if (ci < cols.len) {\n                const cw = loopValue(ci, i => cols.getWidth(i));\n                horizontalScrollbar.move({left: left + cw - 1});\n            }\n        } else {\n            // right\n            const ci = data.scroll.ci - 1;\n            if (ci >= 0) {\n                const cw = loopValue(ci, i => cols.getWidth(i));\n                horizontalScrollbar.move({left: ci === 0 ? 0 : left - cw});\n            }\n        }\n    };\n    const tempY = Math.abs(deltaY);\n    const tempX = Math.abs(deltaX);\n    const temp = Math.max(tempY, tempX);\n    // console.log('event:', evt);\n    // detail for windows/mac firefox vertical scroll\n    if (/Firefox/i.test(window.navigator.userAgent)) throttle(moveY(evt.detail), 50);\n    if (temp === tempX) throttle(moveX(deltaX), 50);\n    if (temp === tempY) throttle(moveY(deltaY), 50);\n}\n\nfunction overlayerTouch(direction, distance) {\n    const {verticalScrollbar, horizontalScrollbar} = this;\n    const {top} = verticalScrollbar.scroll();\n    const {left} = horizontalScrollbar.scroll();\n\n    if (direction === 'left' || direction === 'right') {\n        horizontalScrollbar.move({left: left - distance});\n    } else if (direction === 'up' || direction === 'down') {\n        verticalScrollbar.move({top: top - distance});\n    }\n}\n\nfunction verticalScrollbarSet() {\n    const {data, verticalScrollbar} = this;\n    const {height} = this.getTableOffset();\n    const erth = data.exceptRowTotalHeight(0, -1);\n    // console.log('erth:', erth);\n    verticalScrollbar.set(height, data.rows.totalHeight() - erth);\n}\n\nfunction horizontalScrollbarSet() {\n    const {data, horizontalScrollbar} = this;\n    const {width} = this.getTableOffset();\n    if (data) {\n        horizontalScrollbar.set(width, data.cols.totalWidth());\n    }\n}\n\nfunction sheetFreeze() {\n    const {\n        selector, data, editor,\n    } = this;\n    const [ri, ci] = data.freeze;\n    if (ri > 0 || ci > 0) {\n        const fwidth = data.freezeTotalWidth();\n        const fheight = data.freezeTotalHeight();\n        editor.setFreezeLengths(fwidth, fheight);\n    }\n    selector.resetAreaOffset();\n}\n\nfunction sheetReset() {\n    const {\n        tableEl,\n        overlayerEl,\n        overlayerCEl,\n        table,\n        toolbar,\n        selector,\n        el,\n    } = this;\n    const tOffset = this.getTableOffset();\n    const vRect = this.getRect();\n    tableEl.attr(vRect);\n    overlayerEl.offset(vRect);\n    overlayerCEl.offset(tOffset);\n    el.css('width', `${vRect.width}px`);\n    verticalScrollbarSet.call(this);\n    horizontalScrollbarSet.call(this);\n    sheetFreeze.call(this);\n    table.render();\n    toolbar.reset();\n    selector.reset();\n}\n\nfunction clearClipboard() {\n    const {data, selector} = this;\n    data.clearClipboard();\n    selector.hideClipboard();\n}\n\nfunction copy(evt) {\n    const {data, selector} = this;\n    if (data.settings.mode === 'read') return;\n    data.copy();\n    data.copyToSystemClipboard(evt);\n    selector.showClipboard();\n}\n\nfunction cut() {\n    const {data, selector} = this;\n    if (data.settings.mode === 'read') return;\n    data.cut();\n    selector.showClipboard();\n}\n\nfunction paste(what, evt) {\n    const {data} = this;\n    if (data.settings.mode === 'read') return;\n    if (data.clipboard.isClear()) {\n        const resetSheet = () => sheetReset.call(this);\n        const eventTrigger = (rows) => {\n            this.trigger('pasted-clipboard', rows);\n        };\n        // pastFromSystemClipboard is async operation, need to tell it how to reset sheet and trigger event after it finishes\n        // pasting content from system clipboard\n        data.pasteFromSystemClipboard(resetSheet, eventTrigger);\n    } else if (data.paste(what, msg => xtoast('Tip', msg))) {\n        sheetReset.call(this);\n    } else if (evt) {\n        const cdata = evt.clipboardData.getData('text/plain');\n        this.data.pasteFromText(cdata);\n        sheetReset.call(this);\n    }\n}\n\nfunction hideRowsOrCols() {\n    this.data.hideRowsOrCols();\n    sheetReset.call(this);\n}\n\nfunction unhideRowsOrCols(type, index) {\n    this.data.unhideRowsOrCols(type, index);\n    sheetReset.call(this);\n}\n\nfunction autofilter() {\n    const {data} = this;\n    data.autofilter();\n    sheetReset.call(this);\n}\n\nfunction toolbarChangePaintformatPaste() {\n    const {toolbar} = this;\n    if (toolbar.paintformatActive()) {\n        paste.call(this, 'format');\n        clearClipboard.call(this);\n        toolbar.paintformatToggle();\n    }\n}\n\nfunction overlayerMousedown(evt) {\n    // console.log(':::::overlayer.mousedown:', evt.detail, evt.button, evt.buttons, evt.shiftKey);\n    // console.log('evt.target.className:', evt.target.className);\n    const {\n        selector, data, table, sortFilter,\n    } = this;\n    const {offsetX, offsetY} = evt;\n    const isAutofillEl = evt.target.className === `${cssPrefix}-selector-corner`;\n    const cellRect = data.getCellRectByXY(offsetX, offsetY);\n    const {\n        left, top, width, height,\n    } = cellRect;\n    let {ri, ci} = cellRect;\n    // sort or filter\n    const {autoFilter} = data;\n    if (autoFilter.includes(ri, ci)) {\n        if (left + width - 20 < offsetX && top + height - 20 < offsetY) {\n            const items = autoFilter.items(ci, (r, c) => data.rows.getCell(r, c));\n            sortFilter.hide();\n            sortFilter.set(ci, items, autoFilter.getFilter(ci), autoFilter.getSort(ci));\n            sortFilter.setOffset({left, top: top + height + 2});\n            return;\n        }\n    }\n\n    // console.log('ri:', ri, ', ci:', ci);\n    if (!evt.shiftKey) {\n        // console.log('selectorSetStart:::');\n        if (isAutofillEl) {\n            selector.showAutofill(ri, ci);\n        } else {\n            selectorSet.call(this, false, ri, ci);\n        }\n\n        // mouse move up\n        mouseMoveUp(window, (e) => {\n            // console.log('mouseMoveUp::::');\n            ({ri, ci} = data.getCellRectByXY(e.offsetX, e.offsetY));\n            if (isAutofillEl) {\n                selector.showAutofill(ri, ci);\n            } else if (e.buttons === 1 && !e.shiftKey) {\n                selectorSet.call(this, true, ri, ci, true, true);\n            }\n        }, () => {\n            if (isAutofillEl && selector.arange && data.settings.mode !== 'read') {\n                if (data.autofill(selector.arange, 'all', msg => xtoast('Tip', msg))) {\n                    table.render();\n                }\n            }\n            selector.hideAutofill();\n            toolbarChangePaintformatPaste.call(this);\n        });\n    }\n\n    if (!isAutofillEl && evt.buttons === 1) {\n        if (evt.shiftKey) {\n            // console.log('shiftKey::::');\n            selectorSet.call(this, true, ri, ci);\n        }\n    }\n}\n\nfunction editorSetOffset() {\n    const {editor, data} = this;\n    const sOffset = data.getSelectedRect();\n    const tOffset = this.getTableOffset();\n    let sPosition = 'top';\n    // console.log('sOffset:', sOffset, ':', tOffset);\n    if (sOffset.top > tOffset.height / 2) {\n        sPosition = 'bottom';\n    }\n    editor.setOffset(sOffset, sPosition);\n}\n\nfunction editorSet() {\n    const {editor, data} = this;\n    if (data.settings.mode === 'read') return;\n    editorSetOffset.call(this);\n    editor.setCell(data.getSelectedCell(), data.getSelectedValidator());\n    clearClipboard.call(this);\n}\n\nfunction verticalScrollbarMove(distance) {\n    const {data, table, selector} = this;\n    data.scrolly(distance, () => {\n        selector.resetBRLAreaOffset();\n        editorSetOffset.call(this);\n        table.render();\n    });\n}\n\nfunction horizontalScrollbarMove(distance) {\n    const {data, table, selector} = this;\n    data.scrollx(distance, () => {\n        selector.resetBRTAreaOffset();\n        editorSetOffset.call(this);\n        table.render();\n    });\n}\n\nfunction rowResizerFinished(cRect, distance) {\n    const {ri} = cRect;\n    const {table, selector, data} = this;\n    const {sri, eri} = selector.range;\n    if (ri >= sri && ri <= eri) {\n        for (let row = sri; row <= eri; row += 1) {\n            data.rows.setHeight(row, distance);\n        }\n    } else {\n        data.rows.setHeight(ri, distance);\n    }\n\n    table.render();\n    selector.resetAreaOffset();\n    verticalScrollbarSet.call(this);\n    editorSetOffset.call(this);\n}\n\nfunction colResizerFinished(cRect, distance) {\n    const {ci} = cRect;\n    const {table, selector, data} = this;\n    const {sci, eci} = selector.range;\n    if (ci >= sci && ci <= eci) {\n        for (let col = sci; col <= eci; col += 1) {\n            data.cols.setWidth(col, distance);\n        }\n    } else {\n        data.cols.setWidth(ci, distance);\n    }\n\n    table.render();\n    selector.resetAreaOffset();\n    horizontalScrollbarSet.call(this);\n    editorSetOffset.call(this);\n}\n\nfunction dataSetCellText(text, state = 'finished') {\n    const {data, table} = this;\n    // const [ri, ci] = selector.indexes;\n    if (data.settings.mode === 'read') return;\n    data.setSelectedCellText(text, state);\n    const {ri, ci} = data.selector;\n    if (state === 'finished') {\n        table.render();\n    } else {\n        this.trigger('cell-edited', text, ri, ci);\n    }\n}\n\nfunction insertDeleteRowColumn(type, num) {\n    console.log('insertDeleteRowColumn num:', num, typeof num);\n    const {data} = this;\n    if (data.settings.mode === 'read') return;\n    // if else switch\n    switch (type) {\n        case 'insert-row':\n            data.insert('row', num);\n            break;\n        case 'insert-row-bottom':\n            data.insertRight('row', num);\n            break;\n        case 'delete-row':\n            data.delete('row');\n            break;\n        case 'insert-column':\n            data.insert('column', num);\n            break;\n        case 'insert-column-right':\n            data.insertRight('column', num);\n            break;\n        case 'delete-column':\n            data.delete('column');\n            break;\n        case 'delete-cell':\n            data.deleteCell();\n            break;\n        case 'delete-cell-format':\n            data.deleteCell('format');\n            break;\n        case 'delete-cell-text':\n            data.deleteCell('text');\n            break;\n        case 'cell-printable':\n            data.setSelectedCellAttr('printable', true);\n            break;\n        case 'cell-non-printable':\n            data.setSelectedCellAttr('printable', false);\n            break;\n        case 'cell-editable':\n            data.setSelectedCellAttr('editable', true);\n            break;\n        case 'cell-non-editable':\n            data.setSelectedCellAttr('editable', false);\n            break;\n        default:\n            break;\n    }\n    // if (type === 'insert-row') {\n    //   data.insert('row', num);\n    // } else if (type === 'delete-row') {\n    //   data.delete('row');\n    // } else if (type === 'insert-column') {\n    //   data.insert('column', num);\n    // } else if (type === 'delete-column') {\n    //   data.delete('column');\n    // } else if (type === 'delete-cell') {\n    //   data.deleteCell();\n    // } else if (type === 'delete-cell-format') {\n    //   data.deleteCell('format');\n    // } else if (type === 'delete-cell-text') {\n    //   data.deleteCell('text');\n    // } else if (type === 'cell-printable') {\n    //   data.setSelectedCellAttr('printable', true);\n    // } else if (type === 'cell-non-printable') {\n    //   data.setSelectedCellAttr('printable', false);\n    // } else if (type === 'cell-editable') {\n    //   data.setSelectedCellAttr('editable', true);\n    // } else if (type === 'cell-non-editable') {\n    //   data.setSelectedCellAttr('editable', false);\n    // }\n    clearClipboard.call(this);\n    sheetReset.call(this);\n}\n\nfunction toolbarChange(type, value) {\n    const {data} = this;\n    if (type === 'undo') {\n        this.undo();\n    } else if (type === 'redo') {\n        this.redo();\n    } else if (type === 'print') {\n        this.print.preview();\n    } else if (type === 'paintformat') {\n        if (value === true) copy.call(this);\n        else clearClipboard.call(this);\n    } else if (type === 'clearformat') {\n        insertDeleteRowColumn.call(this, 'delete-cell-format');\n    } else if (type === 'link') {\n        // link\n    } else if (type === 'chart') {\n        // chart\n    } else if (type === 'autofilter') {\n        // filter\n        autofilter.call(this);\n    } else if (type === 'freeze') {\n        if (value) {\n            const {ri, ci} = data.selector;\n            this.freeze(ri, ci);\n        } else {\n            this.freeze(0, 0);\n        }\n    } else {\n        data.setSelectedCellAttr(type, value);\n        if (type === 'formula' && !data.selector.multiple()) {\n            editorSet.call(this);\n        }\n        sheetReset.call(this);\n    }\n}\n\nfunction sortFilterChange(ci, order, operator, value) {\n    // console.log('sort:', sortDesc, operator, value);\n    this.data.setAutoFilter(ci, order, operator, value);\n    sheetReset.call(this);\n}\n\nfunction sheetInitEvents() {\n    const {\n        selector,\n        overlayerEl,\n        rowResizer,\n        colResizer,\n        verticalScrollbar,\n        horizontalScrollbar,\n        editor,\n        contextMenu,\n        toolbar,\n        modalValidation,\n        sortFilter,\n        splitColumn,\n    } = this;\n    // overlayer\n    overlayerEl\n        .on('mousemove', (evt) => {\n            overlayerMousemove.call(this, evt);\n        })\n        .on('mousedown', (evt) => {\n            editor.clear();\n            contextMenu.hide();\n            // the left mouse button: mousedown  mouseup  click\n            // the right mouse button: mousedown  contenxtmenu  mouseup\n            if (evt.buttons === 2) {\n                if (this.data.xyInSelectedRect(evt.offsetX, evt.offsetY)) {\n                    contextMenu.setPosition(evt.offsetX, evt.offsetY);\n                } else {\n                    overlayerMousedown.call(this, evt);\n                    contextMenu.setPosition(evt.offsetX, evt.offsetY);\n                }\n                evt.stopPropagation();\n            } else if (evt.detail === 2) {\n                editorSet.call(this);\n            } else {\n                overlayerMousedown.call(this, evt);\n            }\n        })\n        .on('mousewheel.stop', (evt) => {\n            overlayerMousescroll.call(this, evt);\n        })\n        .on('mouseout', (evt) => {\n            const {offsetX, offsetY} = evt;\n            if (offsetY <= 0) colResizer.hide();\n            if (offsetX <= 0) rowResizer.hide();\n        });\n\n    selector.inputChange = (v) => {\n        dataSetCellText.call(this, v, 'input');\n        editorSet.call(this);\n    };\n\n    // slide on mobile\n    bindTouch(overlayerEl.el, {\n        move: (direction, d) => {\n            overlayerTouch.call(this, direction, d);\n        },\n    });\n\n    // toolbar change\n    toolbar.change = (type, value) => toolbarChange.call(this, type, value);\n\n    // sort filter ok\n    sortFilter.ok = (ci, order, o, v) => sortFilterChange.call(this, ci, order, o, v);\n\n    // resizer finished callback\n    rowResizer.finishedFn = (cRect, distance) => {\n        rowResizerFinished.call(this, cRect, distance);\n    };\n    colResizer.finishedFn = (cRect, distance) => {\n        colResizerFinished.call(this, cRect, distance);\n    };\n    // resizer unhide callback\n    rowResizer.unhideFn = (index) => {\n        unhideRowsOrCols.call(this, 'row', index);\n    };\n    colResizer.unhideFn = (index) => {\n        unhideRowsOrCols.call(this, 'col', index);\n    };\n    // scrollbar move callback\n    verticalScrollbar.moveFn = (distance, evt) => {\n        verticalScrollbarMove.call(this, distance, evt);\n    };\n    horizontalScrollbar.moveFn = (distance, evt) => {\n        horizontalScrollbarMove.call(this, distance, evt);\n    };\n    // editor\n    editor.change = (state, itext) => {\n        dataSetCellText.call(this, itext, state);\n    };\n    // modal validation\n    modalValidation.change = (action, ...args) => {\n        if (action === 'save') {\n            this.data.addValidation(...args);\n        } else {\n            this.data.removeValidation();\n        }\n    };\n    splitColumn.change = (obj, n) => {\n        const {data} = this;\n        data.splitColumn(obj, n);\n        sheetReset.call(this);\n    };\n    // contextmenu\n    contextMenu.itemClick = (type, item, num) => {\n        // console.log('type:', type);\n        if (item.fn) {\n            item.fn();\n            return;\n        }\n        switch (type) {\n            case 'validation':\n                modalValidation.setValue(this.data.getSelectedValidation());\n                break;\n            case 'copy':\n                copy.call(this);\n                break;\n            case 'cut':\n                cut.call(this);\n                break;\n            case 'paste':\n                paste.call(this, 'all');\n                break;\n            case 'paste-value':\n                paste.call(this, 'text');\n                break;\n            case 'paste-format':\n                paste.call(this, 'format');\n                break;\n            case 'hide':\n                hideRowsOrCols.call(this);\n                break;\n            case 'split': {\n                const {range, data} = selector;\n                if (range.eci !== range.sci) {\n                    alert('');\n                    return;\n                }\n                const obj = {};\n                for (let i = range.sri; i <= range.eri; i++) {\n                    obj[i] = [data.getCell(i, range.sci) && data.getCell(i, range.sci).text || ''];\n                }\n                // \n                splitColumn.showDlg(obj);\n                break;\n            }\n            default:\n                insertDeleteRowColumn.call(this, type, num);\n                break;\n        }\n    };\n\n    this.resizeHandle = () => {\n        this.reload();\n    };\n\n    bind(window, 'resize', this.resizeHandle);\n\n\n    this.clickHandle = (evt) => {\n        this.focusing = overlayerEl.contains(evt.target);\n    };\n\n    bind(window, 'click', this.clickHandle);\n\n    this.pasteHandle = (evt) => {\n        if (!this.focusing) return;\n        paste.call(this, 'all', evt);\n        evt.preventDefault();\n    };\n    bind(window, 'paste', this.pasteHandle);\n\n    this.copyHandle = (evt) => {\n        if (!this.focusing) return;\n        copy.call(this, evt);\n        evt.preventDefault();\n    };\n    bind(window, 'copy', this.copyHandle);\n\n    this.keydownHandle = (evt) => {\n        if (!this.focusing) return;\n        const keyCode = evt.keyCode || evt.which;\n        const {\n            key,\n            ctrlKey,\n            shiftKey,\n            metaKey,\n        } = evt;\n        // console.log('keydown.evt: ', keyCode);\n        if (ctrlKey || metaKey) {\n            // const { sIndexes, eIndexes } = selector;\n            // let what = 'all';\n            // if (shiftKey) what = 'text';\n            // if (altKey) what = 'format';\n            switch (keyCode) {\n                case 90:\n                    // undo: ctrl + z\n                    this.undo();\n                    evt.preventDefault();\n                    break;\n                case 89:\n                    // redo: ctrl + y\n                    this.redo();\n                    evt.preventDefault();\n                    break;\n                case 67:\n                    // ctrl + c\n                    // => copy\n                    // copy.call(this);\n                    // evt.preventDefault();\n                    break;\n                case 88:\n                    // ctrl + x\n                    cut.call(this);\n                    evt.preventDefault();\n                    break;\n                case 85:\n                    // ctrl + u\n                    toolbar.trigger('underline');\n                    evt.preventDefault();\n                    break;\n                case 86:\n                    // ctrl + v\n                    // => paste\n                    // evt.preventDefault();\n                    break;\n                case 37:\n                    // ctrl + left\n                    selectorMove.call(this, shiftKey, 'row-first');\n                    evt.preventDefault();\n                    break;\n                case 38:\n                    // ctrl + up\n                    selectorMove.call(this, shiftKey, 'col-first');\n                    evt.preventDefault();\n                    break;\n                case 39:\n                    // ctrl + right\n                    selectorMove.call(this, shiftKey, 'row-last');\n                    evt.preventDefault();\n                    break;\n                case 40:\n                    // ctrl + down\n                    selectorMove.call(this, shiftKey, 'col-last');\n                    evt.preventDefault();\n                    break;\n                case 32:\n                    // ctrl + space, all cells in col\n                    selectorSet.call(this, false, -1, this.data.selector.ci, false);\n                    evt.preventDefault();\n                    break;\n                case 66:\n                    // ctrl + B\n                    toolbar.trigger('bold');\n                    break;\n                case 73:\n                    // ctrl + I\n                    toolbar.trigger('italic');\n                    break;\n                default:\n                    break;\n            }\n        } else {\n            // console.log('evt.keyCode:', evt.keyCode);\n            switch (keyCode) {\n                case 32:\n                    if (shiftKey) {\n                        // shift + space, all cells in row\n                        selectorSet.call(this, false, this.data.selector.ri, -1, false);\n                    }\n                    break;\n                case 27: // esc\n                    contextMenu.hide();\n                    clearClipboard.call(this);\n                    break;\n                case 37: // left\n                    selectorMove.call(this, shiftKey, 'left');\n                    evt.preventDefault();\n                    break;\n                case 38: // up\n                    selectorMove.call(this, shiftKey, 'up');\n                    evt.preventDefault();\n                    break;\n                case 39: // right\n                    selectorMove.call(this, shiftKey, 'right');\n                    evt.preventDefault();\n                    break;\n                case 40: // down\n                    selectorMove.call(this, shiftKey, 'down');\n                    evt.preventDefault();\n                    break;\n                case 9: // tab\n                    editor.clear();\n                    // shift + tab => move left\n                    // tab => move right\n                    selectorMove.call(this, false, shiftKey ? 'left' : 'right');\n                    evt.preventDefault();\n                    break;\n                case 13: // enter\n                    editor.clear();\n                    // shift + enter => move up\n                    // enter => move down\n                    selectorMove.call(this, false, shiftKey ? 'up' : 'down');\n                    evt.preventDefault();\n                    break;\n                case 8: // backspace\n                    insertDeleteRowColumn.call(this, 'delete-cell-text');\n                    evt.preventDefault();\n                    break;\n                default:\n                    break;\n            }\n\n            if (key === 'Delete') {\n                insertDeleteRowColumn.call(this, 'delete-cell-text');\n                evt.preventDefault();\n            } else if ((keyCode >= 65 && keyCode <= 90)\n                || (keyCode >= 48 && keyCode <= 57)\n                || (keyCode >= 96 && keyCode <= 105)\n                || evt.key === '='\n            ) {\n                dataSetCellText.call(this, evt.key, 'input');\n                editorSet.call(this);\n            } else if (keyCode === 113) {\n                // F2\n                editorSet.call(this);\n            }\n        }\n    };\n    // for selector\n    bind(window, 'keydown', this.keydownHandle);\n}\n\nexport default class Sheet {\n    constructor(targetEl, data) {\n        this.eventMap = createEventEmitter();\n        const {view, showToolbar, showContextmenu} = data.settings;\n        this.el = h('div', `${cssPrefix}-sheet`);\n        this.toolbar = new Toolbar(data, view.width, !showToolbar);\n        this.print = new Print(data);\n        targetEl.children(this.toolbar.el, this.el, this.print.el);\n        this.data = data;\n        // table\n        this.tableEl = h('canvas', `${cssPrefix}-table`);\n        // resizer\n        this.rowResizer = new Resizer(false, data.rows.height);\n        this.colResizer = new Resizer(true, data.cols.minWidth);\n        // scrollbar\n        this.verticalScrollbar = new Scrollbar(true);\n        this.horizontalScrollbar = new Scrollbar(false);\n        // editor\n        this.editor = new Editor(\n            formulas,\n            () => this.getTableOffset(),\n            data.rows.height,\n        );\n        // data validation\n        this.modalValidation = new ModalValidation();\n        // contextMenu\n        this.contextMenu = new ContextMenu(() => this.getRect(), !showContextmenu, data.settings.contextMenu);\n        // selector\n        this.selector = new Selector(data);\n        //  comment\n        this.comment = new Comment();\n        this.splitColumn = new SplitColumn();\n        this.overlayerCEl = h('div', `${cssPrefix}-overlayer-content`)\n            .children(\n                this.editor.el,\n                this.selector.el,\n            );\n        this.overlayerEl = h('div', `${cssPrefix}-overlayer`)\n            .children(this.overlayerCEl,\n                this.comment.el);\n        // sortFilter\n        this.sortFilter = new SortFilter();\n        // root element\n        this.el.children(\n            this.tableEl,\n            this.overlayerEl.el,\n            this.rowResizer.el,\n            this.colResizer.el,\n            this.verticalScrollbar.el,\n            this.horizontalScrollbar.el,\n            this.contextMenu.el,\n            this.modalValidation.el,\n            this.sortFilter.el,\n            this.splitColumn.el,\n        );\n        // table\n        this.table = new Table(this.tableEl.el, data);\n        sheetInitEvents.call(this);\n        sheetReset.call(this);\n        // init selector [0, 0]\n        selectorSet.call(this, false, 0, 0);\n    }\n\n    on(eventName, func) {\n        this.eventMap.on(eventName, func);\n        return this;\n    }\n\n    trigger(eventName, ...args) {\n        const {eventMap} = this;\n        eventMap.fire(eventName, args);\n    }\n\n    resetData(data) {\n        // before\n        this.editor.clear();\n        // after\n        this.data = data;\n        verticalScrollbarSet.call(this);\n        horizontalScrollbarSet.call(this);\n        this.toolbar.resetData(data);\n        this.print.resetData(data);\n        this.selector.resetData(data);\n        this.table.resetData(data);\n    }\n\n    loadData(data) {\n        this.data.setData(data);\n        sheetReset.call(this);\n        return this;\n    }\n\n    // freeze rows or cols\n    freeze(ri, ci) {\n        const {data} = this;\n        data.setFreeze(ri, ci);\n        sheetReset.call(this);\n        return this;\n    }\n\n    undo() {\n        this.data.undo();\n        sheetReset.call(this);\n    }\n\n    redo() {\n        this.data.redo();\n        sheetReset.call(this);\n    }\n\n    reload() {\n        sheetReset.call(this);\n        return this;\n    }\n\n    getRect() {\n        const {data} = this;\n        return {width: data.viewWidth(), height: data.viewHeight()};\n    }\n\n    getTableOffset() {\n        const {rows, cols} = this.data;\n        const {width, height} = this.getRect();\n        return {\n            width: width - cols.indexWidth,\n            height: height - rows.height,\n            left: cols.indexWidth,\n            top: rows.height,\n        };\n    }\n\n\n    destroy() {\n        unbind(window, 'resize', this.resizeHandle);\n        unbind(window, 'click', this.clickHandle);\n        unbind(window, 'paste', this.pasteHandle);\n        unbind(window, 'copy', this.copyHandle);\n        unbind(window, 'keydown', this.keydownHandle);\n    }\n}\n","import { h } from './element';\r\nimport { bindClickoutside, unbindClickoutside } from './event';\r\nimport { cssPrefix } from '../config';\r\nimport Icon from './icon';\r\nimport FormInput from './form_input';\r\nimport Dropdown from './dropdown';\r\n// Record: temp not used\r\n// import { xtoast } from './message';\r\nimport { tf } from '../locale/locale';\r\n\r\nclass DropdownMore extends Dropdown {\r\n  constructor(click) {\r\n    const icon = new Icon('ellipsis');\r\n    super(icon, 'auto', false, 'top-left');\r\n    this.contentClick = click;\r\n  }\r\n\r\n  reset(items) {\r\n    const eles = items.map((it, i) => h('div', `${cssPrefix}-item`)\r\n      .css('width', '150px')\r\n      .css('font-weight', 'normal')\r\n      .on('click', () => {\r\n        this.contentClick(i);\r\n        this.hide();\r\n      })\r\n      .child(it));\r\n    this.setContentChildren(...eles);\r\n  }\r\n\r\n  setTitle() {}\r\n}\r\n\r\nconst menuItems = [\r\n  { key: 'delete', title: tf('contextmenu.deleteSheet') },\r\n];\r\n\r\nfunction buildMenuItem(item) {\r\n  return h('div', `${cssPrefix}-item`)\r\n    .child(item.title())\r\n    .on('click', () => {\r\n      this.itemClick(item.key);\r\n      this.hide();\r\n    });\r\n}\r\n\r\nfunction buildMenu() {\r\n  return menuItems.map(it => buildMenuItem.call(this, it));\r\n}\r\n\r\nclass ContextMenu {\r\n  constructor() {\r\n    this.el = h('div', `${cssPrefix}-contextmenu`)\r\n      .css('width', '160px')\r\n      .children(...buildMenu.call(this))\r\n      .hide();\r\n    this.itemClick = () => {};\r\n  }\r\n\r\n  hide() {\r\n    const { el } = this;\r\n    el.hide();\r\n    unbindClickoutside(el);\r\n  }\r\n\r\n  setOffset(offset) {\r\n    const { el } = this;\r\n    el.offset(offset);\r\n    el.show();\r\n    bindClickoutside(el);\r\n  }\r\n}\r\n\r\nexport default class Bottombar {\r\n  constructor(addFunc = () => {},\r\n    swapFunc = () => {},\r\n    deleteFunc = () => {},\r\n    updateFunc = () => {}) {\r\n    this.swapFunc = swapFunc;\r\n    this.updateFunc = updateFunc;\r\n    this.dataNames = [];\r\n    this.activeEl = null;\r\n    this.deleteEl = null;\r\n    this.items = [];\r\n    this.moreEl = new DropdownMore((i) => {\r\n      this.clickSwap2(this.items[i]);\r\n    });\r\n    this.contextMenu = new ContextMenu();\r\n    this.contextMenu.itemClick = deleteFunc;\r\n    this.el = h('div', `${cssPrefix}-bottombar`).children(\r\n      this.contextMenu.el,\r\n      this.menuEl = h('ul', `${cssPrefix}-menu`).child(\r\n        h('li', '').children(\r\n          new Icon('add').on('click', () => {\r\n            addFunc();\r\n          }),\r\n          h('span', '').child(this.moreEl),\r\n        ),\r\n      ),\r\n    );\r\n  }\r\n\r\n  addItem(name, active, options) {\r\n    this.dataNames.push(name);\r\n    const item = h('li', active ? 'active' : '').child(name);\r\n    item.on('click', () => {\r\n      this.clickSwap2(item);\r\n    }).on('contextmenu', (evt) => {\r\n      if (options.mode === 'read') return;\r\n      const { offsetLeft, offsetHeight } = evt.target;\r\n      this.contextMenu.setOffset({ left: offsetLeft, bottom: offsetHeight + 1 });\r\n      this.deleteEl = item;\r\n    }).on('dblclick', () => {\r\n      if (options.mode === 'read') return;\r\n      const v = item.html();\r\n      const input = new FormInput('auto', '');\r\n      input.val(v);\r\n      input.input.on('blur', ({ target }) => {\r\n        const { value } = target;\r\n        const nindex = this.dataNames.findIndex(it => it === v);\r\n        this.renameItem(nindex, value);\r\n        /*\r\n        this.dataNames.splice(nindex, 1, value);\r\n        this.moreEl.reset(this.dataNames);\r\n        item.html('').child(value);\r\n        this.updateFunc(nindex, value);\r\n        */\r\n      });\r\n      item.html('').child(input.el);\r\n      input.focus();\r\n    });\r\n    if (active) {\r\n      this.clickSwap(item);\r\n    }\r\n    this.items.push(item);\r\n    this.menuEl.child(item);\r\n    this.moreEl.reset(this.dataNames);\r\n  }\r\n\r\n  renameItem(index, value) {\r\n    this.dataNames.splice(index, 1, value);\r\n    this.moreEl.reset(this.dataNames);\r\n    this.items[index].html('').child(value);\r\n    this.updateFunc(index, value);\r\n  }\r\n\r\n  clear() {\r\n    this.items.forEach((it) => {\r\n      this.menuEl.removeChild(it.el);\r\n    });\r\n    this.items = [];\r\n    this.dataNames = [];\r\n    this.moreEl.reset(this.dataNames);\r\n  }\r\n\r\n  deleteItem() {\r\n    const { activeEl, deleteEl } = this;\r\n    if (this.items.length > 1) {\r\n      const index = this.items.findIndex(it => it === deleteEl);\r\n      this.items.splice(index, 1);\r\n      this.dataNames.splice(index, 1);\r\n      this.menuEl.removeChild(deleteEl.el);\r\n      this.moreEl.reset(this.dataNames);\r\n      if (activeEl === deleteEl) {\r\n        const [f] = this.items;\r\n        this.activeEl = f;\r\n        this.activeEl.toggle();\r\n        return [index, 0];\r\n      }\r\n      return [index, -1];\r\n    }\r\n    return [-1];\r\n  }\r\n\r\n  clickSwap2(item) {\r\n    const index = this.items.findIndex(it => it === item);\r\n    this.clickSwap(item);\r\n    this.activeEl.toggle();\r\n    this.swapFunc(index);\r\n  }\r\n\r\n  clickSwap(item) {\r\n    if (this.activeEl !== null) {\r\n      this.activeEl.toggle();\r\n    }\r\n    this.activeEl = item;\r\n  }\r\n}\r\n","/* global window, document */\nimport {h} from './component/element';\nimport DataProxy from './core/data_proxy';\nimport Sheet from './component/sheet';\nimport Bottombar from './component/bottombar';\nimport {cssPrefix} from './config';\nimport {locale} from './locale/locale';\nimport './index.less';\n\n\nclass Spreadsheet {\n    constructor(selectors, options = {}) {\n        let targetEl = selectors;\n        this.options = {showBottomBar: true, ...options};\n        this.sheetIndex = 1;\n        this.datas = [];\n        if (typeof selectors === 'string') {\n            targetEl = document.querySelector(selectors);\n        }\n        this.bottombar = this.options.showBottomBar ? new Bottombar(() => {\n            if (this.options.mode === 'read') return;\n            const d = this.addSheet();\n            this.sheet.resetData(d);\n        }, (index) => {\n            const d = this.datas[index];\n            this.sheet.resetData(d);\n        }, () => {\n            this.deleteSheet();\n        }, (index, value) => {\n            this.datas[index].name = value;\n            this.sheet.trigger('change');\n        }) : null;\n        this.data = this.addSheet();\n        const rootEl = h('div', `${cssPrefix}`)\n            .on('contextmenu', evt => evt.preventDefault());\n        // create canvas element\n        targetEl.appendChild(rootEl.el);\n        this.sheet = new Sheet(rootEl, this.data);\n        if (this.bottombar !== null) {\n            rootEl.child(this.bottombar.el);\n        }\n    }\n\n    addSheet(name, active = true) {\n        const n = name || `sheet${this.sheetIndex}`;\n        const d = new DataProxy(n, this.options);\n        d.change = (...args) => {\n            this.sheet.trigger('change', ...args);\n        };\n        this.datas.push(d);\n        // console.log('d:', n, d, this.datas);\n        if (this.bottombar !== null) {\n            this.bottombar.addItem(n, active, this.options);\n        }\n        this.sheetIndex += 1;\n        return d;\n    }\n\n    deleteSheet() {\n        if (this.bottombar === null) return;\n\n        const [oldIndex, nindex] = this.bottombar.deleteItem();\n        if (oldIndex >= 0) {\n            this.datas.splice(oldIndex, 1);\n            if (nindex >= 0) this.sheet.resetData(this.datas[nindex]);\n            this.sheet.trigger('change');\n        }\n    }\n\n    loadData(data) {\n        const ds = Array.isArray(data) ? data : [data];\n        if (this.bottombar !== null) {\n            this.bottombar.clear();\n        }\n        this.datas = [];\n        if (ds.length > 0) {\n            for (let i = 0; i < ds.length; i += 1) {\n                const it = ds[i];\n                const nd = this.addSheet(it.name, i === 0);\n                nd.setData(it);\n                if (i === 0) {\n                    this.sheet.resetData(nd);\n                }\n            }\n        }\n        return this;\n    }\n\n    getData() {\n        return this.datas.map(it => it.getData());\n    }\n\n    cellText(ri, ci, text, sheetIndex = 0) {\n        this.datas[sheetIndex].setCellText(ri, ci, text, 'finished');\n        return this;\n    }\n\n    cell(ri, ci, sheetIndex = 0) {\n        return this.datas[sheetIndex].getCell(ri, ci);\n    }\n\n    cellStyle(ri, ci, sheetIndex = 0) {\n        return this.datas[sheetIndex].getCellStyle(ri, ci);\n    }\n\n    reRender() {\n        this.sheet.table.render();\n        return this;\n    }\n\n    on(eventName, func) {\n        this.sheet.on(eventName, func);\n        return this;\n    }\n\n    validate() {\n        const {validations} = this.data;\n        return validations.errors.size <= 0;\n    }\n\n    change(cb) {\n        this.sheet.on('change', cb);\n        return this;\n    }\n\n    static locale(lang, message) {\n        locale(lang, message);\n    }\n}\n\nconst spreadsheet = (el, options = {}) => new Spreadsheet(el, options);\n\nif (window) {\n    window.x_spreadsheet = spreadsheet;\n    window.x_spreadsheet.locale = (lang, message) => locale(lang, message);\n}\n\nexport default Spreadsheet;\nexport {\n    spreadsheet,\n};\n"],"sourceRoot":""}